# Frank's Hackergame 2024 Writeup

> å¥½ç©å‘¢å–µï¼Œæ˜å¹´ä¹Ÿè¦å†æ¥å‘¢å–µ

å¤§ä¸€å°è’Ÿè’»ï¼Œå¤´å›è®¤çœŸæ‰“CTFï¼Œæ„Ÿè§‰è‡ªå·±ç«Ÿç„¶æ²¡é‚£ä¹ˆåºŸç‰©äº†ï¼ˆ*

è¿ç€ä¸€ä¸ªç¤¼æ‹œä¸‹æ¥åšé¢˜å¾ˆçˆ½ï¼ˆæŒ‡è¢«ä¸€å † DDL è¿½èµ¶çš„æƒ…å†µä¸‹é«˜å¼ºåº¦ç†¬å¤œï¼‰ï¼Œç‰¹åˆ«é¸£è°¢ **GPT** è€å¸ˆï¼ï¼ˆæ•‘å‘½æ©äºº

è®¤è¯†åˆ°äº†å¥½å¤šå¤§ä½¬ï¼æ˜å¹´å†è§ç±³å¨œwwww

> å½“å‰åˆ†æ•°ï¼š4200ï¼Œæ€»æ’åï¼š81 / 2460ï¼Œæµ™æ±Ÿå¤§å­¦ç»„å†…æ’åï¼š7 / 44
> AIï¼š150ï¼Œbinaryï¼š0ï¼Œgeneralï¼š1500ï¼Œmathï¼š1450ï¼Œwebï¼š1100

## ç­¾åˆ°

ç›´æ¥**ç­‰ä¸åŠäº†ï¼Œé©¬ä¸Šå¯åŠ¨ï¼**ï¼Œå‘ç°é“¾æ¥è·³è½¬åˆ°`?pass=false`ï¼Œäºæ˜¯æ”¹æˆ`true`ï¼Œå°±å‡ºflagäº†

> flag{WeLC0M3-7o-H@cK3RgaME-And-EnJOY-hAcKiNG-2024}

## å–œæ¬¢åšç­¾åˆ°çš„ CTFer ä½ ä»¬å¥½å‘€

æ„Ÿè§‰ï¼Œéš¾ç‚¹åœ¨äºæ‰¾  CTF æˆ˜é˜Ÿçš„æ‹›æ–°ä¸»é¡µï¼ˆé›¾

Google åŠå¤©æ²¡æœåˆ°ï¼Œç„¶åç¿»å¾®ä¿¡å…¬ä¼—å·æ‰¾åˆ° Nebula ä½†æ²¡æ‰¾åˆ°æ‹›æ–°ç½‘é¡µï¼Œæœ€åæ‰¾åŠå¤©æ‰çœ‹åˆ°ä¸»é¡µ**æ‰¿åŠå•ä½**é‡Œæœ‰ğŸ« 

ç‚¹å¼€[æ‹›æ–°ç½‘é¡µ](https://www.nebuu.la/)ï¼Œç›´æ¥æ‰§è¡Œ `help`ï¼Œç„¶åææƒ `sudo`ï¼Œå°±~~å¯åŠ¨Bç«™å¤§ä¼šå‘˜çœ‹äº†ä¸€ä¸‹åˆå¥¶é¾™äº†~~

å®é™…ä¸Šå…ˆå‡ºçš„ç¬¬äºŒä¸ª flagï¼Œä¹ æƒ¯æ€§ `ls -a`ï¼Œçœ‹åˆ°éšè—çš„æ–‡ä»¶ï¼Œ`cat .flag` å°±å¯ä»¥æ‹¿åˆ°ç¬¬äºŒä¸ª flag äº†

ç¬¬ä¸€ä¸ªæ ¹æ® `help` æç¤ºæŒ¨ä¸ªæ‰§è¡Œä¸€éï¼Œå°±å¯ä»¥åœ¨ `env` é‡Œçœ‹åˆ°å­˜åœ¨ç¯å¢ƒå˜é‡äº†

> flag{actually_theres_another_flag_here_trY_to_f1nD_1t_y0urself___join_us_ustc_nebula}
>
> flag{0k_175_a_h1dd3n_s3c3rt_f14g___please_join_us_ustc_nebula_anD_two_maJor_requirements_aRe_shown_somewhere_else}

## çŒ«å’ªé—®ç­”ï¼ˆHackergame åå‘¨å¹´çºªå¿µç‰ˆï¼‰

1. ç¬¬ä¸€é¢˜è¿› LUG çš„ [Hackergame](https://lug.ustc.edu.cn/wiki/lug/events/hackergame/) æ´»åŠ¨è®°å½•ï¼Œç‚¹å¼€[ç¬¬äºŒå±Š](https://lug.ustc.edu.cn/wiki/sec/contest.html)å°±æ˜¯
2. è¿™é¢˜è¿˜æŒºéº»çƒ¦ï¼Œæˆ‘æ˜¯ç¿»äº†è¿‘äº”å¹´çš„ Writeupï¼Œç„¶åæœ€æ¥è¿‘æ˜¯ 19 å¹´çš„ï¼Œå°±å» LUG ä¸Šæ‰¾åˆ°äº†è¿™ç¯‡ [post](https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/)ï¼Œæ–‡ä¸­å°±æåˆ°äº†æ³¨å†Œäººæ•°
3. æ‰“å¼€ [18 å¹´çš„ Writeup](https://github.com/ustclug/hackergame2018-writeups/tree/master)ï¼Œå®é™…ä¸Šæˆ‘æ²¡ç¿»åˆ°ä¸‹é¢çš„èŠ±çµ®ï¼Œç›´æ¥ç‚¹å¼€äº†é‚£å¹´çš„**çŒ«å’ªé—®ç­”**ï¼Œå‡­å€Ÿ~~æ•é”çš„å—…è§‰~~çœ‹åˆ°äº†ä¸­æ–‡ä¹¦åï¼Œå¡«äº†å°±æ˜¯
4. è¿›äº† [USENIX Security 24â€˜](https://www.usenix.org/conference/usenixsecurity24) çš„å®˜ç½‘ï¼Œä½†æ˜¯ç¿»è®ºæ–‡æ²¡æ‰¾åˆ°è¿™ç¯‡ï¼Œç´¢æ€§ç›´æ¥ Google USTC USENIX Securityï¼Œç„¶åæ‰¾åˆ°äº†æ–‡ä»¶ï¼Œæœ€åä¸¢ç»™ GPT å¸®æˆ‘æ‰¾ä¸‹å¤šå°‘ç§å°±å¥½
5. æœ€å®¹æ˜“çš„ä¸€é¢˜ï¼Œéšä¾¿æ‰¾ä¸ªæ–°é—»éƒ½èƒ½è·³è½¬åˆ° commit è®°å½•
6. å» Huggingface ä¸Šç”³è¯·è¢«æ‹’ï¼Œè¯•äº†æ¢å›½ç±ä¹Ÿä¸è¡Œï¼Œäºæ˜¯å°±æ¢åˆ° ModelScope ä¸‹è½½ä¸‹æ¥ï¼Œç°å­¦ä¸‹ tokenizer å°±å‡ºæ¥äº†ï¼ˆä½†æˆ‘è·‘å‡ºæ¥ç»“æœæ˜¯ 1836ï¼Œå°±åŠ åŠ å‡å‡è¯•äº†ä¸‹å‡ºæ¥äº†

> flag{Î±_gÃ˜OD_c4T_iS_th3_CaT_wHo_C4N_pAS$_7he_Qu!Z}
>
> flag{7EĞ˜_ye4rS_Ã˜f_haCk3rg@Me_Ã˜M3De7oà¸š_W1th_NEK0_QU1Z}

## æ‰“ä¸å¼€çš„ç›’

ç›´æ¥ä¸¢åˆ° Blenderï¼Œæ‰“å¼€ X-ray å°±å¯ä»¥çœ‹åˆ°å†…éƒ¨äº†

![Blender æ‰“ä¸å¼€çš„ç›’](src/box.png)

> flag{Dr4W_Us!nG_fR3E_C4D!!w0W}

## æ¯æ—¥è®ºæ–‡å¤ªå¤šäº†ï¼

æµè§ˆå™¨æ‰“å¼€å Ctrl + F æœç´¢ flagï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢æœ‰ä¸€å—è¢«æ ‡è®°äº†

![](src/paper1.png)

å¤§æŠµæ˜¯è¢«ç™½è‰²è‰²å—æŒ¡ä½äº†ï¼Œä¸¢è¿› Adobe Acrobatï¼Œç¼–è¾‘ PDFï¼Œç§»å¼€è‰²å—å°±å¯ä»¥çœ‹åˆ° flag äº†
![](src/paper2.png)

è¯è¯´ï¼ŒåŸæ¥ï¼Œæ­£å¼è®ºæ–‡å¯ä»¥è¿™æ ·çš„å—ï¼ˆ... åˆ« Go äº†ï¼Œè¿˜å† Go

> flag{h4PpY_hAck1ng_3veRyd4y}

## æ¯”å¤§å°ç‹

é‰´å®šä¸º**æœ€çƒ­æœ€æ–°æ—¶å°šæ½®æµ**ï¼Œä¹‹å‰ ZJUCTF æ‰åšè¿‡è¿™æ ·çš„é¢˜ï¼ŒçœŸæ˜¯åˆºæ¿€åˆå¥½ç©å•Šï¼ˆï¼

æ‰“å¼€ Consoleï¼Œçœ‹äº†çœ¼ script çš„å†…å®¹ï¼Œå‘ç°æ˜¯é€šè¿‡ä¸€ä¸ª submit çš„å‡½æ•°è°ƒç”¨æäº¤ç­”æ¡ˆçš„ï¼Œé‚£æˆ‘æ‰‹åŠ¨æäº¤ä¸å°±å¥½äº†ï¼Œç›´æ¥åœ¨ Console é‡Œå†™ä»£ç 

```javascript
for (var i in state.values) {
    if (state.values[i][0]<state.values[i][1]) state.inputs.push('<')
    if (state.values[i][0]>state.values[i][1]) state.inputs.push('>')
}
inputs = state.inputs
submit(inputs)
```

ç„¶åä¼šæç¤º**æ—¶ç©ºç©¿è¶Š**ï¼ŒçŒœæµ‹æœåŠ¡å™¨ä¹Ÿæœ‰ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œé‚£å°±ç­‰ä¸ªå‡ ç§’å¿«ç»“æŸæäº¤å°±å¥½äº†

> flag{!-4m-The-HACKeR-k1N9-0F-cOMp@rINg-nUM63rs-2024}

## æ—…è¡Œç…§ç‰‡ 4.0

ä¸è¦å›¾å¯»äº†ï¼Œå›¾å¯»è¿™ç§äº‹æƒ…ï¼Œä¸è¦å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šï¼

1. æ ¡é—¨æˆ‘ç”šè‡³æ‡’å¾—æœï¼Œç›´æ¥å¼€è¯•ï¼Œç¬¬ä¸€ä¸ªå°±è¯•äº†**ä¸œæ ¡åŒºè¥¿é—¨**ç„¶åç»“æŸï¼ˆæ€ä¹ˆè¿˜æœ‰å°çº¢ä¹¦å¤§æ³•ï¼ŒğŸ  is all you needï¼‰ACG éŸ³ä¹ä¼šå¯ä»¥æœåˆ° B ç«™çš„è§†é¢‘ï¼Œç®€ä»‹é‡Œå°±æœ‰æ—¥æœŸ
2. å¯ä»¥çœ‹åˆ°åƒåœ¾æ¡¶æœ‰æ¨¡ç³Šçš„**å…­å®‰**å­—æ ·ï¼Œå¸¦ç€å…­å®‰æœå½©è™¹è·‘é“ï¼Œå¯ä»¥æ‰¾åˆ°è¿™ç¯‡[æ–°é—»](https://www.sohu.com/a/498872898_100023473)ï¼Œç¬¬äºŒé—® Google æœå›¾å°±å¯ä»¥çœ‹åˆ°æ™¯ç‚¹åœ°åŒºäº†
3. æˆ‘ä¸ç© ã¾ã„ã¦ã¤ï¼ˆä¸æ˜¯é“é“è¿·å‘œå‘œå‘œã€‚ã€‚ã€‚ä¸€å¼€å§‹æ²¡æ³¨æ„åˆ°è½¦å‹ï¼ŒæŠŠå…¨å›½åŠ¨è½¦è¿ç”¨æ‰€ç¿»äº†ä¸€éæ²¡ç¿»åˆ°ï¼Œæœ€åå…¶å®å››ç¼–ç»„ç®—æç¤ºäº†ï¼Œæœä¸€ä¸‹è½¦å‹ï¼Œå¯¹ç€æ¶‚è£…å¯ä»¥çœ‹åˆ°æ˜¯æ€€å¯†å·ï¼Œå¯¹ç€å«æ˜Ÿå›¾ä»èµ·å§‹ç«™åŒ—äº¬åŒ—å¾€ä¸Šæ‹‰ä¸€ç‚¹å°±æ˜¯ï¼Œçº¢æˆ¿å­å’ŒåŒ»é™¢çš„å¼¯è§’è¿˜æ˜¯å¾ˆæ˜æ˜¾çš„

![](src/map.png)

## Node.js is Web Scale

æŸ¥çœ‹æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸€æ®µå¤„ç†è¾“å…¥çš„

```javascript
// POST /set - Set a key-value pair in the store
app.post("/set", (req, res) => {
  const { key, value } = req.body;

  const keys = key.split(".");
  let current = store;

  for (let i = 0; i < keys.length - 1; i++) {
    const key = keys[i];
    if (!current[key]) {
      current[key] = {};
    }
    current = current[key];
  }

  // Set the value at the last key
  current[keys[keys.length - 1]] = value;

  res.json({ message: "OK" });
});
```

`keys` æ˜¯ç›´æ¥ `split` çš„ï¼Œé‚£å°±å¯ä»¥åµŒå¥—é”®äº†ï¼Œä¸ŠåŸå‹é“¾æ±¡æŸ“ï¼Œè®¾ç½® key ä¸º `__proto__.injection`ï¼Œvalue ä¸º `cat /flag`ï¼Œå†è®¿é—® `/execute?cmd=injection` å°±å¯ä»¥æ‹¿åˆ° flag äº†

> flag{n0_pr0topOIl_50_U5E_new_Map_1n5teAD_Of_0bject2kv_500da5d6df}

## PaoluGPT

ç¬¬ä¸€é—®ä»è¯æ¡é‡Œæ‰¾ flagï¼Œå°±å†™äº†ä¸ªçˆ¬è™«é€Ÿé€Ÿç»“æŸï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œè—åœ¨ `6f85a472-7011-4285-a482-a365e44b5ed5` é‡Œ

ç¬¬äºŒé—®çœ‹æºæ–‡ä»¶çš„ SQL è¯­å¥

```python
@app.route("/list")
def list():
    results = execute_query("select id, title from messages where shown = true", fetch_all=True)
    messages = [Message(m[0], m[1], None) for m in results]
    return render_template("list.html", messages=messages)
```

è¯¶ï¼Œæ€ä¹ˆæœ‰ä¸ª `show = true`ï¼Œé‚£å¿…å®šè—åœ¨ `show = false` äº†ï¼Œ**SQL æ³¨å…¥**å¯åŠ¨ï¼Œè®¿é—® `/view?conversation_id=' or shown = false --'` æ‹‰åˆ°åº•éƒ¨å°±æ˜¯ç¬¬äºŒä¸ª flag

> flag{zU1_xiA0_de_11m_Pa0lule!!!_59fa92ae85}
>
> flag{enJ0y_y0uR_Sq1_&_1_would_xiaZHOU_hUI_guo_0c58320fa6}

## å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼

ç¬¬ä¸€é—®æƒ³åˆ°åˆ¤å®š 16 èƒ½å¦è¢«æ•´é™¤çœ‹å°¾æ•°æ˜¯ä¸æ˜¯ 16 çš„å€æ•°ï¼Œæšä¸¾ä¸€ä¸‹å°¾æ•°å°±å¥½äº†

```
(0|1|2|3|4|5|6|7|8|9)*(0000|0016|0032|0048|0064|0080|0096|0112|0128|0144|0160|0176|0192|0208|0224|0240|0256|0272|0288|0304|0320|0336|0352|0368|0384|0400|0416|0432|0448|0464|0480|0496|0512|0528|0544|0560|0576|0592|0608|0624|0640|0656|0672|0688|0704|0720|0736|0752|0768|0784|0800|0816|0832|0848|0864|0880|0896|0912|0928|0944|0960|0976|0992|1008|1024|1040|1056|1072|1088|1104|1120|1136|1152|1168|1184|1200|1216|1232|1248|1264|1280|1296|1312|1328|1344|1360|1376|1392|1408|1424|1440|1456|1472|1488|1504|1520|1536|1552|1568|1584|1600|1616|1632|1648|1664|1680|1696|1712|1728|1744|1760|1776|1792|1808|1824|1840|1856|1872|1888|1904|1920|1936|1952|1968|1984|2000|2016|2032|2048|2064|2080|2096|2112|2128|2144|2160|2176|2192|2208|2224|2240|2256|2272|2288|2304|2320|2336|2352|2368|2384|2400|2416|2432|2448|2464|2480|2496|2512|2528|2544|2560|2576|2592|2608|2624|2640|2656|2672|2688|2704|2720|2736|2752|2768|2784|2800|2816|2832|2848|2864|2880|2896|2912|2928|2944|2960|2976|2992|3008|3024|3040|3056|3072|3088|3104|3120|3136|3152|3168|3184|3200|3216|3232|3248|3264|3280|3296|3312|3328|3344|3360|3376|3392|3408|3424|3440|3456|3472|3488|3504|3520|3536|3552|3568|3584|3600|3616|3632|3648|3664|3680|3696|3712|3728|3744|3760|3776|3792|3808|3824|3840|3856|3872|3888|3904|3920|3936|3952|3968|3984|4000|4016|4032|4048|4064|4080|4096|4112|4128|4144|4160|4176|4192|4208|4224|4240|4256|4272|4288|4304|4320|4336|4352|4368|4384|4400|4416|4432|4448|4464|4480|4496|4512|4528|4544|4560|4576|4592|4608|4624|4640|4656|4672|4688|4704|4720|4736|4752|4768|4784|4800|4816|4832|4848|4864|4880|4896|4912|4928|4944|4960|4976|4992|5008|5024|5040|5056|5072|5088|5104|5120|5136|5152|5168|5184|5200|5216|5232|5248|5264|5280|5296|5312|5328|5344|5360|5376|5392|5408|5424|5440|5456|5472|5488|5504|5520|5536|5552|5568|5584|5600|5616|5632|5648|5664|5680|5696|5712|5728|5744|5760|5776|5792|5808|5824|5840|5856|5872|5888|5904|5920|5936|5952|5968|5984|6000|6016|6032|6048|6064|6080|6096|6112|6128|6144|6160|6176|6192|6208|6224|6240|6256|6272|6288|6304|6320|6336|6352|6368|6384|6400|6416|6432|6448|6464|6480|6496|6512|6528|6544|6560|6576|6592|6608|6624|6640|6656|6672|6688|6704|6720|6736|6752|6768|6784|6800|6816|6832|6848|6864|6880|6896|6912|6928|6944|6960|6976|6992|7008|7024|7040|7056|7072|7088|7104|7120|7136|7152|7168|7184|7200|7216|7232|7248|7264|7280|7296|7312|7328|7344|7360|7376|7392|7408|7424|7440|7456|7472|7488|7504|7520|7536|7552|7568|7584|7600|7616|7632|7648|7664|7680|7696|7712|7728|7744|7760|7776|7792|7808|7824|7840|7856|7872|7888|7904|7920|7936|7952|7968|7984|8000|8016|8032|8048|8064|8080|8096|8112|8128|8144|8160|8176|8192|8208|8224|8240|8256|8272|8288|8304|8320|8336|8352|8368|8384|8400|8416|8432|8448|8464|8480|8496|8512|8528|8544|8560|8576|8592|8608|8624|8640|8656|8672|8688|8704|8720|8736|8752|8768|8784|8800|8816|8832|8848|8864|8880|8896|8912|8928|8944|8960|8976|8992|9008|9024|9040|9056|9072|9088|9104|9120|9136|9152|9168|9184|9200|9216|9232|9248|9264|9280|9296|9312|9328|9344|9360|9376|9392|9408|9424|9440|9456|9472|9488|9504|9520|9536|9552|9568|9584|9600|9616|9632|9648|9664|9680|9696|9712|9728|9744|9760|9776|9792|9808|9824|9840|9856|9872|9888|9904|9920|9936|9952|9968|9984)
```

ç¬¬äºŒé—®å» Google äº†ç›¸å…³å†…å®¹ï¼Œæ‰¾åˆ°ä¸€ç¯‡ [Stack Overflow](https://stackoverflow.com/questions/12403842/check-number-divisibility-with-regular-expressions)ï¼Œé‡Œé¢ä»‹ç»äº† DFA çš„æœ‰å…³å†…å®¹ï¼Œä½†æˆ‘æ²¡å­¦è¿‡åŠ ä¸Šæ—¶é—´ç´§å¼ ï¼Œç›´æ¥æ‰¾äº†[è½®å­](https://s3.boskent.com/divisibility-regex/divisibility-regex.html)ç”Ÿæˆäº†ï¼Œè½®å­å¤§æ³•å¥½ï¼ˆï¼

```
(0|1101|111(011)*0101|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(001|01(011)*0101)|(1001|111(011)*(1|00)01|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))11|(1010|111(011)*(1|00)10|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(1001|111(011)*(1|00)01|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*0101|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(001|01(011)*0101)|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))11)|(1011|111(011)*(1|00)11|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)11|(1001|111(011)*(1|00)01|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))01|(1010|111(011)*(1|00)10|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(1001|111(011)*(1|00)01|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*(1|00)11|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)11|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))01))(001|(1|000)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*(1|00)11|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)11|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))01))*(011|(1|000)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*0101|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(001|01(011)*0101)|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))11))|(1100|111(011)*0100|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(000|01(011)*0100)|(1001|111(011)*(1|00)01|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))10|(1010|111(011)*(1|00)10|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(1001|111(011)*(1|00)01|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*0100|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(000|01(011)*0100)|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))10)|(1011|111(011)*(1|00)11|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)11|(1001|111(011)*(1|00)01|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))01|(1010|111(011)*(1|00)10|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(1001|111(011)*(1|00)01|(1000|111(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*(1|00)11|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)11|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))01))(001|(1|000)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*(1|00)11|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)11|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))01))*(010|(1|000)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*0100|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(000|01(011)*0100)|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))10)))(1|0(001|(1|000)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*(1|00)11|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)11|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))01))*(010|(1|000)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*0100|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(000|01(011)*0100)|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))10)))*0(001|(1|000)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*(1|00)11|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)11|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))01))*(011|(1|000)(0(011)*(1|00)10|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*01(011)*(1|00)10|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))00)*(0(011)*0101|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(001|01(011)*0101)|(0(011)*(1|00)01|(1|0(011)*(1|00)00)(10|01(011)*(1|00)00)*(11|01(011)*(1|00)01))11)))*
```

é¡ºä¾¿æé†’ä¸€ä¸‹ï¼Œä¸è¦ç²˜åˆ°æµè§ˆå™¨ xterm é‡Œï¼Œåº”è¯¥æ˜¯å•è¡Œè¿‡é•¿è¢«æˆªäº†ï¼ˆï¼Ÿï¼‰ï¼Œä¼šè¿‡ä¸æ‰ï¼Œè¦åœ¨æœ¬åœ°å¼€ nc è¿æ¥

> flag{p0werful_r3gular_expressi0n_easy_567f2ca9cb}
>
> flag{pow3rful_r3gular_expressi0n_medium_b1fe90f726}

## æƒœå­—å¦‚é‡‘ 3.0

åªä¼šåšç¬¬ä¸€é—®ï¼Œä»£ç è¡¥å…¨å°±å¥½äº†

crc ä¸ä¼šä¸ä¼šè·‘è·¯äº†

> flag{C0mpl3ted-Th3-Pyth0n-C0de-N0w}

## ä¼˜é›…çš„ä¸ç­‰å¼

æ€è·¯æ¥æºäº[å¦‚ä½•ä¼˜é›…åœ°è¯æ˜ $\pi$ çš„ç«‹æ–¹å¤§äº 31](https://www.bilibili.com/video/BV1nb4y1u72V?spm_id_from=333.788.recommend_more_video.0&vd_source=37c11ab2b88c5affc6c25ad1ef9b0f40)ï¼Œå¤§ä½¬è®²äº†æ³¨æ„åŠ›çš„æ¥æºï¼ˆ*
$$
\begin{gathered}
2 m \equiv n \bmod 4 \Rightarrow \int_0^1 \frac{x^m(1-x)^n\left(a+b x^2\right)}{1+x^2} d x=z-\pi \\
(m, n)=(3,2),(5,2),(4 k, 4 k) \cdots
\end{gathered}
$$
ä¸€å¼€å§‹è¯•çš„ $m=5$ å’Œ $n=2$ï¼Œç„¶åå¯ä»¥é€šè¿‡ Easyï¼ŒHard ç²¾åº¦ä¸å¤Ÿ

äºæ˜¯å¼€äº† Mathematica å¸®æˆ‘ç®—äº†ç®—

![](src/ineq.png)

ç„¶åä¸¢ç»™ Sympy å°±å¥½äº†ï¼ˆä¸ç»™ Sympy ä¸Šå‹åŠ›

```python
import numpy as np
import sympy
import pwn
import time

r=pwn.remote('202.38.93.141', 14514)
time.sleep(2)
print(r.recv())
r.sendline(token)
time.sleep(2)
x,a = sympy.symbols('x,a')
eq = (-19812862426748847450700524950934251480543711738389516063357602688377780058039093204490404251005561 - 1286403201230523828226905/(-1 + a))/6306629984033528273161447763685161613920002253047080803323924073224122703966811721717856075776000

for i in range(40):
    data = str(r.recv(),encoding='UTF-8')
    print(data)
    index1 = data.find('=')
    index2 = data.find('Enter')
    x,a = sympy.symbols('x,a')
    frac = sympy.sympify(data[index1+1:index2-1])
    aans = sympy.solve(eq+frac, a)
    ans = sympy.simplify(x**96*(1 - x)**96*(1 + aans[0]*x**2)/(1 + x**2)/70368744177664/(1 - aans[0]))
    print('-----------    %d    -----------' % (i+1))
    print(ans)
    r.sendline(str(ans).encode('UTF-8'))
    if i == 39:
        r.interactive()
    time.sleep(1)
```

ATTENTION is all you need!

> flag{y0u_ar3_g0od_at_constructi0n_5cabc06d44}
>
> flag{y0u_ar3_7he_Ramanujan_0f_in3quality_2ed901d52c}

## ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿

è¿™é¢˜ä¼šé¢å‘ GPT ç¼–ç¨‹å°±è¡Œäº†ï¼Œå…¨é—® ChatGPTï¼Œç»“æŸä¸‰é—®ï¼ˆæ€ä¹ˆä¸ä¼š DBus ä¹Ÿèƒ½åšï¼ˆé€Ÿé€Ÿå‡º AIGC

å°±ä¸ç²˜ä»£ç äº†ï¼Œçˆ¬å»å­¦å­¦ DBus

> flag{every_11nuxdeskT0pU5er_uSeDBUS_bUtn0NeknOwh0w_3b92499170}
>
> flag{n5tw0rk_TrAnSpaR5Ncy_d0n0t_11k5_Fd_3912144896}
>
> flag{prprprprprCTL_15your_FRiEND_5b294e4167}

## å…³ç¯

> åˆ°åº•æ˜¯è°åœ¨å…³ç¬¬å››ç›ç¯å•Šï¼Ÿ

ç»å…¸çš„ Lights Out é—®é¢˜ï¼Œä½†æ‹“å±•åˆ°äº†ä¸‰ç»´ï¼Œç…§è‘«èŠ¦ç”»ç“¢è§£çº¿æ€§æ–¹ç¨‹ç»„å°±å¯ä»¥äº†

ç”±äºæ˜¯å¸ƒå°”æ–¹ç¨‹ç»„ï¼Œä¸çŸ¥é“ GF(2) çš„æˆ‘ï¼Œæ‰¾ä¸åˆ°è½®å­ï¼Œå°±æ‰‹å†™é«˜æ–¯æ¶ˆå…ƒäº†

```python
from numba import njit
import numpy as np

@njit
def gaussin(X, n):
    for k in range(0, n):
        i = k
        while i<n and X[i,k]==0:
            i+=1
        if i==n:
            continue
        if i!=k:
            tmp = X[i, :].copy()
            X[i, :] = X[k, :]
            X[k, :] = tmp
        for i in range(n):
            if k!=i and X[i][k]:
                X[i][k:] = X[k][k:]^X[i][k:]
    return(X[:,n])

@njit
def initial(n):
    A = np.zeros((n**3, n**3), dtype=np.uint)
    for x in range(n):
        for y in range(n):
            for z in range(n):
                i = x * n**2 + y * n + z
                A[i, i] = 1
                neighbors = [
                    (x + 1, y, z), (x - 1, y, z),
                    (x, y + 1, z), (x, y - 1, z),
                    (x, y, z + 1), (x, y, z - 1)
                ]
                for nx, ny, nz in neighbors:
                    if 0 <= nx < n and 0 <= ny < n and 0 <= nz < n:
                        j = nx * n**2 + ny * n + nz
                        A[j, i] = 1
    return A

initial(1)
gaussin(np.array([[1,1]]),1)

init_st = input()

n = int(np.cbrt(len(init_st)))
A = initial(n)
B = np.transpose(np.array([[int(char) for char in init_st]],dtype=np.uint))

C = np.hstack((A, B))
ans = gaussin(C,n**3)
print(''.join(map(str,ans)))
```

å½“ç„¶ï¼Œç›´æ¥å¼€äº† $n^6$ çš„æ•°ç»„å¿…ç„¶æ˜¯ä¼šçˆ†å†…å­˜çš„ï¼Œå¯ä»¥ç¨€ç–çŸ©é˜µä¼˜åŒ–ä¸€ä¸‹ï¼Œä¸è¿‡åº”å¯¹å‰ 3 é—®å¤Ÿäº†ï¼Œç¬¬ 4 é—®ç®—æ³•ä¼˜åŒ–ä¹Ÿä¸å¤ªä¼šï¼ˆå¯æ€œä¸€ä¸‹å¤§ä¸€ä¸Šè¿˜æ²¡ä¸Šçº¿ä»£çš„å­©å­*

> flag{bru7e_f0rce_1s_a1l_y0u_n3ed_89a32e6416}
>
> flag{prun1ng_1s_u5eful_36f0359859}
>
> flag{lin3ar_alg3bra_1s_p0werful_f3cdb5f0d2}

## ç¦æ­¢å†…å·

ä¸çœ‹é¢˜çš„å­©å­æ—©é­ç½ªï¼Œçœ‹åˆ°å¯ä»¥è®¡ç®—å¹³æ–¹å·®ï¼Œç”¨å¹³æ–¹å·®å…¬å¼å°±è¯•ä¸¤æ¬¡å°±èƒ½å‡ºçœŸå®å€¼äº†ï¼Œä½†æ˜¯ï¼Œæ¬¸ï¼š

```python
def get_answer():
    # scoring with answer
    # I could change answers anytime so let's just load it every time
    with open("answers.json") as f:
        answers = json.load(f)
        # sanitize answer
        for idx, i in enumerate(answers):
            if i < 0:
                answers[idx] = 0
    return answers
```

sanitize è¿™ç§äº‹ä¸è¦å•Šå•Šå•Šå•Šï¼ç„¶åæ€è·¯è½¬å›åˆ° flask ä¸Šï¼Œæ²¡ç”¨è¿‡ flaskï¼Œçœ‹äº†å‡ ç¯‡æ–‡ç« è¯•å›¾è·å¾— debug console æ— æœï¼Œç„¶åæ³¨æ„åˆ°è·¯å¾„æ²¡è¿‡æ»¤ï¼Œå°±å°è¯•ä¸Šä¼ æ–‡ä»¶è¦†ç›–æ‰è¿™ä¸ª `app.py` å°±å¯ä»¥äº†

```python
import httpx

files = {'file': ('../web/app.py',open('app.py','rb'))}
r = httpx.post('/submit',files=files,follow_redirects=True)
print(r.text)
```

ç”¨äº† httpx ç¯¡æ”¹è¯·æ±‚ï¼Œå‘é€è¦†ç›–å°±å¯ä»¥ç›´æ¥å‡º flag äº†

> flag{uno!!!!_esrever_now_U_run_MY_c0de1b501d76a8}

## é›¶çŸ¥è¯†æ•°ç‹¬

ç¬¬ä¸€é—®çº¯åšæ•°ç‹¬ï¼Œéšä¾¿æ‰¾ä¸ª sudoku solver å°±å¯ä»¥è§£å†³ï¼ˆèƒ½ä¸åŠ¨è„‘å­çš„æ‰ä¸ä¼šç¿»ç½‘é¡µæºä»£ç å‘¢ï¼ˆå“¼

ç¬¬äºŒé—®ç®—æ˜¯ä¸€ä¸ªå¯¹é›¶çŸ¥è¯†çš„ introï¼Œçœ‹ä¸€ä¸‹ snarkjs çš„æ–‡æ¡£å­¦ä¸€ä¸‹å°±è¡Œï¼ˆä¸çŸ¥é“æˆ‘ç”¨ circom ç¼–è¯‘åä¸ºä»€ä¹ˆä¼šæŠ¥é”™ï¼Œå¯ä»¥ç›´æ¥ç”¨ä¸‹é¢è¿™æ¡æŒ‡ä»¤

```bash
snarkjs g16f input.json sudoku.wasm sudoku.zkey proof.json public.json
```

`input.json` çš„æ ¼å¼è§‚å¯Ÿä¸€ä¸‹ `sudoku.circom` å°±å¯ä»¥å¾—åˆ°

ï¼ˆç¬¬ä¸‰é—®æ‰¾æ¼æ´å¤±è´¥äº†

> flag{SUD0KU_M45T3R_You_Have_Shown_Y0ur_Know1edge_ac5207a9}
>
> flag{you_are_a_5udoku_expert_and_pr0ved_your_kn0wledge_52c069e53d}

## å…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„ LLM é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±ï¼Œå‘ç° Hackergame å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ï¼Œä»¥åŠã€Œè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—ğŸ¤£ã€

> æ˜¯çš„ï¼Œç”¨æˆ·ä½“éªŒæå·®
>
> ç¬‘ç‚¹è§£æï¼šxxxx

ä¸¢ç»™ ChatGPTï¼Œè½¬å‡ºæ¥ï¼Œå…³é”®åœ¨äºå¯¹ `xxxx` çš„è¿˜åŸï¼ŒGPT ç»™çš„æ˜¯ `race`ï¼Œæˆ‘çªç€çœ‹äº†ååˆ†é’Ÿæ‰æ‰¾å‡ºæ¥åº”è¯¥æ˜¯ `game`ï¼Œå®³äººä¸æµ…å•Šï¼ˆ

>flag{llm_lm_lm_koshitantan_fa7b655c38bc8847}

## ç¢ç¢å¿µ

ç®—æ˜¯ç¬¬ä¸€å›æ­£å¼å‚åŠ  CTFï¼Œå­¦åˆ°å¾ˆå¤šï¼Œä¹Ÿæœ‰å¤ªå¤šèµ›åæ‹æ–­å¤§è…¿çš„é¢˜ç›®ï¼ˆ

æ„Ÿè§‰å¾ˆä¹…æ²¡æœ‰çœŸä¹ˆä¸“æ³¨åœ°åšä¸œè¥¿çš„ä¸€ä¸ªç¤¼æ‹œï¼Œæ‰¾å›äº†é«˜ä¸­ä¸¢æ‰çš„ä¸€äº›ä¸œè¥¿

ç±³å¨œæ˜å¹´å†è§~
